/*
 (c) DHTMLX Ltd, 2011
 Licensing: You allowed to use this component for free under GPL or you need to obtain Commercial/Enterprise license to use it in non-GPL project
 Contact: sales@dhtmlx.com
 */
 dhtmlx=function(C){for(var A in C){dhtmlx[A]=C[A]}return dhtmlx};dhtmlx.extend_api=function(A,E,D){var C=window[A];if(!C){return }window[A]=function(I){if(I&&typeof I=="object"&&!I.tagName){var H=C.apply(this,(E._init?E._init(I):arguments));for(var F in dhtmlx){if(E[F]){this[E[F]](dhtmlx[F])}}for(var F in I){if(E[F]){this[E[F]](I[F])}else{if(F.indexOf("on")==0){this.attachEvent(F,I[F])}}}}else{var H=C.apply(this,arguments)}if(E._patch){E._patch(this)}return H||this};window[A].prototype=C.prototype;if(D){dhtmlXHeir(window[A].prototype,D)}};dhtmlxAjax={get:function(A,D){var C=new dtmlXMLLoaderObject(true);C.async=(arguments.length<3);C.waitCall=D;C.loadXML(A);return C},post:function(A,D,E){var C=new dtmlXMLLoaderObject(true);C.async=(arguments.length<4);C.waitCall=E;C.loadXML(A,true,D);return C},getSync:function(A){return this.get(A,null,true)},postSync:function(A,C){return this.post(A,C,null,true)}};function dtmlXMLLoaderObject(C,E,D,A){this.xmlDoc="";if(typeof (D)!="undefined"){this.async=D}else{this.async=true}this.onloadAction=C||null;this.mainObject=E||null;this.waitCall=null;this.rSeed=A||false;return this}dtmlXMLLoaderObject.prototype.waitLoadFunction=function(C){var A=true;this.check=function(){if((C)&&(C.onloadAction!=null)){if((!C.xmlDoc.readyState)||(C.xmlDoc.readyState==4)){if(!A){return }A=false;if(typeof C.onloadAction=="function"){C.onloadAction(C.mainObject,null,null,null,C)}if(C.waitCall){C.waitCall.call(this,C);C.waitCall=null}}}};return this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(D,A){if(this.xmlDoc.responseXML){var C=this.xmlDoc.responseXML.getElementsByTagName(D);if(C.length==0&&D.indexOf(":")!=-1){var C=this.xmlDoc.responseXML.getElementsByTagName((D.split(":"))[1])}var F=C[0]}else{var F=this.xmlDoc.documentElement}if(F){this._retry=false;return F}if((_isIE)&&(!this._retry)){var E=this.xmlDoc.responseText;var A=this.xmlDoc;this._retry=true;this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=false;this.xmlDoc.loadXML(E);return this.getXMLTopNode(D,A)}dhtmlxError.throwError("LoadXML","Incorrect XML",[(A||this.xmlDoc),this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(C){try{var D=new DOMParser();this.xmlDoc=D.parseFromString(C,"text/xml")}catch(A){this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=this.async;this.xmlDoc.loadXML(C)}if(this.onloadAction){this.onloadAction(this.mainObject,null,null,null,this)}if(this.waitCall){this.waitCall();this.waitCall=null}};dtmlXMLLoaderObject.prototype.loadXML=function(D,C,A,E){if(this.rSeed){D+=((D.indexOf("?")!=-1)?"&":"?")+"a_dhx_rSeed="+(new Date()).valueOf()}this.filePath=D;if((!_isIE)&&(window.XMLHttpRequest)){this.xmlDoc=new XMLHttpRequest()}else{this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP")}if(this.async){this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)}this.xmlDoc.open(C?"POST":"GET",D,this.async);if(E){this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")");this.xmlDoc.setRequestHeader("Content-type","text/xml")}else{if(C){this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded")}}this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(null||A);if(!this.async){(new this.waitLoadFunction(this))()}};dtmlXMLLoaderObject.prototype.destructor=function(){this._filterXPath=null;this._getAllNamedChilds=null;this._retry=null;this.async=null;this.rSeed=null;this.filePath=null;this.onloadAction=null;this.mainObject=null;this.xmlDoc=null;this.doXPath=null;this.doXPathOpera=null;this.doXSLTransToObject=null;this.doXSLTransToString=null;this.loadXML=null;this.loadXMLString=null;this.doSerialization=null;this.xmlNodeToJSON=null;this.getXMLTopNode=null;this.setXSLParamValue=null;return null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(E){var D={};for(var C=0;C<E.attributes.length;C++){D[E.attributes[C].name]=E.attributes[C].value}D._tagvalue=E.firstChild?E.firstChild.nodeValue:"";for(var C=0;C<E.childNodes.length;C++){var A=E.childNodes[C].tagName;if(A){if(!D[A]){D[A]=[]}D[A].push(this.xmlNodeToJSON(E.childNodes[C]))}}return D};function callerFunction(A,C){this.handler=function(D){if(!D){D=window.event}A(D,C);return true};return this.handler}function getAbsoluteLeft(A){return getOffset(A).left}function getAbsoluteTop(A){return getOffset(A).top}function getOffsetSum(A){var D=0,C=0;while(A){D=D+parseInt(A.offsetTop);C=C+parseInt(A.offsetLeft);A=A.offsetParent}return{top:D,left:C}}function getOffsetRect(E){var I=E.getBoundingClientRect();var J=document.body;var C=document.documentElement;var A=window.pageYOffset||C.scrollTop||J.scrollTop;var F=window.pageXOffset||C.scrollLeft||J.scrollLeft;var H=C.clientTop||J.clientTop||0;var K=C.clientLeft||J.clientLeft||0;var L=I.top+A-H;var D=I.left+F-K;return{top:Math.round(L),left:Math.round(D)}}function getOffset(A){if(A.getBoundingClientRect){return getOffsetRect(A)}else{return getOffsetSum(A)}}function convertStringToBoolean(A){if(typeof (A)=="string"){A=A.toLowerCase()}switch(A){case"1":case"true":case"yes":case"y":case 1:case true:return true;break;default:return false}}function getUrlSymbol(A){if(A.indexOf("?")!=-1){return"&"}else{return"?"}}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop){return window.dhtmlDragAndDrop}this.lastLanding=0;this.dragNode=0;this.dragStartNode=0;this.dragStartObject=0;this.tempDOMU=null;this.tempDOMM=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(A){A.onmousedown=null;A.dragStarter=null;A.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(A,C){A.onmousedown=this.preCreateDragCopy;A.dragStarter=C;this.addDragLanding(A,C)};dhtmlDragAndDropObject.prototype.addDragLanding=function(A,C){A.dragLanding=C};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(A){if((A||window.event)&&(A||event).button==2){return }if(window.dhtmlDragAndDrop.waitDrag){window.dhtmlDragAndDrop.waitDrag=0;document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;return false}if(window.dhtmlDragAndDrop.dragNode){window.dhtmlDragAndDrop.stopDrag(A)}window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=new Date().valueOf();if((A)&&(A.preventDefault)){A.preventDefault();return false}return false};dhtmlDragAndDropObject.prototype.callDrag=function(D){if(!D){D=window.event}dragger=window.dhtmlDragAndDrop;if((new Date()).valueOf()-dragger.downtime<100){return }if(!dragger.dragNode){if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,D);if(!dragger.dragNode){return dragger.stopDrag()}dragger.dragNode.onselectstart=function(){return false};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else{return dragger.stopDrag(D,true)}}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var A=dragger.gldragNode;if(dragger.gldragNode.old){A=dragger.gldragNode.old}A.parentNode.removeChild(A);var C=dragger.dragNode.pWindow;if(A.pWindow&&A.pWindow.dhtmlDragAndDrop.lastLanding){A.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(A.pWindow.dhtmlDragAndDrop.lastLanding)}if(_isIE){var F=document.createElement("Div");F.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=F.childNodes[0]}else{dragger.dragNode=dragger.dragNode.cloneNode(true)}dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);C.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=D.clientX+15+(dragger.fx?dragger.fx*(-1):0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=D.clientY+3+(dragger.fy?dragger.fy*(-1):0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";if(!D.srcElement){var E=D.target}else{E=D.srcElement}dragger.checkLanding(E,D)};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(F){if(window.name){var D=parent.frames[window.name].frameElement.offsetParent;var E=0;var C=0;while(D){E+=D.offsetLeft;C+=D.offsetTop;D=D.offsetParent}if((parent.dhtmlDragAndDrop)){var A=parent.dhtmlDragAndDrop.calculateFramePosition(1);E+=A.split("_")[0]*1;C+=A.split("_")[1]*1}if(F){return E+"_"+C}else{this.fx=E}this.fy=C}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(C,A){if((C)&&(C.dragLanding)){if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding)}this.lastLanding=C;this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,A.clientX,A.clientY,A);this.lastLanding_scr=(_isIE?A.srcElement:A.target)}else{if((C)&&(C.tagName!="BODY")){this.checkLanding(C.parentNode,A)}else{if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding,A.clientX,A.clientY,A)}this.lastLanding=0;if(this._onNotFound){this._onNotFound()}}}};dhtmlDragAndDropObject.prototype.stopDrag=function(C,D){dragger=window.dhtmlDragAndDrop;if(!D){dragger.stopFrameRoute();var A=dragger.lastLanding;dragger.lastLanding=null;if(A){A.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,A,(_isIE?event.srcElement:C.target))}}dragger.lastLanding=null;if((dragger.dragNode)&&(dragger.dragNode.parentNode==document.body)){dragger.dragNode.parentNode.removeChild(dragger.dragNode)}dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(D){if(D){window.dhtmlDragAndDrop.stopDrag(1,1)}for(var A=0;A<window.frames.length;A++){try{if((window.frames[A]!=D)&&(window.frames[A].dhtmlDragAndDrop)){window.frames[A].dhtmlDragAndDrop.stopFrameRoute(window)}}catch(C){}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=D)){parent.dhtmlDragAndDrop.stopFrameRoute(window)}}catch(C){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(D,E){if(D){window.dhtmlDragAndDrop.preCreateDragCopy();window.dhtmlDragAndDrop.dragStartNode=D.dhtmlDragAndDrop.dragStartNode;window.dhtmlDragAndDrop.dragStartObject=D.dhtmlDragAndDrop.dragStartObject;window.dhtmlDragAndDrop.dragNode=D.dhtmlDragAndDrop.dragNode;window.dhtmlDragAndDrop.gldragNode=D.dhtmlDragAndDrop.dragNode;window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;window.waitDrag=0;if(((!_isIE)&&(E))&&((!_isFF)||(_FFrv<1.8))){window.dhtmlDragAndDrop.calculateFramePosition()}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=D)){parent.dhtmlDragAndDrop.initFrameRoute(window)}}catch(C){}for(var A=0;A<window.frames.length;A++){try{if((window.frames[A]!=D)&&(window.frames[A].dhtmlDragAndDrop)){window.frames[A].dhtmlDragAndDrop.initFrameRoute(window,((!D||E)?1:0))}}catch(C){}}};var _isFF=false;var _isIE=false;var _isOpera=false;var _isKHTML=false;var _isMacOS=false;var _isChrome=false;if(navigator.userAgent.indexOf("Macintosh")!=-1){_isMacOS=true}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){_isChrome=true}if((navigator.userAgent.indexOf("Safari")!=-1)||(navigator.userAgent.indexOf("Konqueror")!=-1)){var _KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5));if(_KHTMLrv>525){_isFF=true;var _FFrv=1.9}else{_isKHTML=true}}else{if(navigator.userAgent.indexOf("Opera")!=-1){_isOpera=true;_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))}else{if(navigator.appName.indexOf("Microsoft")!=-1){_isIE=true;if(navigator.appVersion.indexOf("MSIE 8.0")!=-1&&document.compatMode!="BackCompat"){_isIE=8}if(navigator.appVersion.indexOf("MSIE 9.0")!=-1&&document.compatMode!="BackCompat"){_isIE=8}}else{_isFF=true;var _FFrv=parseFloat(navigator.userAgent.split("rv:")[1])}}}dtmlXMLLoaderObject.prototype.doXPath=function(D,F,E,K){if(_isKHTML||(!_isIE&&!window.XPathResult)){return this.doXPathOpera(D,F)}if(_isIE){if(!F){if(!this.xmlDoc.nodeName){F=this.xmlDoc.responseXML}else{F=this.xmlDoc}}if(!F){dhtmlxError.throwError("LoadXML","Incorrect XML",[(F||this.xmlDoc),this.mainObject])}if(E!=null){F.setProperty("SelectionNamespaces","xmlns:xsl='"+E+"'")}if(K=="single"){return F.selectSingleNode(D)}else{return F.selectNodes(D)||new Array(0)}}else{var A=F;if(!F){if(!this.xmlDoc.nodeName){F=this.xmlDoc.responseXML}else{F=this.xmlDoc}}if(!F){dhtmlxError.throwError("LoadXML","Incorrect XML",[(F||this.xmlDoc),this.mainObject])}if(F.nodeName.indexOf("document")!=-1){A=F}else{A=F;F=F.ownerDocument}var I=XPathResult.ANY_TYPE;if(K=="single"){I=XPathResult.FIRST_ORDERED_NODE_TYPE}var H=new Array();var C=F.evaluate(D,A,function(L){return E},I,null);if(I==XPathResult.FIRST_ORDERED_NODE_TYPE){return C.singleNodeValue}var J=C.iterateNext();while(J){H[H.length]=J;J=C.iterateNext()}return H}};function _dhtmlxError(C,A,D){if(!this.catches){this.catches=new Array()}return this}_dhtmlxError.prototype.catchError=function(C,A){this.catches[C]=A};_dhtmlxError.prototype.throwError=function(C,A,D){if(this.catches[C]){return this.catches[C](C,A,D)}if(this.catches.ALL){return this.catches.ALL(C,A,D)}alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]);return null};window.dhtmlxError=new _dhtmlxError();dtmlXMLLoaderObject.prototype.doXPathOpera=function(D,A){var F=D.replace(/[\/]+/gi,"/").split("/");var E=null;var C=1;if(!F.length){return[]}if(F[0]=="."){E=[A]}else{if(F[0]==""){E=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(F[C].replace(/\[[^\]]*\]/g,""));C++}else{return[]}}for(C;C<F.length;C++){E=this._getAllNamedChilds(E,F[C])}if(F[C-1].indexOf("[")!=-1){E=this._filterXPath(E,F[C-1])}return E};dtmlXMLLoaderObject.prototype._filterXPath=function(C,A){var E=new Array();var A=A.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,"");for(var D=0;D<C.length;D++){if(C[D].getAttribute(A)){E[E.length]=C[D]}}return E};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(C,A){var F=new Array();if(_isKHTML){A=A.toUpperCase()}for(var E=0;E<C.length;E++){for(var D=0;D<C[E].childNodes.length;D++){if(_isKHTML){if(C[E].childNodes[D].tagName&&C[E].childNodes[D].tagName.toUpperCase()==A){F[F.length]=C[E].childNodes[D]}}else{if(C[E].childNodes[D].tagName==A){F[F.length]=C[E].childNodes[D]}}}}return F};function dhtmlXHeir(C,A){for(var D in A){if(typeof (A[D])=="function"){C[D]=A[D]}}return C}function dhtmlxEvent(C,D,A){if(C.addEventListener){C.addEventListener(D,A,false)}else{if(C.attachEvent){C.attachEvent("on"+D,A)}}}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(C,D,E){if(!E){E=this.xslDoc}if(E.responseXML){E=E.responseXML}var A=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+C+"']",E,"http://www.w3.org/1999/XSL/Transform","single");if(A!=null){A.firstChild.nodeValue=D}};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(E,C){if(!E){E=this.xslDoc}if(E.responseXML){E=E.responseXML}if(!C){C=this.xmlDoc}if(C.responseXML){C=C.responseXML}if(!_isIE){if(!this.XSLProcessor){this.XSLProcessor=new XSLTProcessor();this.XSLProcessor.importStylesheet(E)}var A=this.XSLProcessor.transformToDocument(C)}else{var A=new ActiveXObject("Msxml2.DOMDocument.3.0");try{C.transformNodeToObject(E,A)}catch(D){A=C.transformNode(E)}}return A};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(D,C){var A=this.doXSLTransToObject(D,C);if(typeof (A)=="string"){return A}return this.doSerialization(A)};dtmlXMLLoaderObject.prototype.doSerialization=function(C){if(!C){C=this.xmlDoc}if(C.responseXML){C=C.responseXML}if(!_isIE){var A=new XMLSerializer();return A.serializeToString(C)}else{return C.xml}};dhtmlxEventable=function(obj){obj.attachEvent=function(name,catcher,callObj){name="ev_"+name.toLowerCase();if(!this[name]){this[name]=new this.eventCatcher(callObj||this)}return(name+":"+this[name].addEvent(catcher))};obj.callEvent=function(name,arg0){name="ev_"+name.toLowerCase();if(this[name]){return this[name].apply(this,arg0)}return true};obj.checkEvent=function(name){return(!!this["ev_"+name.toLowerCase()])};obj.eventCatcher=function(obj){var dhx_catch=[];var z=function(){var res=true;for(var i=0;i<dhx_catch.length;i++){if(dhx_catch[i]!=null){var zr=dhx_catch[i].apply(obj,arguments);res=res&&zr}}return res};z.addEvent=function(ev){if(typeof (ev)!="function"){ev=eval(ev)}if(ev){return dhx_catch.push(ev)-1}return false};z.removeEvent=function(id){dhx_catch[id]=null};return z};obj.detachEvent=function(id){if(id!=false){var list=id.split(":");this[list[0]].removeEvent(list[1])}};obj.detachAllEvents=function(){for(var name in this){if(name.indexOf("ev_")==0){delete this[name]}}}};function dhtmlXGridCellObject(A){this.destructor=function(){this.cell.obj=null;this.cell=null;this.grid=null;this.base=null;return null};this.cell=A;this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA")){return this.cell.firstChild.value}else{return this.cell.innerHTML._dhx_trim()}};this.getMathValue=function(){if(this.cell.original){return this.cell.original}else{return this.getValue()}};this.getFont=function(){arOut=new Array(3);if(this.cell.style.fontFamily){arOut[0]=this.cell.style.fontFamily}if(this.cell.style.fontWeight=="bold"||this.cell.parentNode.style.fontWeight=="bold"){arOut[1]="bold"}if(this.cell.style.fontStyle=="italic"||this.cell.parentNode.style.fontWeight=="italic"){arOut[1]+="italic"}if(this.cell.style.fontSize){arOut[2]=this.cell.style.fontSize}else{arOut[2]=""}return arOut.join("-")};this.getTextColor=function(){if(this.cell.style.color){return this.cell.style.color}else{return"#000000"}};this.getBgColor=function(){if(this.cell.bgColor){return this.cell.bgColor}else{return"#FFFFFF"}};this.getHorAlign=function(){if(this.cell.style.textAlign){return this.cell.style.textAlign}else{if(this.cell.style.textAlign){return this.cell.style.textAlign}else{return"left"}}};this.getWidth=function(){return this.cell.scrollWidth};this.setFont=function(C){fntAr=C.split("-");this.cell.style.fontFamily=fntAr[0];this.cell.style.fontSize=fntAr[fntAr.length-1];if(fntAr.length==3){if(/bold/.test(fntAr[1])){this.cell.style.fontWeight="bold"}if(/italic/.test(fntAr[1])){this.cell.style.fontStyle="italic"}if(/underline/.test(fntAr[1])){this.cell.style.textDecoration="underline"}}};this.setTextColor=function(C){this.cell.style.color=C};this.setBgColor=function(C){if(C==""){C=null}this.cell.bgColor=C};this.setHorAlign=function(C){if(C.length==1){if(C=="c"){this.cell.style.textAlign="center"}else{if(C=="l"){this.cell.style.textAlign="left"}else{this.cell.style.textAlign="right"}}}else{this.cell.style.textAlign=C}};this.wasChanged=function(){if(this.cell.wasChanged){return true}else{return false}};this.isCheckbox=function(){var C=this.cell.firstChild;if(C&&C.tagName=="INPUT"){type=C.type;if(type=="radio"||type=="checkbox"){return true}else{return false}}else{return false}};this.isChecked=function(){if(this.isCheckbox()){return this.cell.firstChild.checked}};this.isDisabled=function(){return this.cell._disabled};this.setChecked=function(C){if(this.isCheckbox()){if(C!="true"&&C!=1){C=false}this.cell.firstChild.checked=C}};this.setDisabled=function(C){if(C!="true"&&C!=1){C=false}if(this.isCheckbox()){this.cell.firstChild.disabled=C;if(this.disabledF){this.disabledF(C)}}this.cell._disabled=C}}dhtmlXGridCellObject.prototype={getAttribute:function(A){return this.cell._attrs[A]},setAttribute:function(A,C){this.cell._attrs[A]=C},getInput:function(){if(this.obj&&(this.obj.tagName=="INPUT"||this.obj.tagName=="TEXTAREA")){return this.obj}var A=(this.obj||this.cell).getElementsByTagName("TEXTAREA");if(!A.length){A=(this.obj||this.cell).getElementsByTagName("INPUT")}return A[0]}};dhtmlXGridCellObject.prototype.setValue=function(A){if((typeof (A)!="number")&&(!A||A.toString()._dhx_trim()=="")){A="&nbsp;";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCValue(A)};dhtmlXGridCellObject.prototype.getTitle=function(){return(_isIE?this.cell.innerText:this.cell.textContent)};dhtmlXGridCellObject.prototype.setCValue=function(C,A){this.cell.innerHTML=C;this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,(arguments.length>1?A:C)])};dhtmlXGridCellObject.prototype.setCTxtValue=function(A){this.cell.innerHTML="";this.cell.appendChild(document.createTextNode(A));this.grid.callEvent("onCellChanged",[this.cell.parentNode.idd,this.cell._cellIndex,A])};dhtmlXGridCellObject.prototype.setLabel=function(A){this.cell.innerHTML=A};dhtmlXGridCellObject.prototype.getMath=function(){if(this._val){return this.val}else{return this.getValue()}};function eXcell(){this.obj=null;this.val=null;this.changeState=function(){return false};this.edit=function(){this.val=this.getValue()};this.detach=function(){return false};this.getPosition=function(E){var A=E;var D=0;var C=0;while(A.tagName!="BODY"){D+=A.offsetLeft;C+=A.offsetTop;A=A.offsetParent}return new Array(D,C)}}eXcell.prototype=new dhtmlXGridCellObject;function eXcell_ed(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.edit=function(){this.cell.atag=((!this.grid.multiLine)&&(_isKHTML||_isMacOS||_isFF))?"INPUT":"TEXTAREA";this.val=this.getValue();this.obj=document.createElement(this.cell.atag);this.obj.setAttribute("autocomplete","off");this.obj.style.height=(this.cell.offsetHeight-(_isIE?4:4))+"px";this.obj.className="dhx_combo_edit";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(C){(C||event).cancelBubble=true};this.obj.onmousedown=function(C){(C||event).cancelBubble=true};this.obj.value=this.val;this.cell.innerHTML="";this.cell.appendChild(this.obj);if(_isFF&&!window._KHTMLrv){this.obj.style.overflow="visible";if((this.grid.multiLine)&&(this.obj.offsetHeight>=18)&&(this.obj.offsetHeight<40)){this.obj.style.height="36px";this.obj.style.overflow="scroll"}}this.obj.onselectstart=function(C){if(!C){C=event}C.cancelBubble=true;return true};if(_isIE){this.obj.focus()}this.obj.focus()};this.getValue=function(){if((this.cell.firstChild)&&((this.cell.atag)&&(this.cell.firstChild.tagName==this.cell.atag))){return this.cell.firstChild.value}if(this.cell._clearCell){return""}return this.cell.innerHTML.toString()._dhx_trim()};this.detach=function(){this.setValue(this.obj.value);return this.val!=this.getValue()}}eXcell_ed.prototype=new eXcell;function eXcell_edtxt(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&((this.cell.atag)&&(this.cell.firstChild.tagName==this.cell.atag))){return this.cell.firstChild.value}if(this.cell._clearCell){return""}return(_isIE?this.cell.innerText:this.cell.textContent)};this.setValue=function(C){if(!C||C.toString()._dhx_trim()==""){C=" ";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCTxtValue(C)}}eXcell_edtxt.prototype=new eXcell_ed;function eXcell_edn(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA")){return this.cell.firstChild.value}if(this.cell._clearCell){return""}return this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)};this.detach=function(){var C=this.obj.value;this.setValue(C);return this.val!=this.getValue()}}eXcell_edn.prototype=new eXcell_ed;eXcell_edn.prototype.setValue=function(A){if(!A||A.toString()._dhx_trim()==""){this.cell._clearCell=true;return this.setCValue("&nbsp;",0)}else{this.cell._clearCell=false}this.setCValue(this.grid._aplNF(A,this.cell._cellIndex))};function eXcell_ch(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.disabledF=function(C){if((C==true)||(C==1)){this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0.","item_chk0_dis.").replace("item_chk1.","item_chk1_dis.")}else{this.cell.innerHTML=this.cell.innerHTML.replace("item_chk0_dis.","item_chk0.").replace("item_chk1_dis.","item_chk1.")}};this.changeState=function(){if((!this.grid.isEditable)||(this.cell.parentNode._locked)||(this.isDisabled())){return }if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])){this.val=this.getValue();if(this.val=="1"){this.setValue("0")}else{this.setValue("1")}this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else{this.editor=null}};this.getValue=function(){return this.cell.chstate?this.cell.chstate.toString():"0"};this.isCheckbox=function(){return true};this.isChecked=function(){if(this.getValue()=="1"){return true}else{return false}};this.setChecked=function(C){this.setValue(C.toString())};this.detach=function(){return this.val!=this.getValue()};this.edit=null}eXcell_ch.prototype=new eXcell;eXcell_ch.prototype.setValue=function(C){this.cell.style.verticalAlign="middle";if(C){C=C.toString()._dhx_trim();if((C=="false")||(C=="0")){C=""}}if(C){C="1";this.cell.chstate="1"}else{C="0";this.cell.chstate="0"}var A=this;this.setCValue("<img src='"+this.grid.imgURL+"item_chk"+C+".gif' onclick='new eXcell_ch(this.parentNode).changeState(); (arguments[0]||event).cancelBubble=true; '>",this.cell.chstate)};function eXcell_ra(A){this.base=eXcell_ch;this.base(A);this.grid=A.parentNode.grid;this.disabledF=function(C){if((C==true)||(C==1)){this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0.","radio_chk0_dis.").replace("radio_chk1.","radio_chk1_dis.")}else{this.cell.innerHTML=this.cell.innerHTML.replace("radio_chk0_dis.","radio_chk0.").replace("radio_chk1_dis.","radio_chk1.")}};this.changeState=function(C){if(C===false&&this.getValue()==1){return }if((!this.grid.isEditable)||(this.cell.parentNode._locked)){return }if(this.grid.callEvent("onEditCell",[0,this.cell.parentNode.idd,this.cell._cellIndex])!=false){this.val=this.getValue();if(this.val=="1"){this.setValue("0")}else{this.setValue("1")}this.cell.wasChanged=true;this.grid.callEvent("onEditCell",[1,this.cell.parentNode.idd,this.cell._cellIndex]);this.grid.callEvent("onCheckbox",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")]);this.grid.callEvent("onCheck",[this.cell.parentNode.idd,this.cell._cellIndex,(this.val!="1")])}else{this.editor=null}};this.edit=null}eXcell_ra.prototype=new eXcell_ch;eXcell_ra.prototype.setValue=function(C){this.cell.style.verticalAlign="middle";if(C){C=C.toString()._dhx_trim();if((C=="false")||(C=="0")){C=""}}if(C){if(!this.grid._RaSeCol){this.grid._RaSeCol=[]}if(this.grid._RaSeCol[this.cell._cellIndex]){var A=this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);A.setValue("0");if(this.grid.rowsAr[A.cell.parentNode.idd]){this.grid.callEvent("onEditCell",[1,A.cell.parentNode.idd,A.cell._cellIndex])}}this.grid._RaSeCol[this.cell._cellIndex]=this.cell;C="1";this.cell.chstate="1"}else{C="0";this.cell.chstate="0"}this.setCValue("<img src='"+this.grid.imgURL+"radio_chk"+C+".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>",this.cell.chstate)};function eXcell_txt(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_textarea";this.obj.onclick=function(F){(F||event).cancelBubble=true};var D=this.grid.getPosition(this.cell);this.obj.value=this.val;this.obj.style.display="";this.obj.style.textAlign=this.cell.style.textAlign;if(_isFF){var C=document.createElement("DIV");C.appendChild(this.obj);C.style.overflow="auto";C.className="dhx_textarea";this.obj.style.margin="0px 0px 0px 0px";this.obj.style.border="0px";this.obj=C}document.body.appendChild(this.obj);if(_isOpera){this.obj.onkeypress=function(F){if(F.keyCode==9){return false}}}this.obj.onkeydown=function(H){var F=(H||event);if(F.keyCode==9){globalActiveDHTMLGridObject.entBox.focus();globalActiveDHTMLGridObject.doKey({keyCode:F.keyCode,shiftKey:F.shiftKey,srcElement:"0"});return false}};this.obj.style.left=D[0]+"px";this.obj.style.top=D[1]+this.cell.offsetHeight+"px";if(this.cell.offsetWidth<200){var E=200}else{var E=this.cell.offsetWidth}this.obj.style.width=E+(_isFF?18:16)+"px";if(_isFF){this.obj.firstChild.style.width=parseInt(this.obj.style.width)+"px";this.obj.firstChild.style.height=this.obj.offsetHeight-3+"px"}if(_isIE){this.obj.select();this.obj.value=this.obj.value}if(_isFF){this.obj.firstChild.focus()}else{this.obj.focus()}};this.detach=function(){var C="";if(_isFF){C=this.obj.firstChild.value}else{C=this.obj.value}if(C==""){this.cell._clearCell=true}else{this.cell._clearCell=false}this.setValue(C);document.body.removeChild(this.obj);this.obj=null;return this.val!=this.getValue()};this.getValue=function(){if(this.obj){if(_isFF){return this.obj.firstChild.value}else{return this.obj.value}}if(this.cell._clearCell){return""}if((!this.grid.multiLine)){return this.cell._brval||this.cell.innerHTML}else{return this.cell.innerHTML.replace(/<br[^>]*>/gi,"\n")._dhx_trim()}}}eXcell_txt.prototype=new eXcell;function eXcell_txttxt(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.getValue=function(){if((this.cell.firstChild)&&(this.cell.firstChild.tagName=="TEXTAREA")){return this.cell.firstChild.value}if(this.cell._clearCell){return""}if((!this.grid.multiLine)&&this.cell._brval){return this.cell._brval}return(_isIE?this.cell.innerText:this.cell.textContent)};this.setValue=function(C){this.cell._brval=C;if(!C||C.toString()._dhx_trim()==""){C=" ";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCTxtValue(C)}}eXcell_txttxt.prototype=new eXcell_txt;eXcell_txt.prototype.setValue=function(A){if(!A||A.toString()._dhx_trim()==""){A="&nbsp;";this.cell._clearCell=true}else{this.cell._clearCell=false}this.cell._brval=A;if((!this.grid.multiLine)){this.setCValue(A,A)}else{this.setCValue(A.replace(/\n/g,"<br/>"),A)}};function eXcell_co(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.combo=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex));this.editable=true}this.shiftNext=function(){var C=this.list.options[this.list.selectedIndex+1];if(C){C.selected=true}this.obj.value=this.list.options[this.list.selectedIndex].text;return true};this.shiftPrev=function(){if(this.list.selectedIndex!=0){var C=this.list.options[this.list.selectedIndex-1];if(C){C.selected=true}this.obj.value=this.list.options[this.list.selectedIndex].text}return true};this.edit=function(){this.val=this.getValue();this.text=this.getText()._dhx_trim();var E=this.grid.getPosition(this.cell);this.obj=document.createElement("TEXTAREA");this.obj.className="dhx_combo_edit";this.obj.style.height=(this.cell.offsetHeight-4)+"px";this.obj.wrap="soft";this.obj.style.textAlign=this.cell.style.textAlign;this.obj.onclick=function(K){(K||event).cancelBubble=true};this.obj.value=this.text;this.obj.onselectstart=function(K){if(!K){K=event}K.cancelBubble=true;return true};var H=this;this.obj.onkeyup=function(M){var L=(M||event).keyCode;if(L==38||L==40||L==9){return }var N=this.readonly?String.fromCharCode(L):this.value;var O=H.list.options;for(var K=0;K<O.length;K++){if(O[K].text.indexOf(N)==0){return O[K].selected=true}}};this.list=document.createElement("SELECT");this.list.className="dhx_combo_select";this.list.style.width=this.cell.offsetWidth+"px";this.list.style.left=E[0]+"px";this.list.style.top=E[1]+this.cell.offsetHeight+"px";this.list.onclick=function(M){var L=M||window.event;var K=L.target||L.srcElement;if(K.tagName=="OPTION"){K=K.parentNode}H.editable=false;H.grid.editStop()};var C=this.combo.getKeys();var F=false;var J=0;for(var D=0;D<C.length;D++){var I=this.combo.get(C[D]);this.list.options[this.list.options.length]=new Option(I,C[D]);if(C[D]==this.val){J=this.list.options.length-1;F=true}}if(F==false){this.list.options[this.list.options.length]=new Option(this.text,this.val===null?"":this.val);J=this.list.options.length-1}document.body.appendChild(this.list);this.list.size="6";this.cstate=1;if(this.editable){this.cell.innerHTML=""}else{this.obj.style.width="1px";this.obj.style.height="1px"}this.cell.appendChild(this.obj);this.list.options[J].selected=true;if((!_isFF)||(this.editable)){this.obj.focus();this.obj.focus()}if(!this.editable){this.obj.style.visibility="hidden";this.list.focus();this.list.onkeydown=function(K){K=K||window.event;H.grid.setActive(true);if(K.keyCode<30){return H.grid.doKey({target:H.cell,keyCode:K.keyCode,shiftKey:K.shiftKey,ctrlKey:K.ctrlKey})}}}};this.getValue=function(){return((this.cell.combo_value==window.undefined)?"":this.cell.combo_value)};this.detach=function(){if(this.val!=this.getValue()){this.cell.wasChanged=true}if(this.list.parentNode!=null){if(this.editable){var C=this.list.options[this.list.selectedIndex];if(C&&C.text==this.obj.value){this.setValue(this.list.value)}else{var D=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex));var E=D.values._dhx_find(this.obj.value);if(E!=-1){this.setValue(D.keys[E])}else{this.setCValue(this.cell.combo_value=this.obj.value)}}}else{this.setValue(this.list.value)}}if(this.list.parentNode){this.list.parentNode.removeChild(this.list)}if(this.obj.parentNode){this.obj.parentNode.removeChild(this.obj)}return this.val!=this.getValue()}}eXcell_co.prototype=new eXcell;eXcell_co.prototype.getText=function(){return this.cell.innerHTML};eXcell_co.prototype.setValue=function(E){if(typeof (E)=="object"){var D=this.grid.xmlLoader.doXPath("./option",E);if(D.length){this.cell._combo=new dhtmlXGridComboObject()}for(var C=0;C<D.length;C++){this.cell._combo.put(D[C].getAttribute("value"),D[C].firstChild?D[C].firstChild.data:"")}E=E.firstChild.data}if((E||"").toString()._dhx_trim()==""){E=null}this.cell.combo_value=E;if(E!==null){var A=(this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(E);this.setCValue(A===null?E:A,E)}else{this.setCValue("&nbsp;",E)}};function eXcell_coro(A){this.base=eXcell_co;this.base(A);this.editable=false}eXcell_coro.prototype=new eXcell_co;function eXcell_cotxt(A){this.base=eXcell_co;this.base(A)}eXcell_cotxt.prototype=new eXcell_co;eXcell_cotxt.prototype.getText=function(){return(_isIE?this.cell.innerText:this.cell.textContent)};eXcell_cotxt.prototype.setValue=function(D){if(typeof (D)=="object"){var C=this.grid.xmlLoader.doXPath("./option",D);if(C.length){this.cell._combo=new dhtmlXGridComboObject()}for(var A=0;A<C.length;A++){this.cell._combo.put(C[A].getAttribute("value"),C[A].firstChild?C[A].firstChild.data:"")}D=D.firstChild.data}if((D||"").toString()._dhx_trim()==""){D=null}if(D!==null){this.setCTxtValue((this.cell._combo||this.grid.getCombo(this.cell._cellIndex)).get(D)||D,D)}else{this.setCTxtValue(" ",D)}this.cell.combo_value=D};function eXcell_corotxt(A){this.base=eXcell_co;this.base(A);this.editable=false}eXcell_corotxt.prototype=new eXcell_cotxt;function eXcell_cp(A){try{this.cell=A;this.grid=this.cell.parentNode.grid}catch(C){}this.edit=function(){this.val=this.getValue();this.obj=document.createElement("SPAN");this.obj.style.border="1px solid black";this.obj.style.position="absolute";var D=this.grid.getPosition(this.cell);this.colorPanel(4,this.obj);document.body.appendChild(this.obj);this.obj.style.left=D[0]+"px";this.obj.style.zIndex=1;this.obj.style.top=D[1]+this.cell.offsetHeight+"px"};this.toolDNum=function(D){if(D.length==1){D="0"+D}return D};this.colorPanel=function(K,N){var I=document.createElement("TABLE");N.appendChild(I);I.cellSpacing=0;I.editor_obj=this;I.style.cursor="default";I.onclick=function(S){var Q=S||window.event;var O=Q.target||Q.srcElement;var P=O.parentNode.parentNode.parentNode.editor_obj;P.setValue(O._bg);P.grid.editStop()};var F=256/K;for(var H=0;H<=(256/F);H++){var D=I.insertRow(H);for(var J=0;J<=(256/F);J++){for(var E=0;E<=(256/F);E++){R=new Number(F*H)-(H==0?0:1);G=new Number(F*J)-(J==0?0:1);B=new Number(F*E)-(E==0?0:1);var M=this.toolDNum(R.toString(16))+""+this.toolDNum(G.toString(16))+""+this.toolDNum(B.toString(16));var L=D.insertCell(J);L.width="10px";L.innerHTML="&nbsp;";L.title=M.toUpperCase();L.style.backgroundColor="#"+M;L._bg="#"+M;if(this.val!=null&&"#"+M.toUpperCase()==this.val.toUpperCase()){L.style.border="2px solid white"}}}}};this.getValue=function(){return this.cell.firstChild._bg||""};this.getRed=function(){return Number(parseInt(this.getValue().substr(1,2),16))};this.getGreen=function(){return Number(parseInt(this.getValue().substr(3,2),16))};this.getBlue=function(){return Number(parseInt(this.getValue().substr(5,2),16))};this.detach=function(){if(this.obj.offsetParent!=null){document.body.removeChild(this.obj)}return this.val!=this.getValue()}}eXcell_cp.prototype=new eXcell;eXcell_cp.prototype.setValue=function(A){this.setCValue("<div style='width:100%;height:"+((this.grid.multiLine?this.cell.offsetHeight-2:16))+";background-color:"+(A||"")+";border:0px;'>&nbsp;</div>",A);this.cell.firstChild._bg=A};function eXcell_img(A){try{this.cell=A;this.grid=this.cell.parentNode.grid}catch(C){}this.getValue=function(){if(this.cell.firstChild.tagName=="IMG"){return this.cell.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"")}else{if(this.cell.firstChild.tagName=="A"){var D=this.cell.firstChild.firstChild.src+(this.cell.titFl!=null?"^"+this.cell._brval:"");D+="^"+this.cell.lnk;if(this.cell.trg){D+="^"+this.cell.trg}return D}}};this.isDisabled=function(){return true}}eXcell_img.prototype=new eXcell;eXcell_img.prototype.getTitle=function(){return this.cell._brval};eXcell_img.prototype.setValue=function(D){var C=D;if(D.indexOf("^")!=-1){var A=D.split("^");D=A[0];C=this.cell._attrs.title||A[1];if(A.length>2){this.cell.lnk=A[2];if(A[3]){this.cell.trg=A[3]}}this.cell.titFl="1"}this.setCValue("<img src='"+this.grid.iconURL+(D||"")._dhx_trim()+"' border='0'>",D);if(this.cell.lnk){this.cell.innerHTML="<a href='"+this.cell.lnk+"' target='"+this.cell.trg+"'>"+this.cell.innerHTML+"</a>"}this.cell._brval=C};function eXcell_price(A){this.base=eXcell_ed;this.base(A);this.getValue=function(){if(this.cell.childNodes.length>1){return this.cell.childNodes[1].innerHTML.toString()._dhx_trim()}else{return"0"}}}eXcell_price.prototype=new eXcell_ed;eXcell_price.prototype.setValue=function(C){if(isNaN(parseFloat(C))){C=this.val||0}var A="green";if(C<0){A="red"}this.setCValue("<span>$</span><span style='padding-right:2px;color:"+A+";'>"+C+"</span>",C)};function eXcell_dyn(A){this.base=eXcell_ed;this.base(A);this.getValue=function(){return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()}}eXcell_dyn.prototype=new eXcell_ed;eXcell_dyn.prototype.setValue=function(D){if(!D||isNaN(Number(D))){if(D!==""){D=0}}if(D>0){var C="green";var A="dyn_up.gif"}else{if(D==0){var C="black";var A="dyn_.gif"}else{var C="red";var A="dyn_down.gif"}}this.setCValue("<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='"+this.grid.imgURL+""+A+"' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:"+C+";'>"+D+"</span></div>",D)};function eXcell_ro(A){if(A){this.cell=A;this.grid=this.cell.parentNode.grid}this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell._clearCell?"":this.cell.innerHTML.toString()._dhx_trim()}}eXcell_ro.prototype=new eXcell;function eXcell_ron(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return true};this.getValue=function(){return this.cell._clearCell?"":this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(),this.cell._cellIndex)}}eXcell_ron.prototype=new eXcell;eXcell_ron.prototype.setValue=function(A){if(A===0){}else{if(!A||A.toString()._dhx_trim()==""){this.setCValue("&nbsp;");return this.cell._clearCell=true}}this.cell._clearCell=false;this.setCValue(A?this.grid._aplNF(A,this.cell._cellIndex):"0")};function eXcell_rotxt(A){this.cell=A;this.grid=this.cell.parentNode.grid;this.edit=function(){};this.isDisabled=function(){return true};this.setValue=function(C){if(!C||C.toString()._dhx_trim()==""){C=" ";this.cell._clearCell=true}else{this.cell._clearCell=false}this.setCTxtValue(C)};this.getValue=function(){if(this.cell._clearCell){return""}return(_isIE?this.cell.innerText:this.cell.textContent)}}eXcell_rotxt.prototype=new eXcell;function dhtmlXGridComboObject(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray();this.put=function(C,D){for(var A=0;A<this.keys.length;A++){if(this.keys[A]==C){this.values[A]=D;return true}}this.values[this.values.length]=D;this.keys[this.keys.length]=C};this.get=function(C){for(var A=0;A<this.keys.length;A++){if(this.keys[A]==C){return this.values[A]}}return null};this.clear=function(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray()};this.remove=function(C){for(var A=0;A<this.keys.length;A++){if(this.keys[A]==C){this.keys._dhx_removeAt(A);this.values._dhx_removeAt(A);return true}}};this.size=function(){var A=0;for(var C=0;C<this.keys.length;C++){if(this.keys[C]!=null){A++}}return A};this.getKeys=function(){var A=new Array(0);for(var C=0;C<this.keys.length;C++){if(this.keys[C]!=null){A[A.length]=this.keys[C]}}return A};this.save=function(){this._save=new Array();for(var A=0;A<this.keys.length;A++){this._save[A]=[this.keys[A],this.values[A]]}};this.restore=function(){if(this._save){this.keys[A]=new Array();this.values[A]=new Array();for(var A=0;A<this._save.length;A++){this.keys[A]=this._save[A][0];this.values[A]=this._save[A][1]}}};return this}function Hashtable(){this.keys=new dhtmlxArray();this.values=new dhtmlxArray();return this}Hashtable.prototype=new dhtmlXGridComboObject;var globalActiveDHTMLGridObject;String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(A){return dhtmlXHeir((A||new Array()),dhtmlxArray._master)}dhtmlxArray._master={_dhx_find:function(C){for(var A=0;A<this.length;A++){if(C==this[A]){return A}}return -1},_dhx_insertAt:function(D,C){this[this.length]=null;for(var A=this.length-1;A>=D;A--){this[A]=this[A-1]}this[D]=C},_dhx_removeAt:function(A){this.splice(A,1)},_dhx_swapItems:function(A,D){var C=this[A];this[A]=this[D];this[D]=C}};function dhtmlXGridObject(id){if(_isIE){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}if(id){if(typeof (id)=="object"){this.entBox=id;this.entBox.id="cgrid2_"+this.uid()}else{this.entBox=document.getElementById(id)}}else{this.entBox=document.createElement("DIV");this.entBox.id="cgrid2_"+this.uid()}this.entBox.innerHTML="";dhtmlxEventable(this);var self=this;this._wcorr=0;this.cell=null;this.row=null;this.iconURL="";this.editor=null;this._f2kE=true;this._dclE=true;this.combos=new Array(0);this.defVal=new Array(0);this.rowsAr={};this.rowsBuffer=dhtmlxArray();this.rowsCol=dhtmlxArray();this._data_cache={};this._ecache={};this._ud_enabled=true;this.xmlLoader=new dtmlXMLLoaderObject(this.doLoadDetails,this,true,this.no_cashe);this._maskArr=[];this.selectedRows=dhtmlxArray();this.UserData={};this._sizeFix=this._borderFix=0;this.entBox.className+=" gridbox";this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?(this.entBox.style.width||window.getComputedStyle(this.entBox,null)["width"]):(this.entBox.currentStyle?this.entBox.currentStyle.width:this.entBox.style.width||0))||"100%";this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?(this.entBox.style.height||window.getComputedStyle(this.entBox,null)["height"]):(this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0))||"100%";this.entBox.style.cursor="default";this.entBox.onselectstart=function(){return false};var t_creator=function(name){var t=document.createElement("TABLE");t.cellSpacing=t.cellPadding=0;t.style.cssText="width:100%;table-layout:fixed;";t.className=name.substr(2);return t};this.obj=t_creator("c_obj");this.hdr=t_creator("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.objBox=document.createElement("DIV");this.objBox.style.width="100%";this.objBox.style.overflow="auto";this.objBox.appendChild(this.obj);this.objBox.className="objbox";this.hdrBox=document.createElement("DIV");this.hdrBox.style.width="100%";this.hdrBox.style.height="25px";this.hdrBox.style.overflow="hidden";this.hdrBox.className="xhdr";this.preloadImagesAr=new Array(0);this.sortImg=document.createElement("IMG");this.sortImg.style.display="none";this.hdrBox.appendChild(this.sortImg);this.hdrBox.appendChild(this.hdr);this.hdrBox.style.position="relative";this.entBox.appendChild(this.hdrBox);this.entBox.appendChild(this.objBox);this.entBox.grid=this;this.objBox.grid=this;this.hdrBox.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=[];this.cellWidthPC=[];this.cellWidthType=this.entBox.cellwidthtype||"px";this.delim=this.entBox.delimiter||",";this._csvDelim=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this._srdh=(_isIE&&(document.compatMode!="BackCompat")?24:20);this.imgURL=window.dhx_globalImgPath||"";this.isActive=false;this.isEditable=true;this.useImagesInHeader=false;this.pagingOn=false;this.rowsBufferOutSize=0;dhtmlxEvent(window,"unload",function(){try{if(self.destructor){self.destructor()}}catch(e){}});this.setSkin=function(name){this.skin_name=name;this.entBox.className="gridbox gridbox_"+name;this.skin_h_correction=0;this.enableAlterCss("ev_"+name,"odd_"+name,this.isTreeGrid());this._fixAlterCss();switch(name){case"clear":this._topMb=document.createElement("DIV");this._topMb.className="topMumba";this._topMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinC_top_left.gif'><img style='right:20px' src='"+this.imgURL+"skinC_top_right.gif'>";this.entBox.appendChild(this._topMb);this._botMb=document.createElement("DIV");this._botMb.className="bottomMumba";this._botMb.innerHTML="<img style='left:0px'   src='"+this.imgURL+"skinD_bottom_left.gif'><img style='right:20px' src='"+this.imgURL+"skinD_bottom_right.gif'>";this.entBox.appendChild(this._botMb);this.entBox.style.position="relative";this.skin_h_correction=20;break;case"dhx_skyblue":case"dhx_web":case"glassy_blue":case"dhx_black":case"dhx_blue":case"modern":case"light":this._srdh=20;this.forceDivInHeader=true;break;case"xp":this.forceDivInHeader=true;if((_isIE)&&(document.compatMode!="BackCompat")){this._srdh=25}else{this._srdh=22}break;case"mt":if((_isIE)&&(document.compatMode!="BackCompat")){this._srdh=25}else{this._srdh=22}break;case"gray":if((_isIE)&&(document.compatMode!="BackCompat")){this._srdh=22}break;case"sbdark":break}if(_isIE&&this.hdr){var d=this.hdr.parentNode;d.removeChild(this.hdr);d.appendChild(this.hdr)}this.setSizes()};if(_isIE){this.preventIECaching(true)}if(window.dhtmlDragAndDropObject){this.dragger=new dhtmlDragAndDropObject()}this._doOnScroll=function(e,mode){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]);this.doOnScroll(e,mode)};this.doOnScroll=function(e,mode){this.hdrBox.scrollLeft=this.objBox.scrollLeft;if(this.ftr){this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft}if(mode){return }if(this._srnd){if(this._dLoadTimer){window.clearTimeout(this._dLoadTimer)}this._dLoadTimer=window.setTimeout(function(){if(self._update_srnd_view){self._update_srnd_view()}},100)}};this.attachToObject=function(obj){obj.appendChild(this.globalBox?this.globalBox:this.entBox);this.setSizes()};this.init=function(fl){if((this.isTreeGrid())&&(!this._h2)){this._h2=new dhtmlxHierarchy();if((this._fake)&&(!this._realfake)){this._fake._h2=this._h2}this._tgc={imgURL:null}}if(!this._hstyles){return }this.editStop();this.lastClicked=null;this.resized=null;this.fldSorted=this.r_fldSorted=null;this.cellWidthPX=[];this.cellWidthPC=[];if(this.hdr.rows.length>0){this.clearAll(true)}var hdrRow=this.hdr.insertRow(0);for(var i=0;i<this.hdrLabels.length;i++){hdrRow.appendChild(document.createElement("TH"));hdrRow.childNodes[i]._cellIndex=i;hdrRow.childNodes[i].style.height="0px"}if(_isIE&&_isIE<8){hdrRow.style.position="absolute"}else{hdrRow.style.height="auto"}var hdrRow=this.hdr.insertRow(_isKHTML?2:1);hdrRow._childIndexes=new Array();var col_ex=0;for(var i=0;i<this.hdrLabels.length;i++){hdrRow._childIndexes[i]=i-col_ex;if((this.hdrLabels[i]==this.splitSign)&&(i!=0)){if(_isKHTML){hdrRow.insertCell(i-col_ex)}hdrRow.cells[i-col_ex-1].colSpan=(hdrRow.cells[i-col_ex-1].colSpan||1)+1;hdrRow.childNodes[i-col_ex-1]._cellIndex++;col_ex++;hdrRow._childIndexes[i]=i-col_ex;continue}hdrRow.insertCell(i-col_ex);hdrRow.childNodes[i-col_ex]._cellIndex=i;hdrRow.childNodes[i-col_ex]._cellIndexS=i;this.setColumnLabel(i,this.hdrLabels[i])}if(col_ex==0){hdrRow._childIndexes=null}this._cCount=this.hdrLabels.length;if(_isIE){window.setTimeout(function(){self.setSizes()},1)}if(!this.obj.firstChild){this.obj.appendChild(document.createElement("TBODY"))}var tar=this.obj.firstChild;if(!tar.firstChild){tar.appendChild(document.createElement("TR"));tar=tar.firstChild;if(_isIE&&_isIE<8){tar.style.position="absolute"}else{tar.style.height="auto"}for(var i=0;i<this.hdrLabels.length;i++){tar.appendChild(document.createElement("TH"));tar.childNodes[i].style.height="0px"}}this._c_order=null;if(this.multiLine!=true){this.obj.className+=" row20px"}this.sortImg.style.position="absolute";this.sortImg.style.display="none";this.sortImg.src=this.imgURL+"sort_desc.gif";this.sortImg.defLeft=0;if(this.noHeader){this.hdrBox.style.display="none"}else{this.noHeader=false}if(this._ivizcol){this.setColHidden()}this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();if(fl){this.parseXML()}this.obj.scrollTop=0;if(this.dragAndDropOff){this.dragger.addDragLanding(this.entBox,this)}if(this._initDrF){this._initD()}if(this._init_point){this._init_point()}};this.setColumnSizes=function(gridWidth){var summ=0;var fcols=[];for(var i=0;i<this._cCount;i++){if((this.initCellWidth[i]=="*")&&!this._hrrar[i]){this._awdth=false;fcols.push(i);continue}if(this.cellWidthType=="%"){if(typeof this.cellWidthPC[i]=="undefined"){this.cellWidthPC[i]=this.initCellWidth[i]}this.cellWidthPX[i]=Math.floor(gridWidth*this.cellWidthPC[i]/100)||0}else{if(typeof this.cellWidthPX[i]=="undefined"){this.cellWidthPX[i]=this.initCellWidth[i]}}if(!this._hrrar[i]){summ+=this.cellWidthPX[i]*1}}if(fcols.length){var ms=Math.floor((gridWidth-summ)/fcols.length);if(ms<0){ms=1}for(var i=0;i<fcols.length;i++){var next=Math.max((this._drsclmW?this._drsclmW[fcols[i]]:0),ms);this.cellWidthPX[fcols[i]]=next;summ+=next}if(gridWidth>summ){var last=fcols[fcols.length-1];this.cellWidthPX[last]=this.cellWidthPX[last]+(gridWidth-summ);summ=gridWidth}this._setAutoResize()}this.obj.style.width=summ+"px";this.hdr.style.width=summ+"px";if(this.ftr){this.ftr.style.width=summ+"px"}this.chngCellWidth();return summ};this.setSizes=function(){if((!this.hdr.rows[0])){return }var quirks=this.quirks=(_isIE&&document.compatMode=="BackCompat");var outerBorder=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(this.globalBox){var splitOuterBorder=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._delta_x&&!this._realfake){var ow=this.globalBox.clientWidth;this.globalBox.style.width=this._delta_x;this.entBox.style.width=Math.max(0,(this.globalBox.clientWidth+(quirks?splitOuterBorder*2:0))-this._fake.entBox.clientWidth)+"px";if(ow!=this.globalBox.clientWidth){this._fake._correctSplit(this._fake.entBox.clientWidth)}}if(this._delta_y&&!this._realfake){this.globalBox.style.height=this._delta_y;this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden";this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(quirks?splitOuterBorder*2:0)+"px"}}else{if(this._delta_x){if(this.entBox.parentNode.tagName=="TD"){this.entBox.style.width="1px";this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-outerBorder*2+"px"}else{this.entBox.style.width=this._delta_x}}if(this._delta_y){this.entBox.style.height=this._delta_y}}window.clearTimeout(this._sizeTime);if(!this.entBox.offsetWidth&&(!this.globalBox||!this.globalBox.offsetWidth)){this._sizeTime=window.setTimeout(function(){self.setSizes()},250);return }var border_x=(((this.entBox.cmp||this._delta_x)&&(this.skin_name||"").indexOf("dhx")==0&&!quirks)?2:0);var border_y=(((this.entBox.cmp||this._delta_y)&&(this.skin_name||"").indexOf("dhx")==0&&!quirks)?2:0);var isVScroll=this.parentGrid?false:(this.objBox.scrollHeight>this.objBox.offsetHeight);var scrfix=_isFF?18:18;var gridWidth=this.entBox.clientWidth-(this.skin_h_correction||0)*(quirks?0:1)-border_x;var gridWidthActive=this.entBox.clientWidth-(this.skin_h_correction||0)-border_x;var gridHeight=this.entBox.clientHeight-border_y;var summ=this.setColumnSizes(gridWidthActive-(isVScroll?scrfix:0)-(this._correction_x||0));var isHScroll=this.parentGrid?false:((this.objBox.scrollWidth>this.objBox.offsetWidth)||(this.objBox.style.overflowX=="scroll"));var headerHeight=this.hdr.clientHeight;var footerHeight=this.ftr?this.ftr.clientHeight:0;var newWidth=gridWidth;var newHeight=gridHeight-headerHeight-footerHeight;if(this._awdth&&this._awdth[0]&&this._awdth[1]==99999){isHScroll=0}if(this._ahgr){if(this._ahgrMA){newHeight=this.entBox.parentNode.clientHeight-headerHeight-footerHeight}else{newHeight=this.obj.offsetHeight+(isHScroll?scrfix:0)+(this._correction_y||0)}if(this._ahgrM){if(this._ahgrF){newHeight=Math.min(this._ahgrM,newHeight+headerHeight+footerHeight)-headerHeight-footerHeight}else{newHeight=Math.min(this._ahgrM,newHeight)}}if(isVScroll&&newHeight>=this.obj.scrollHeight+(isHScroll?scrfix:0)){isVScroll=false;this.setColumnSizes(gridWidthActive-(this._correction_x||0))}}if((this._awdth)&&(this._awdth[0])){if(this.cellWidthType=="%"){this.cellWidthType="px"}if(this._fake){summ+=this._fake.entBox.clientWidth}var newWidth=Math.min(Math.max(summ+(isVScroll?scrfix:0),this._awdth[2]),this._awdth[1])+(this._correction_x||0);if(this._fake){newWidth-=this._fake.entBox.clientWidth}}newHeight=Math.max(0,newHeight);this._ff_size_delta=(this._ff_size_delta==0.1)?0.2:0.1;if(!_isFF){this._ff_size_delta=0}this.entBox.style.width=Math.max(0,newWidth+(quirks?2:0)*outerBorder+this._ff_size_delta)+"px";this.entBox.style.height=newHeight+(quirks?2:0)*outerBorder+headerHeight+footerHeight+"px";this.objBox.style.height=newHeight+((quirks&&!isVScroll)?2:0)*outerBorder+"px";this.hdrBox.style.height=headerHeight+"px";if(newHeight!=gridHeight){this.doOnScroll(0,!this._srnd)}var ext=this["setSizes_"+this.skin_name];if(ext){ext.call(this)}this.setSortImgPos();if(headerHeight!=this.hdr.clientHeight&&this._ahgr){this.setSizes()}this.callEvent("onSetSizes",[])};this.setSizes_clear=function(){var y=this.hdr.offsetHeight;var x=this.entBox.offsetWidth;var y2=y+this.objBox.offsetHeight;this._topMb.style.top=(y||0)+"px";this._topMb.style.width=(x+20)+"px";this._botMb.style.top=(y2-3)+"px";this._botMb.style.width=(x+20)+"px"};this.chngCellWidth=function(){if((_isOpera)&&(this.ftr)){this.ftr.width=this.objBox.scrollWidth+"px"}var l=this._cCount;for(var i=0;i<l;i++){this.hdr.rows[0].cells[i].style.width=this.cellWidthPX[i]+"px";this.obj.rows[0].childNodes[i].style.width=this.cellWidthPX[i]+"px";if(this.ftr){this.ftr.rows[0].cells[i].style.width=this.cellWidthPX[i]+"px"}}};this.setDelimiter=function(delim){this.delim=delim};this.setInitWidthsP=function(wp){this.cellWidthType="%";this.initCellWidth=wp.split(this.delim.replace(/px/gi,""));if(!arguments[1]){this._setAutoResize()}};this._setAutoResize=function(){if(this._realfake){return }var el=window;var self=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(self._resize_timer);if(self._setAutoResize){self._resize_timer=window.setTimeout(function(){self.setSizes();if(self._fake){self._fake._correctSplit()}},100)}})};this.setInitWidths=function(wp){this.cellWidthType="px";this.initCellWidth=wp.split(this.delim);if(_isFF){for(var i=0;i<this.initCellWidth.length;i++){if(this.initCellWidth[i]!="*"){this.initCellWidth[i]=parseInt(this.initCellWidth[i])}}}};this.enableMultiline=function(state){this.multiLine=convertStringToBoolean(state)};this.enableMultiselect=function(state){this.selMultiRows=convertStringToBoolean(state)};this.setImagePath=function(path){this.imgURL=path};this.setImagesPath=this.setImagePath;this.setIconPath=function(path){this.iconURL=path};this.setIconsPath=this.setIconPath;this.changeCursorState=function(ev){var el=ev.target||ev.srcElement;if(el.tagName!="TD"){el=this.getFirstParentOfType(el,"TD")}if(!el){return }if((el.tagName=="TD")&&(this._drsclmn)&&(!this._drsclmn[el._cellIndex])){return el.style.cursor="default"}var check=(ev.layerX||0)+(((!_isIE)&&(ev.target.tagName=="DIV"))?el.offsetLeft:0);if((el.offsetWidth-(ev.offsetX||(parseInt(this.getPosition(el,this.hdrBox))-check)*-1))<(_isOpera?20:10)){el.style.cursor="E-resize"}else{el.style.cursor="default"}if(_isOpera){this.hdrBox.scrollLeft=this.objBox.scrollLeft}};this.startColResize=function(ev){if(this.resized){this.stopColResize()}this.resized=null;var el=ev.target||ev.srcElement;if(el.tagName!="TD"){el=this.getFirstParentOfType(el,"TD")}var x=ev.clientX;var tabW=this.hdr.offsetWidth;var startW=parseInt(el.offsetWidth);if(el.tagName=="TD"&&el.style.cursor!="default"){if((this._drsclmn)&&(!this._drsclmn[el._cellIndex])){return }self._old_d_mm=document.body.onmousemove;self._old_d_mu=document.body.onmouseup;document.body.onmousemove=function(e){if(self){self.doColResize(e||window.event,el,startW,x,tabW)}};document.body.onmouseup=function(){if(self){self.stopColResize()}}}};this.stopColResize=function(){document.body.onmousemove=self._old_d_mm||"";document.body.onmouseup=self._old_d_mu||"";this.setSizes();this.doOnScroll(0,1);this.callEvent("onResizeEnd",[this])};this.doColResize=function(ev,el,startW,x,tabW){el.style.cursor="E-resize";this.resized=el;var fcolW=startW+(ev.clientX-x);var wtabW=tabW+(ev.clientX-x);if(!(this.callEvent("onResize",[el._cellIndex,fcolW,this]))){return }if(_isIE){this.objBox.scrollLeft=this.hdrBox.scrollLeft}if(el.colSpan>1){var a_sizes=new Array();for(var i=0;i<el.colSpan;i++){a_sizes[i]=Math.round(fcolW*this.hdr.rows[0].childNodes[el._cellIndexS+i].offsetWidth/el.offsetWidth)}for(var i=0;i<el.colSpan;i++){this._setColumnSizeR(el._cellIndexS+i*1,a_sizes[i])}}else{this._setColumnSizeR(el._cellIndex,fcolW)}this.doOnScroll(0,1);this.setSizes();if(this._fake&&this._awdth){this._fake._correctSplit()}};this._setColumnSizeR=function(ind,fcolW){if(fcolW>((this._drsclmW&&!this._notresize)?(this._drsclmW[ind]||10):10)){this.obj.rows[0].childNodes[ind].style.width=fcolW+"px";this.hdr.rows[0].childNodes[ind].style.width=fcolW+"px";if(this.ftr){this.ftr.rows[0].childNodes[ind].style.width=fcolW+"px"}if(this.cellWidthType=="px"){this.cellWidthPX[ind]=fcolW}else{var gridWidth=parseInt(this.entBox.offsetWidth);if(this.objBox.scrollHeight>this.objBox.offsetHeight){gridWidth-=17}var pcWidth=Math.round(fcolW/gridWidth*100);this.cellWidthPC[ind]=pcWidth}if(this.sortImg.style.display!="none"){this.setSortImgPos()}}};this.setSortImgState=function(state,ind,order,row){order=(order||"asc").toLowerCase();if(!convertStringToBoolean(state)){this.sortImg.style.display="none";this.fldSorted=null;return }if(order=="asc"){this.sortImg.src=this.imgURL+"sort_asc.gif"}else{this.sortImg.src=this.imgURL+"sort_desc.gif"}this.sortImg.style.display="";this.fldSorted=this.hdr.rows[0].childNodes[ind];var r=this.hdr.rows[row||1];if(!r){return }for(var i=0;i<r.childNodes.length;i++){if(r.childNodes[i]._cellIndexS==ind){this.r_fldSorted=r.childNodes[i];return this.setSortImgPos()}}return this.setSortImgState(state,ind,order,(row||1)+1)};this.setSortImgPos=function(ind,mode,hRowInd,el){if(this._hrrar&&this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:ind]){return }if(!el){if(!ind){var el=this.r_fldSorted}else{var el=this.hdr.rows[hRowInd||0].cells[ind]}}if(el!=null){var pos=this.getPosition(el,this.hdrBox);var wdth=el.offsetWidth;this.sortImg.style.left=Number(pos[0]+wdth-13)+"px";this.sortImg.defLeft=parseInt(this.sortImg.style.left);this.sortImg.style.top=Number(pos[1]+5)+"px";if((!this.useImagesInHeader)&&(!mode)){this.sortImg.style.display="inline"}this.sortImg.style.left=this.sortImg.defLeft+"px"}};this.setActive=function(fl){if(arguments.length==0){var fl=true}if(fl==true){if(globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject!=this)){globalActiveDHTMLGridObject.editStop();globalActiveDHTMLGridObject.callEvent("onBlur",[globalActiveDHTMLGridObject])}globalActiveDHTMLGridObject=this;this.isActive=true}else{this.isActive=false;this.callEvent("onBlur",[this])}};this._doClick=function(ev){var selMethod=0;var el=this.getFirstParentOfType(_isIE?ev.srcElement:ev.target,"TD");if(!el){return }var fl=true;if(this.markedCells){var markMethod=0;if(ev.shiftKey||ev.metaKey){markMethod=1}if(ev.ctrlKey){markMethod=2}this.doMark(el,markMethod);return true}if(this.selMultiRows!=false){if(ev.shiftKey&&this.row!=null&&this.selectedRows.length){selMethod=1}if(ev.ctrlKey||ev.metaKey){selMethod=2}}this.doClick(el,fl,selMethod)};this._doContClick=function(ev){var el=this.getFirstParentOfType(_isIE?ev.srcElement:ev.target,"TD");if((!el)||(typeof (el.parentNode.idd)=="undefined")){return true}if(ev.button==2||(_isMacOS&&ev.ctrlKey)){if(!this.callEvent("onRightClick",[el.parentNode.idd,el._cellIndex,ev])){var z=function(e){(e||event).cancelBubble=true;return false};(ev.srcElement||ev.target).oncontextmenu=z;return z(ev)}if(this._ctmndx){if(!(this.callEvent("onBeforeContextMenu",[el.parentNode.idd,el._cellIndex,this]))){return true}if(_isIE){ev.srcElement.oncontextmenu=function(){event.cancelBubble=true;return false}}if(this._ctmndx.showContextMenu){var dEl0=window.document.documentElement;var dEl1=window.document.body;var corrector=new Array((dEl0.scrollLeft||dEl1.scrollLeft),(dEl0.scrollTop||dEl1.scrollTop));if(_isIE){var x=ev.clientX+corrector[0];var y=ev.clientY+corrector[1]}else{var x=ev.pageX;var y=ev.pageY}this._ctmndx.showContextMenu(x-1,y-1);this.contextID=this._ctmndx.contextMenuZoneId=el.parentNode.idd+"_"+el._cellIndex;this._ctmndx._skip_hide=true}else{el.contextMenuId=el.parentNode.idd+"_"+el._cellIndex;el.contextMenu=this._ctmndx;el.a=this._ctmndx._contextStart;el.a(el,ev);el.a=null}ev.cancelBubble=true;return false}}else{if(this._ctmndx){if(this._ctmndx.hideContextMenu){this._ctmndx.hideContextMenu()}else{this._ctmndx._contextEnd()}}}return true};this.doClick=function(el,fl,selMethod,show){if(!this.selMultiRows){selMethod=0}var psid=this.row?this.row.idd:0;this.setActive(true);if(!selMethod){selMethod=0}if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,"")}if(el.tagName=="TD"){if(this.checkEvent("onSelectStateChanged")){var initial=this.getSelectedId()}var prow=this.row;if(selMethod==1){var elRowIndex=this.rowsCol._dhx_find(el.parentNode);var lcRowIndex=this.rowsCol._dhx_find(this.lastClicked);if(elRowIndex>lcRowIndex){var strt=lcRowIndex;var end=elRowIndex}else{var strt=elRowIndex;var end=lcRowIndex}for(var i=0;i<this.rowsCol.length;i++){if((i>=strt&&i<=end)){if(this.rowsCol[i]&&(!this.rowsCol[i]._sRow)){if(this.rowsCol[i].className.indexOf("rowselected")==-1&&this.callEvent("onBeforeSelect",[this.rowsCol[i].idd,psid])){this.rowsCol[i].className+=" rowselected";this.selectedRows[this.selectedRows.length]=this.rowsCol[i]}}else{this.clearSelection();return this.doClick(el,fl,0,show)}}}}else{if(selMethod==2){if(el.parentNode.className.indexOf("rowselected")!=-1){el.parentNode.className=el.parentNode.className.replace(/rowselected/g,"");this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(el.parentNode));var skipRowSelection=true}}}this.editStop();if(typeof (el.parentNode.idd)=="undefined"){return true}if((!skipRowSelection)&&(!el.parentNode._sRow)){if(this.callEvent("onBeforeSelect",[el.parentNode.idd,psid])){if(selMethod==0){this.clearSelection()}this.cell=el;if((prow==el.parentNode)&&(this._chRRS)){fl=false}this.row=el.parentNode;this.row.className+=" rowselected";if(this.cell&&_isIE&&_isIE==8){var next=this.cell.nextSibling;var parent=this.cell.parentNode;parent.removeChild(this.cell);parent.insertBefore(this.cell,next)}if(this.selectedRows._dhx_find(this.row)==-1){this.selectedRows[this.selectedRows.length]=this.row}}else{fl=false}}if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1){this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected"}if(selMethod!=1){if(!this.row){return }}this.lastClicked=el.parentNode;var rid=this.row.idd;var cid=this.cell;if(fl&&typeof (rid)!="undefined"&&cid&&!skipRowSelection){self.onRowSelectTime=setTimeout(function(){self.callEvent("onRowSelect",[rid,cid._cellIndex])},100)}else{if(this._rsMode){this.callEvent("onRowSelectRSOnly",[rid])}}if(this.checkEvent("onSelectStateChanged")){var afinal=this.getSelectedId();if(initial!=afinal){this.callEvent("onSelectStateChanged",[afinal,initial])}}}this.isActive=true;if(show!==false&&this.cell&&this.cell.parentNode.idd){this.moveToVisible(this.cell)}};this.selectAll=function(){this.clearSelection();var coll=this.rowsBuffer;if(this.pagingOn){coll=this.rowsCol}for(var i=0;i<coll.length;i++){this.render_row(i).className+=" rowselected"}this.selectedRows=dhtmlxArray([].concat(coll));if(this.selectedRows.length){this.row=this.selectedRows[0];this.cell=this.row.cells[0]}if((this._fake)&&(!this._realfake)){this._fake.selectAll()}};this.selectCell=function(r,cInd,fl,preserve,edit,show){if(!fl){fl=false}if(typeof (r)!="object"){r=this.render_row(r)}if(!r||r==-1){return null}if(r._childIndexes){var c=r.childNodes[r._childIndexes[cInd]]}else{var c=r.childNodes[cInd]}if(!c){c=r.childNodes[0]}if(preserve){this.doClick(c,fl,3,show)}else{this.doClick(c,fl,0,show)}if(edit){this.editCell()}};this.moveToVisible=function(cell_obj,onlyVScroll){if(this.pagingOn){var newPage=Math.floor(this.getRowIndex(cell_obj.parentNode.idd)/this.rowsBufferOutSize)+1;if(newPage!=this.currentPage){this.changePage(newPage)}}try{if(cell_obj.offsetHeight){var distance=cell_obj.offsetLeft+cell_obj.offsetWidth+20;var scrollLeft=0;if(distance>(this.objBox.offsetWidth+this.objBox.scrollLeft)){if(cell_obj.offsetLeft>this.objBox.scrollLeft){scrollLeft=cell_obj.offsetLeft-5}}else{if(cell_obj.offsetLeft<this.objBox.scrollLeft){distance-=cell_obj.offsetWidth*2/3;if(distance<this.objBox.scrollLeft){scrollLeft=cell_obj.offsetLeft-5}}}if((scrollLeft)&&(!onlyVScroll)){this.objBox.scrollLeft=scrollLeft}}if(!cell_obj.offsetHeight){var mask=this._realfake?this._fake.rowsAr[cell_obj.parentNode.idd]:cell_obj.parentNode;distance=this.rowsBuffer._dhx_find(mask)*this._srdh}else{distance=cell_obj.offsetTop}var distancemax=distance+cell_obj.offsetHeight+20;if(distancemax>(this.objBox.offsetHeight+this.objBox.scrollTop)){var scrollTop=distancemax-this.objBox.offsetHeight}else{if(distance<this.objBox.scrollTop){var scrollTop=distance-5}}if(scrollTop){this.objBox.scrollTop=scrollTop}}catch(er){}};this.editCell=function(){if(this.editor&&this.cell==this.editor.cell){return }this.editStop();if((this.isEditable!=true)||(!this.cell)){return false}var c=this.cell;if(c.parentNode._locked){return false}this.editor=this.cells4(c);if(this.editor!=null){if(this.editor.isDisabled()){this.editor=null;return false}if(this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!=false&&this.editor.edit){this._Opera_stop=(new Date).valueOf();c.className+=" editable";this.editor.edit();this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])}else{this.editor=null}}};this.editStop=function(mode){if(_isOpera){if(this._Opera_stop){if((this._Opera_stop*1+50)>(new Date).valueOf()){return }this._Opera_stop=null}}if(this.editor&&this.editor!=null){this.editor.cell.className=this.editor.cell.className.replace("editable","");if(mode){var t=this.editor.val;this.editor.detach();this.editor.setValue(t);this.editor=null;this.callEvent("onEditCancel",[this.row.idd,this.cell._cellIndex,t]);return }if(this.editor.detach()){this.cell.wasChanged=true}var g=this.editor;this.editor=null;var z=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,g.getValue(),g.val]);if((typeof (z)=="string")||(typeof (z)=="number")){g[g.setImage?"setLabel":"setValue"](z)}else{if(!z){g[g.setImage?"setLabel":"setValue"](g.val)}}if(this._ahgr&&this.multiLine){this.setSizes()}}};this._nextRowCell=function(row,dir,pos){row=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(row),dir);if(!row){return null}return row.childNodes[row._childIndexes?row._childIndexes[pos]:pos]};this._getNextCell=function(acell,dir,i){acell=acell||this.cell;var arow=acell.parentNode;if(this._tabOrder){i=this._tabOrder[acell._cellIndex];if(typeof i!="undefined"){if(i<0){acell=this._nextRowCell(arow,dir,Math.abs(i)-1)}else{acell=arow.childNodes[i]}}}else{var i=acell._cellIndex+dir;if(i>=0&&i<this._cCount){if(arow._childIndexes){i=arow._childIndexes[acell._cellIndex]+dir}acell=arow.childNodes[i]}else{acell=this._nextRowCell(arow,dir,(dir==1?0:(this._cCount-1)))}}if(!acell){if((dir==1)&&this.tabEnd){this.tabEnd.focus();this.tabEnd.focus();this.setActive(false)}if((dir==-1)&&this.tabStart){this.tabStart.focus();this.tabStart.focus();this.setActive(false)}return null}if(acell.style.display!="none"&&(!this.smartTabOrder||!this.cells(acell.parentNode.idd,acell._cellIndex).isDisabled())){return acell}return this._getNextCell(acell,dir)};this._nextRow=function(ind,dir){var r=this.render_row(ind+dir);if(!r||r==-1){return null}if(r&&r.style.display=="none"){return this._nextRow(ind+dir,dir)}return r};this.scrollPage=function(dir){if(!this.rowsBuffer.length){return }var master=this._realfake?this._fake:this;var new_ind=Math.floor((master._r_select||this.getRowIndex(this.row.idd)||0)+(dir)*this.objBox.offsetHeight/(this._srdh||20));if(new_ind<0){new_ind=0}if(new_ind>=this.rowsBuffer.length){new_ind=this.rowsBuffer.length-1}if(this._srnd&&!this.rowsBuffer[new_ind]){this.objBox.scrollTop+=Math.floor((dir)*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||20);if(this._fake){this._fake.objBox.scrollTop=this.objBox.scrollTop}master._r_select=new_ind}else{this.selectCell(new_ind,this.cell._cellIndex,true,false,false,(this.multiLine||this._srnd));if(!this.multiLine&&!this._srnd&&!this._realfake){this.objBox.scrollTop=this.getRowById(this.getRowId(new_ind)).offsetTop;if(this._fake){this._fake.objBox.scrollTop=this.objBox.scrollTop}}master._r_select=null}};this.doKey=function(ev){if(!ev){return true}if((ev.target||ev.srcElement).value!==window.undefined){var zx=(ev.target||ev.srcElement);if((!zx.parentNode)||(zx.parentNode.className.indexOf("editable")==-1)){return true}}if((globalActiveDHTMLGridObject)&&(this!=globalActiveDHTMLGridObject)){return globalActiveDHTMLGridObject.doKey(ev)}if(this.isActive==false){return true}if(this._htkebl){return true}if(!this.callEvent("onKeyPress",[ev.keyCode,ev.ctrlKey,ev.shiftKey,ev])){return false}var code="k"+ev.keyCode+"_"+(ev.ctrlKey?1:0)+"_"+(ev.shiftKey?1:0);if(this.cell){if(this._key_events[code]){if(false===this._key_events[code].call(this)){return true}if(ev.preventDefault){ev.preventDefault()}ev.cancelBubble=true;return false}if(this._key_events.k_other){this._key_events.k_other.call(this,ev)}}return true};this.selectRow=function(r,fl,preserve,show){if(typeof (r)!="object"){r=this.render_row(r)}this.selectCell(r,0,fl,preserve,false,show)};this.wasDblClicked=function(ev){var el=this.getFirstParentOfType(_isIE?ev.srcElement:ev.target,"TD");if(el){var rowId=el.parentNode.idd;return this.callEvent("onRowDblClicked",[rowId,el._cellIndex])}};this._onHeaderClick=function(e,el){var that=this.grid;el=el||that.getFirstParentOfType(_isIE?event.srcElement:e.target,"TD");if(this.grid.resized==null){if(!(this.grid.callEvent("onHeaderClick",[el._cellIndexS,(e||window.event)]))){return false}that.sortField(el._cellIndexS,false,el)}this.grid.resized=null};this.deleteSelectedRows=function(){var num=this.selectedRows.length;if(num==0){return }var tmpAr=this.selectedRows;this.selectedRows=dhtmlxArray();for(var i=num-1;i>=0;i--){var node=tmpAr[i];if(!this.deleteRow(node.idd,node)){this.selectedRows[this.selectedRows.length]=node}else{if(node==this.row){var ind=i}}}if(ind){try{if(ind+1>this.rowsCol.length){ind--}this.selectCell(ind,0,true)}catch(er){this.row=null;this.cell=null}}};this.getSelectedRowId=function(){var selAr=new Array(0);var uni={};for(var i=0;i<this.selectedRows.length;i++){var id=this.selectedRows[i].idd;if(uni[id]){continue}selAr[selAr.length]=id;uni[id]=true}if(selAr.length==0){return null}else{return selAr.join(this.delim)}};this.getSelectedCellIndex=function(){if(this.cell!=null){return this.cell._cellIndex}else{return -1}};this.getColWidth=function(ind){return parseInt(this.cellWidthPX[ind])};this.setColWidth=function(ind,value){if(this._hrrar[ind]){return }if(this.cellWidthType=="px"){this.cellWidthPX[ind]=parseInt(value)}else{this.cellWidthPC[ind]=parseInt(value)}this.setSizes()};this.getRowIndex=function(row_id){for(var i=0;i<this.rowsBuffer.length;i++){if(this.rowsBuffer[i]&&this.rowsBuffer[i].idd==row_id){return i}}return -1};this.getRowId=function(ind){return this.rowsBuffer[ind]?this.rowsBuffer[ind].idd:this.undefined};this.setRowId=function(ind,row_id){this.changeRowId(this.getRowId(ind),row_id)};this.changeRowId=function(oldRowId,newRowId){if(oldRowId==newRowId){return }var row=this.rowsAr[oldRowId];row.idd=newRowId;if(this.UserData[oldRowId]){this.UserData[newRowId]=this.UserData[oldRowId];this.UserData[oldRowId]=null}if(this._h2&&this._h2.get[oldRowId]){this._h2.get[newRowId]=this._h2.get[oldRowId];this._h2.get[newRowId].id=newRowId;delete this._h2.get[oldRowId]}this.rowsAr[oldRowId]=null;this.rowsAr[newRowId]=row;for(var i=0;i<row.childNodes.length;i++){if(row.childNodes[i]._code){row.childNodes[i]._code=this._compileSCL(row.childNodes[i]._val,row.childNodes[i])}}if(this._mat_links&&this._mat_links[oldRowId]){var a=this._mat_links[oldRowId];delete this._mat_links[oldRowId];for(var c in a){for(var i=0;i<a[c].length;i++){this._compileSCL(a[c][i].original,a[c][i])}}}this.callEvent("onRowIdChange",[oldRowId,newRowId])};this.setColumnIds=function(ids){this.columnIds=ids.split(this.delim)};this.setColumnId=function(ind,id){this.columnIds[ind]=id};this.getColIndexById=function(id){for(var i=0;i<this.columnIds.length;i++){if(this.columnIds[i]==id){return i}}};this.getColumnId=function(cin){return this.columnIds[cin]};this.getColumnLabel=function(cin,ind,hdr){var z=(hdr||this.hdr).rows[(ind||0)+1];for(var i=0;i<z.cells.length;i++){if(z.cells[i]._cellIndexS==cin){return(_isIE?z.cells[i].innerText:z.cells[i].textContent)}}return""};this.getColLabel=this.getColumnLabel;this.getFooterLabel=function(cin,ind){return this.getColumnLabel(cin,ind,this.ftr)};this.setRowTextBold=function(row_id){var r=this.getRowById(row_id);if(r){r.style.fontWeight="bold"}};this.setRowTextStyle=function(row_id,styleString){var r=this.getRowById(row_id);if(!r){return }for(var i=0;i<r.childNodes.length;i++){var pfix=r.childNodes[i]._attrs.style||"";if((this._hrrar)&&(this._hrrar[i])){pfix="display:none;"}if(_isIE){r.childNodes[i].style.cssText=pfix+"width:"+r.childNodes[i].style.width+";"+styleString}else{r.childNodes[i].style.cssText=pfix+"width:"+r.childNodes[i].style.width+";"+styleString}}};this.setRowColor=function(row_id,color){var r=this.getRowById(row_id);for(var i=0;i<r.childNodes.length;i++){r.childNodes[i].bgColor=color}};this.setCellTextStyle=function(row_id,ind,styleString){var r=this.getRowById(row_id);if(!r){return }var cell=r.childNodes[r._childIndexes?r._childIndexes[ind]:ind];if(!cell){return }var pfix="";if((this._hrrar)&&(this._hrrar[ind])){pfix="display:none;"}if(_isIE){cell.style.cssText=pfix+"width:"+cell.style.width+";"+styleString}else{cell.style.cssText=pfix+"width:"+cell.style.width+";"+styleString}};this.setRowTextNormal=function(row_id){var r=this.getRowById(row_id);if(r){r.style.fontWeight="normal"}};this.doesRowExist=function(row_id){if(this.getRowById(row_id)!=null){return true}else{return false}};this.getColumnsNum=function(){return this._cCount};this.moveRowUp=function(row_id){var r=this.getRowById(row_id);if(this.isTreeGrid()){return this.moveRowUDTG(row_id,-1)}var rInd=this.rowsCol._dhx_find(r);if((r.previousSibling)&&(rInd!=0)){r.parentNode.insertBefore(r,r.previousSibling);this.rowsCol._dhx_swapItems(rInd,rInd-1);this.setSizes();var bInd=this.rowsBuffer._dhx_find(r);this.rowsBuffer._dhx_swapItems(bInd,bInd-1);if(this._cssEven){this._fixAlterCss(rInd-1)}}};this.moveRowDown=function(row_id){var r=this.getRowById(row_id);if(this.isTreeGrid()){return this.moveRowUDTG(row_id,1)}var rInd=this.rowsCol._dhx_find(r);if(r.nextSibling){this.rowsCol._dhx_swapItems(rInd,rInd+1);if(r.nextSibling.nextSibling){r.parentNode.insertBefore(r,r.nextSibling.nextSibling)}else{r.parentNode.appendChild(r)}this.setSizes();var bInd=this.rowsBuffer._dhx_find(r);this.rowsBuffer._dhx_swapItems(bInd,bInd+1);if(this._cssEven){this._fixAlterCss(rInd)}}};this.getCombo=function(col_ind){if(!this.combos[col_ind]){this.combos[col_ind]=new dhtmlXGridComboObject()}return this.combos[col_ind]};this.setUserData=function(row_id,name,value){if(!row_id){row_id="gridglobaluserdata"}if(!this.UserData[row_id]){this.UserData[row_id]=new Hashtable()}this.UserData[row_id].put(name,value)};this.getUserData=function(row_id,name){if(!row_id){row_id="gridglobaluserdata"}this.getRowById(row_id);var z=this.UserData[row_id];return(z?z.get(name):"")};this.setEditable=function(fl){this.isEditable=convertStringToBoolean(fl)};this.selectRowById=function(row_id,multiFL,show,call){if(!call){call=false}this.selectCell(this.getRowById(row_id),0,call,multiFL,false,show)};this.clearSelection=function(){this.editStop();for(var i=0;i<this.selectedRows.length;i++){var r=this.rowsAr[this.selectedRows[i].idd];if(r){r.className=r.className.replace(/rowselected/g,"")}}this.selectedRows=dhtmlxArray();this.row=null;if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,"");this.cell=null}this.callEvent("onSelectionCleared",[])};this.copyRowContent=function(from_row_id,to_row_id){var frRow=this.getRowById(from_row_id);if(!this.isTreeGrid()){for(var i=0;i<frRow.cells.length;i++){this.cells(to_row_id,i).setValue(this.cells(from_row_id,i).getValue())}}else{this._copyTreeGridRowContent(frRow,from_row_id,to_row_id)}if(!_isIE){this.getRowById(from_row_id).cells[0].height=frRow.cells[0].offsetHeight}};this.setFooterLabel=function(c,label,ind){return this.setColumnLabel(c,label,ind,this.ftr)};this.setColumnLabel=function(c,label,ind,hdr){var z=(hdr||this.hdr).rows[ind||1];var col=(z._childIndexes?z._childIndexes[c]:c);if(!z.cells[col]){return }if(!this.useImagesInHeader){var hdrHTML="<div class='hdrcell'>";if(label.indexOf("img:[")!=-1){var imUrl=label.replace(/.*\[([^>]+)\].*/,"$1");label=label.substr(label.indexOf("]")+1,label.length);hdrHTML+="<img width='18px' height='18px' align='absmiddle' src='"+imUrl+"' hspace='2'>"}hdrHTML+=label;hdrHTML+="</div>";z.cells[col].innerHTML=hdrHTML;if(this._hstyles[col]){z.cells[col].style.cssText=this._hstyles[col]}}else{z.cells[col].style.textAlign="left";z.cells[col].innerHTML="<img src='"+this.imgURL+""+label+"' onerror='this.src = \""+this.imgURL+"imageloaderror.gif\"'>";var a=new Image();a.src=this.imgURL+""+label.replace(/(\.[a-z]+)/,".des$1");this.preloadImagesAr[this.preloadImagesAr.length]=a;var b=new Image();b.src=this.imgURL+""+label.replace(/(\.[a-z]+)/,".asc$1");this.preloadImagesAr[this.preloadImagesAr.length]=b}if((label||"").indexOf("#")!=-1){var t=label.match(/(^|{)#([^}]+)(}|$)/);if(t){var tn="_in_header_"+t[2];if(this[tn]){this[tn]((this.forceDivInHeader?z.cells[col].firstChild:z.cells[col]),col,label.split(t[0]))}}}};this.setColLabel=function(a,b,ind,c){return this.setColumnLabel(a,b,(ind||0)+1,c)};this.clearAll=function(header){if(!this.obj.rows[0]){return }if(this._h2){this._h2=new dhtmlxHierarchy();if(this._fake){if(this._realfake){this._h2=this._fake._h2}else{this._fake._h2=this._h2}}}this.limit=this._limitC=0;this.editStop(true);if(this._dLoadTimer){window.clearTimeout(this._dLoadTimer)}if(this._dload){this.objBox.scrollTop=0;this.limit=this._limitC||0;this._initDrF=true}var len=this.rowsCol.length;len=this.obj.rows.length;for(var i=len-1;i>0;i--){var t_r=this.obj.rows[i];t_r.parentNode.removeChild(t_r)}if(header){this._master_row=null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(var i=this.hdr.rows.length-1;i>=0;i--){var t_r=this.hdr.rows[i];t_r.parentNode.removeChild(t_r)}if(this.ftr){this.ftr.parentNode.removeChild(this.ftr);this.ftr=null}this._aHead=this.ftr=this.cellWidth=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[]}this.row=null;this.cell=null;this.rowsCol=dhtmlxArray();this.rowsAr=[];this._RaSeCol=[];this.rowsBuffer=dhtmlxArray();this.UserData=[];this.selectedRows=dhtmlxArray();if(this.pagingOn||this._srnd){this.xmlFileUrl=""}if(this.pagingOn){this.changePage(1)}if(this._contextCallTimer){window.clearTimeout(this._contextCallTimer)}if(this._sst){this.enableStableSorting(true)}this._fillers=this.undefined;this.setSortImgState(false);this.setSizes();this.callEvent("onClearAll",[])};this.sortField=function(ind,repeatFl,r_el){if(this.getRowsNum()==0){return false}var el=this.hdr.rows[0].cells[ind];if(!el){return }if(el.tagName=="TH"&&(this.fldSort.length-1)>=el._cellIndex&&this.fldSort[el._cellIndex]!="na"){var data=this.getSortingState();var sortType=(data[0]==ind&&data[1]=="asc")?"des":"asc";if(!this.callEvent("onBeforeSorting",[ind,this.fldSort[ind],sortType])){return }this.sortImg.src=this.imgURL+"sort_"+(sortType=="asc"?"asc":"desc")+".gif";if(this.useImagesInHeader){var cel=this.hdr.rows[1].cells[el._cellIndex].firstChild;if(this.fldSorted!=null){var celT=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;celT.src=celT.src.replace(/(\.asc\.)|(\.des\.)/,".")}cel.src=cel.src.replace(/(\.[a-z]+)$/,"."+sortType+"$1")}this.sortRows(el._cellIndex,this.fldSort[el._cellIndex],sortType);this.fldSorted=el;this.r_fldSorted=r_el;var c=this.hdr.rows[1];var c=r_el.parentNode;var real_el=c._childIndexes?c._childIndexes[el._cellIndex]:el._cellIndex;this.setSortImgPos(false,false,false,r_el)}};this.setCustomSorting=function(func,col){if(!this._customSorts){this._customSorts=new Array()}this._customSorts[col]=(typeof (func)=="string")?eval(func):func;this.fldSort[col]="cus"};this.enableHeaderImages=function(fl){this.useImagesInHeader=fl};this.setHeader=function(hdrStr,splitSign,styles){if(typeof (hdrStr)!="object"){var arLab=this._eSplit(hdrStr)}else{arLab=[].concat(hdrStr)}var arWdth=new Array(0);var arTyp=new dhtmlxArray(0);var arAlg=new Array(0);var arVAlg=new Array(0);var arSrt=new Array(0);for(var i=0;i<arLab.length;i++){arWdth[arWdth.length]=Math.round(100/arLab.length);arTyp[arTyp.length]="ed";arAlg[arAlg.length]="left";arVAlg[arVAlg.length]="middle";arSrt[arSrt.length]="na"}this.splitSign=splitSign||"#cspan";this.hdrLabels=arLab;this.cellWidth=arWdth;if(!this.initCellWidth.length){this.setInitWidthsP(arWdth.join(this.delim),true)}this.cellType=arTyp;this.cellAlign=arAlg;this.cellVAlign=arVAlg;this.fldSort=arSrt;this._hstyles=styles||[]};this._eSplit=function(str){if(![].push){return str.split(this.delim)}var a="r"+(new Date()).valueOf();var z=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(str||"").replace(RegExp(z,"g"),a).replace(RegExp("\\\\"+a,"g"),this.delim).split(a)};this.getColType=function(cInd){return this.cellType[cInd]};this.getColTypeById=function(cID){return this.cellType[this.getColIndexById(cID)]};this.setColTypes=function(typeStr){this.cellType=dhtmlxArray(typeStr.split(this.delim));this._strangeParams=new Array();for(var i=0;i<this.cellType.length;i++){if((this.cellType[i].indexOf("[")!=-1)){var z=this.cellType[i].split(/[\[\]]+/g);this.cellType[i]=z[0];this.defVal[i]=z[1];if(z[1].indexOf("=")==0){this.cellType[i]="math";this._strangeParams[i]=z[0]}}if(!window["eXcell_"+this.cellType[i]]){dhtmlxError.throwError("Configuration","Incorrect cell type: "+this.cellType[i],[this,this.cellType[i]])}}};this.setColSorting=function(sortStr){this.fldSort=sortStr.split(this.delim);for(var i=0;i<this.fldSort.length;i++){if(((this.fldSort[i]).length>4)&&(typeof (window[this.fldSort[i]])=="function")){if(!this._customSorts){this._customSorts=new Array()}this._customSorts[i]=window[this.fldSort[i]];this.fldSort[i]="cus"}}};this.setColAlign=function(alStr){this.cellAlign=alStr.split(this.delim);for(var i=0;i<this.cellAlign.length;i++){this.cellAlign[i]=this.cellAlign[i]._dhx_trim()}};this.setColVAlign=function(valStr){this.cellVAlign=valStr.split(this.delim)};this.setNoHeader=function(fl){this.noHeader=convertStringToBoolean(fl)};this.showRow=function(rowID){this.getRowById(rowID);if(this._h2){this.openItem(this._h2.get[rowID].parent.id)}var c=this.getRowById(rowID).childNodes[0];while(c&&c.style.display=="none"){c=c.nextSibling}if(c){this.moveToVisible(c,true)}};this.setStyle=function(ss_header,ss_grid,ss_selCell,ss_selRow){this.ssModifier=[ss_header,ss_grid,ss_selCell,ss_selCell,ss_selRow];var prefs=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"];for(var i=0;i<prefs.length;i++){if(this.ssModifier[i]){if(_isIE){document.styleSheets[0].addRule(prefs[i],this.ssModifier[i])}else{document.styleSheets[0].insertRule(prefs[i]+(" { "+this.ssModifier[i]+" }"),document.styleSheets[0].cssRules.length)}}}};this.setColumnColor=function(clr){this.columnColor=clr.split(this.delim)};this.enableAlterCss=function(cssE,cssU,perLevel,levelUnique){if(cssE||cssU){this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();if(this._fake){this._fake._fixAlterCss()}})}this._cssSP=perLevel;this._cssSU=levelUnique;this._cssEven=cssE;this._cssUnEven=cssU};this._fixAlterCss=function(ind){if(this._h2&&(this._cssSP||this._cssSU)){return this._fixAlterCssTGR(ind)}if(!this._cssEven&&!this._cssUnEven){return }ind=ind||0;var j=ind;for(var i=ind;i<this.rowsCol.length;i++){if(!this.rowsCol[i]){continue}if(this.rowsCol[i].style.display!="none"){if(this.rowsCol[i]._cntr){j=1;continue}if(this.rowsCol[i].className.indexOf("rowselected")!=-1){if(j%2==1){this.rowsCol[i].className=this._cssUnEven+" rowselected "+(this.rowsCol[i]._css||"")}else{this.rowsCol[i].className=this._cssEven+" rowselected "+(this.rowsCol[i]._css||"")}}else{if(j%2==1){this.rowsCol[i].className=this._cssUnEven+" "+(this.rowsCol[i]._css||"")}else{this.rowsCol[i].className=this._cssEven+" "+(this.rowsCol[i]._css||"")}}j++}}};this.clearChangedState=function(){for(var i=0;i<this.rowsCol.length;i++){var row=this.rowsCol[i];var cols=row.childNodes.length;for(var j=0;j<cols;j++){row.childNodes[j].wasChanged=false}}};this.getChangedRows=function(and_added){var res=new Array();this.forEachRow(function(id){var row=this.rowsAr[id];if(row.tagName!="TR"){return }var cols=row.childNodes.length;if(and_added&&row._added){res[res.length]=row.idd}else{for(var j=0;j<cols;j++){if(row.childNodes[j].wasChanged){res[res.length]=row.idd;break}}}});return res.join(this.delim)};this._sUDa=false;this._sAll=false;this.setSerializationLevel=function(userData,fullXML,config,changedAttr,onlyChanged,asCDATA){this._sUDa=userData;this._sAll=fullXML;this._sConfig=config;this._chAttr=changedAttr;this._onlChAttr=onlyChanged;this._asCDATA=asCDATA};this.setSerializableColumns=function(list){if(!list){this._srClmn=null;return }this._srClmn=(list||"").split(",");for(var i=0;i<this._srClmn.length;i++){this._srClmn[i]=convertStringToBoolean(this._srClmn[i])}};this._serialise=function(rCol,inner,closed){this.editStop();var out=[];var close="</"+this.xml.s_row+">";if(this.isTreeGrid()){this._h2.forEachChildF(0,function(el){var temp=this._serializeRow(this.render_row_tree(-1,el.id));out.push(temp);if(temp){return true}else{return false}},this,function(){out.push(close)})}else{for(var i=0;i<this.rowsBuffer.length;i++){if(this.rowsBuffer[i]){var temp=this._serializeRow(this.render_row(i));out.push(temp);if(temp){out.push(close)}}}}return[out.join("")]};this._serializeRow=function(r,i){var out=[];var ra=this.xml.row_attrs;var ca=this.xml.cell_attrs;out.push("<"+this.xml.s_row);out.push(" id='"+r.idd+"'");if((this._sAll)&&this.selectedRows._dhx_find(r)!=-1){out.push(" selected='1'")}if(this._h2&&this._h2.get[r.idd].state=="minus"){out.push(" open='1'")}if(ra.length){for(var i=0;i<ra.length;i++){out.push(" "+ra[i]+"='"+r._attrs[ra[i]]+"'")}}out.push(">");if(this._sUDa&&this.UserData[r.idd]){keysAr=this.UserData[r.idd].getKeys();for(var ii=0;ii<keysAr.length;ii++){out.push("<userdata name='"+keysAr[ii]+"'>"+(this._asCDATA?"<![CDATA[":"")+this.UserData[r.idd].get(keysAr[ii])+(this._asCDATA?"]]>":"")+"</userdata>")}}var changeFl=false;for(var jj=0;jj<this._cCount;jj++){if((!this._srClmn)||(this._srClmn[jj])){var zx=this.cells3(r,jj);out.push("<cell");if(ca.length){for(var i=0;i<ca.length;i++){out.push(" "+ca[i]+"='"+zx.cell._attrs[ca[i]]+"'")}}zxVal=zx[this._agetm]();if(this._asCDATA){zxVal="<![CDATA["+zxVal+"]]>"}if((this._ecspn)&&(zx.cell.colSpan)&&zx.cell.colSpan>1){out.push(' colspan="'+zx.cell.colSpan+'" ')}if(this._chAttr){if(zx.wasChanged()){out.push(' changed="1"');changeFl=true}}else{if((this._onlChAttr)&&(zx.wasChanged())){changeFl=true}}if(this._sAll&&this.cellType[jj]=="tree"){out.push((this._h2?(" image='"+this._h2.get[r.idd].image+"'"):"")+">"+zxVal+"</cell>")}else{out.push(">"+zxVal+"</cell>")}if((this._ecspn)&&(zx.cell.colSpan)){for(var u=0;u<zx.cell.colSpan-1;u++){out.push("<cell/>");jj++}}}}if((this._onlChAttr)&&(!changeFl)&&(!r._added)){return""}return out.join("")};this._serialiseConfig=function(){var out="<head>";for(var i=0;i<this.hdr.rows[0].cells.length;i++){if(this._srClmn&&!this._srClmn[i]){continue}var sort=this.fldSort[i];if(sort=="cus"){sort=this._customSorts[i].toString();sort=sort.replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")}out+="<column width='"+this.getColWidth(i)+"' align='"+this.cellAlign[i]+"' type='"+this.cellType[i]+"' sort='"+(sort||"na")+"' color='"+this.columnColor[i]+"'"+(this.columnIds[i]?(" id='"+this.columnIds[i]+"'"):"")+">";if(this._asCDATA){out+="<![CDATA["+this.getHeaderCol(i)+"]]>"}else{out+=this.getHeaderCol(i)}var z=this.getCombo(i);if(z){for(var j=0;j<z.keys.length;j++){out+="<option value='"+z.keys[j]+"'>"+z.values[j]+"</option>"}}out+="</column>"}return out+="</head>"};this.serialize=function(){var out='<?xml version="1.0"?><rows>';if(this._mathSerialization){this._agetm="getMathValue"}else{this._agetm="getValue"}if(this._sUDa&&this.UserData.gridglobaluserdata){var keysAr=this.UserData.gridglobaluserdata.getKeys();for(var i=0;i<keysAr.length;i++){out+="<userdata name='"+keysAr[i]+"'>"+this.UserData.gridglobaluserdata.get(keysAr[i])+"</userdata>"}}if(this._sConfig){out+=this._serialiseConfig()}out+=this._serialise();out+="</rows>";return out};this.getPosition=function(oNode,pNode){if(!pNode&&!_isChrome){var pos=getOffset(oNode);return[pos.left,pos.top]}pNode=pNode||document.body;var oCurrentNode=oNode;var iLeft=0;var iTop=0;while((oCurrentNode)&&(oCurrentNode!=pNode)){iLeft+=oCurrentNode.offsetLeft-oCurrentNode.scrollLeft;iTop+=oCurrentNode.offsetTop-oCurrentNode.scrollTop;oCurrentNode=oCurrentNode.offsetParent}if(pNode==document.body){if(_isIE){iTop+=document.body.offsetTop||document.documentElement.offsetTop;iLeft+=document.body.offsetLeft||document.documentElement.offsetLeft}else{if(!_isFF){iLeft+=document.body.offsetLeft;iTop+=document.body.offsetTop}}}return[iLeft,iTop]};this.getFirstParentOfType=function(obj,tag){while(obj&&obj.tagName!=tag&&obj.tagName!="BODY"){obj=obj.parentNode}return obj};this.objBox.onscroll=function(){this.grid._doOnScroll()};if((!_isOpera)||(_OperaRv>8.5)){this.hdr.onmousemove=function(e){this.grid.changeCursorState(e||window.event)};this.hdr.onmousedown=function(e){return this.grid.startColResize(e||window.event)}}this.obj.onmousemove=this._drawTooltip;this.obj.onclick=function(e){this.grid._doClick(e||window.event);if(this.grid._sclE){this.grid.editCell(e||window.event)}(e||event).cancelBubble=true};if(_isMacOS){this.entBox.oncontextmenu=function(e){e.cancelBubble=true;e.returnValue=false;return this.grid._doContClick(e||window.event)}}else{this.entBox.onmousedown=function(e){return this.grid._doContClick(e||window.event)};this.entBox.oncontextmenu=function(e){if(this.grid._ctmndx){(e||event).cancelBubble=true}return !this.grid._ctmndx}}this.obj.ondblclick=function(e){if(!this.grid.wasDblClicked(e||window.event)){return false}if(this.grid._dclE){var row=this.grid.getFirstParentOfType((_isIE?event.srcElement:e.target),"TR");if(row==this.grid.row){this.grid.editCell(e||window.event)}}(e||event).cancelBubble=true;if(_isOpera){return false}};this.hdr.onclick=this._onHeaderClick;this.sortImg.onclick=function(){self._onHeaderClick.apply({grid:self},[null,self.r_fldSorted])};this.hdr.ondblclick=this._onHeaderDblClick;if(!document.body._dhtmlxgrid_onkeydown){dhtmlxEvent(document,_isOpera?"keypress":"keydown",function(e){if(globalActiveDHTMLGridObject){return globalActiveDHTMLGridObject.doKey(e||window.event)}});document.body._dhtmlxgrid_onkeydown=true}dhtmlxEvent(document.body,"click",function(){if(self.editStop){self.editStop();if(self.isActive){self.setActive(false)}}});this.entBox.onbeforeactivate=function(){this._still_active=null;this.grid.setActive();event.cancelBubble=true};this.entBox.onbeforedeactivate=function(){if(this.grid._still_active){this.grid._still_active=null}else{this.grid.isActive=false}event.cancelBubble=true};if(this.entBox.style.height.toString().indexOf("%")!=-1){this._delta_y=this.entBox.style.height}if(this.entBox.style.width.toString().indexOf("%")!=-1){this._delta_x=this.entBox.style.width}if(this._delta_x||this._delta_y){this._setAutoResize()}this.setColHidden=this.setColumnsVisibility;this.enableCollSpan=this.enableColSpan;this.setMultiselect=this.enableMultiselect;this.setMultiLine=this.enableMultiline;this.deleteSelectedItem=this.deleteSelectedRows;this.getSelectedId=this.getSelectedRowId;this.getHeaderCol=this.getColumnLabel;this.isItemExists=this.doesRowExist;this.getColumnCount=this.getColumnsNum;this.setSelectedRow=this.selectRowById;this.setHeaderCol=this.setColumnLabel;this.preventIECashing=this.preventIECaching;this.enableAutoHeigth=this.enableAutoHeight;this.getUID=this.uid;if(dhtmlx.image_path){this.setImagePath(dhtmlx.image_path)}if(dhtmlx.skin){this.setSkin(dhtmlx.skin)}return this}dhtmlXGridObject.prototype={getRowAttribute:function(C,A){return this.getRowById(C)._attrs[A]},setRowAttribute:function(D,A,C){this.getRowById(D)._attrs[A]=C},isTreeGrid:function(){return(this.cellType._dhx_find("tree")!=-1)},setRowHidden:function(H,D){var C=convertStringToBoolean(D);var F=this.getRowById(H);if(!F){return }if(F.expand===""){this.collapseKids(F)}if((D)&&(F.style.display!="none")){F.style.display="none";var E=this.selectedRows._dhx_find(F);if(E!=-1){F.className=F.className.replace("rowselected","");for(var A=0;A<F.childNodes.length;A++){F.childNodes[A].className=F.childNodes[A].className.replace(/cellselected/g,"")}this.selectedRows._dhx_removeAt(E)}this.callEvent("onGridReconstructed",[])}if((!D)&&(F.style.display=="none")){F.style.display="";this.callEvent("onGridReconstructed",[])}this.callEvent("onRowHide",[H,D]);this.setSizes()},setColumnHidden:function(D,C){if(!this.hdr.rows.length){if(!this._ivizcol){this._ivizcol=[]}return this._ivizcol[D]=C}if((this.fldSorted)&&(this.fldSorted.cellIndex==D)&&(C)){this.sortImg.style.display="none"}var A=convertStringToBoolean(C);if(A){if(!this._hrrar){this._hrrar=new Array()}else{if(this._hrrar[D]){return }}this._hrrar[D]="display:none;";this._hideShowColumn(D,"none")}else{if((!this._hrrar)||(!this._hrrar[D])){return }this._hrrar[D]="";this._hideShowColumn(D,"")}if((this.fldSorted)&&(this.fldSorted.cellIndex==D)&&(!C)){this.sortImg.style.display="inline"}this.setSortImgPos();this.callEvent("onColumnHidden",[D,C])},isColumnHidden:function(A){if((this._hrrar)&&(this._hrrar[A])){return true}return false},setColumnsVisibility:function(C){if(C){this._ivizcol=C.split(this.delim)}if(this.hdr.rows.length&&this._ivizcol){for(var A=0;A<this._ivizcol.length;A++){this.setColumnHidden(A,this._ivizcol[A])}}},_fixHiddenRowsAll:function(J,D,A,C,H){H=H||"_cellIndex";var I=J.rows.length;for(var F=0;F<I;F++){var K=J.rows[F].childNodes;if(K.length!=this._cCount){for(var E=0;E<K.length;E++){if(K[E][H]==D){K[E].style[A]=C;break}}}else{K[D].style[A]=C}}},_hideShowColumn:function(F,E){var A=F;if((this.hdr.rows[1]._childIndexes)&&(this.hdr.rows[1]._childIndexes[F]!=F)){A=this.hdr.rows[1]._childIndexes[F]}if(E=="none"){this.hdr.rows[0].cells[F]._oldWidth=this.hdr.rows[0].cells[F].style.width||(this.initCellWidth[F]+"px");this.hdr.rows[0].cells[F]._oldWidthP=this.cellWidthPC[F];this.obj.rows[0].cells[F].style.width="0px";var C={rows:[this.obj.rows[0]]};this.forEachRow(function(H){if(this.rowsAr[H].tagName=="TR"){C.rows.push(this.rowsAr[H])}});this._fixHiddenRowsAll(C,F,"display","none");if(this.isTreeGrid()){this._fixHiddenRowsAllTG(F,"none")}if((_isOpera&&_OperaRv<9)||_isKHTML||(_isFF)){this._fixHiddenRowsAll(this.hdr,F,"display","none","_cellIndexS")}if(this.ftr){this._fixHiddenRowsAll(this.ftr.childNodes[0],F,"display","none")}this._fixHiddenRowsAll(this.hdr,F,"whiteSpace","nowrap","_cellIndexS");if(!this.cellWidthPX.length&&!this.cellWidthPC.length){this.cellWidthPX=[].concat(this.initCellWidth)}if(this.cellWidthPX[F]){this.cellWidthPX[F]=0}if(this.cellWidthPC[F]){this.cellWidthPC[F]=0}}else{if(this.hdr.rows[0].cells[F]._oldWidth){var D=this.hdr.rows[0].cells[F];if(_isOpera||_isKHTML||(_isFF)){this._fixHiddenRowsAll(this.hdr,F,"display","","_cellIndexS")}if(this.ftr){this._fixHiddenRowsAll(this.ftr.childNodes[0],F,"display","")}var C={rows:[this.obj.rows[0]]};this.forEachRow(function(H){if(this.rowsAr[H].tagName=="TR"){C.rows.push(this.rowsAr[H])}});this._fixHiddenRowsAll(C,F,"display","");if(this.isTreeGrid()){this._fixHiddenRowsAllTG(F,"")}this._fixHiddenRowsAll(this.hdr,F,"whiteSpace","normal","_cellIndexS");if(D._oldWidthP){this.cellWidthPC[F]=D._oldWidthP}if(D._oldWidth){this.cellWidthPX[F]=parseInt(D._oldWidth)}}}this.setSizes();if((!_isIE)&&(!_isFF)){this.obj.border=1;this.obj.border=0}},enableColSpan:function(A){this._ecspn=convertStringToBoolean(A)},enableRowsHover:function(C,A){this._unsetRowHover(false,true);this._hvrCss=A;if(convertStringToBoolean(C)){if(!this._elmnh){this.obj._honmousemove=this.obj.onmousemove;this.obj.onmousemove=this._setRowHover;if(_isIE){this.obj.onmouseleave=this._unsetRowHover}else{this.obj.onmouseout=this._unsetRowHover}this._elmnh=true}}else{if(this._elmnh){this.obj.onmousemove=this.obj._honmousemove;if(_isIE){this.obj.onmouseleave=null}else{this.obj.onmouseout=null}this._elmnh=false}}},enableEditEvents:function(C,D,A){this._sclE=convertStringToBoolean(C);this._dclE=convertStringToBoolean(D);this._f2kE=convertStringToBoolean(A)},enableLightMouseNavigation:function(A){if(convertStringToBoolean(A)){if(!this._elmn){this.entBox._onclick=this.entBox.onclick;this.entBox.onclick=function(){return true};this.obj._onclick=this.obj.onclick;this.obj.onclick=function(C){var D=this.grid.getFirstParentOfType(C?C.target:event.srcElement,"TD");if(!D){return }this.grid.editStop();this.grid.doClick(D);this.grid.editCell();(C||event).cancelBubble=true};this.obj._onmousemove=this.obj.onmousemove;this.obj.onmousemove=this._autoMoveSelect;this._elmn=true}}else{if(this._elmn){this.entBox.onclick=this.entBox._onclick;this.obj.onclick=this.obj._onclick;this.obj.onmousemove=this.obj._onmousemove;this._elmn=false}}},_unsetRowHover:function(C,D){if(D){that=this}else{that=this.grid}if((that._lahRw)&&(that._lahRw!=D)){for(var A=0;A<that._lahRw.childNodes.length;A++){that._lahRw.childNodes[A].className=that._lahRw.childNodes[A].className.replace(that._hvrCss,"")}that._lahRw=null}},_setRowHover:function(C){var D=this.grid.getFirstParentOfType(C?C.target:event.srcElement,"TD");if(D&&D.parentNode!=this.grid._lahRw){this.grid._unsetRowHover(0,D);D=D.parentNode;if(!D.idd||D.idd=="__filler__"){return }for(var A=0;A<D.childNodes.length;A++){D.childNodes[A].className+=" "+this.grid._hvrCss}this.grid._lahRw=D}this._honmousemove(C)},_autoMoveSelect:function(A){if(!this.grid.editor){var C=this.grid.getFirstParentOfType(A?A.target:event.srcElement,"TD");if(C.parentNode.idd){this.grid.doClick(C,true,0)}}this._onmousemove(A)},enableDistributedParsing:function(D,A,C){if(convertStringToBoolean(D)){this._ads_count=A||10;this._ads_time=C||250}else{this._ads_count=0}},destructor:function(){this.editStop(true);if(this._sizeTime){this._sizeTime=window.clearTimeout(this._sizeTime)}this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,"");if(this.formInputs){for(var C=0;C<this.formInputs.length;C++){this.parentForm.removeChild(this.formInputs[C])}}var A;this.xmlLoader=this.xmlLoader.destructor();for(var C=0;C<this.rowsCol.length;C++){if(this.rowsCol[C]){this.rowsCol[C].grid=null}}for(C in this.rowsAr){if(this.rowsAr[C]){this.rowsAr[C]=null}}this.rowsCol=new dhtmlxArray();this.rowsAr=new Array();this.entBox.innerHTML="";var D=function(){};this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=D;this.setSizes=this._update_srnd_view=this.callEvent=D;this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null;for(A in this){if((this[A])&&(this[A].m_obj)){this[A].m_obj=null}this[A]=null}if(this==globalActiveDHTMLGridObject){globalActiveDHTMLGridObject=null}return null},getSortingState:function(){var A=new Array();if(this.fldSorted){A[0]=this.fldSorted._cellIndex;A[1]=(this.sortImg.src.indexOf("sort_desc.gif")!=-1)?"des":"asc"}return A},enableAutoHeight:function(D,C,A){this._ahgr=convertStringToBoolean(D);this._ahgrF=convertStringToBoolean(A);this._ahgrM=C||null;if(arguments.length==1){this.objBox.style.overflowY=D?"hidden":"auto"}if(C=="auto"){this._ahgrM=null;this._ahgrMA=true;this._setAutoResize()}},enableStableSorting:function(A){this._sst=convertStringToBoolean(A);this.rowsCol.stablesort=function(H){var F=this.length-1;for(var E=0;E<this.length-1;E++){for(var D=0;D<F;D++){if(H(this[D],this[D+1])>0){var C=this[D];this[D]=this[D+1];this[D+1]=C}}F--}}},enableKeyboardSupport:function(A){this._htkebl=!convertStringToBoolean(A)},enableContextMenu:function(A){this._ctmndx=A},setScrollbarWidthCorrection:function(A){},enableTooltips:function(C){this._enbTts=C.split(",");for(var A=0;A<this._enbTts.length;A++){this._enbTts[A]=convertStringToBoolean(this._enbTts[A])}},enableResizing:function(C){this._drsclmn=C.split(",");for(var A=0;A<this._drsclmn.length;A++){this._drsclmn[A]=convertStringToBoolean(this._drsclmn[A])}},setColumnMinWidth:function(A,C){if(arguments.length==2){if(!this._drsclmW){this._drsclmW=new Array()}this._drsclmW[C]=A}else{this._drsclmW=A.split(",")}},enableCellIds:function(A){this._enbCid=convertStringToBoolean(A)},lockRow:function(A,D){var C=this.getRowById(A);if(C){C._locked=convertStringToBoolean(D);if((this.cell)&&(this.cell.parentNode.idd==A)){this.editStop()}}},_getRowArray:function(E){var D=new Array();for(var C=0;C<E.childNodes.length;C++){var A=this.cells3(E,C);D[C]=A.getValue()}return D},setDateFormat:function(C,A){this._dtmask=C;this._dtmask_inc=A},setNumberFormat:function(J,D,F,I){var E=J.replace(/[^0\,\.]*/g,"");var A=E.indexOf(".");if(A>-1){A=E.length-A-1}var C=E.indexOf(",");if(C>-1){C=E.length-A-2-C}if(typeof F!="string"){F=this.i18n.decimal_separator}if(typeof I!="string"){I=this.i18n.group_separator}var K=J.split(E)[0];var H=J.split(E)[1];this._maskArr[D]=[A,C,K,H,F,I]},_aplNFb:function(E,D){var A=this._maskArr[D];if(!A){return E}var C=parseFloat(E.toString().replace(/[^0-9]*/g,""));if(E.toString().substr(0,1)=="-"){C=C*-1}if(A[0]>0){C=C/Math.pow(10,A[0])}return C},_aplNF:function(E,D){var A=this._maskArr[D];if(!A){return E}var F=(parseFloat(E)<0?"-":"")+A[2];E=Math.abs(Math.round(parseFloat(E)*Math.pow(10,A[0]>0?A[0]:0))).toString();E=(E.length<A[0]?Math.pow(10,A[0]+1-E.length).toString().substr(1,A[0]+1)+E.toString():E).split("").reverse();E[A[0]]=(E[A[0]]||"0")+A[4];if(A[1]>0){for(var C=(A[0]>0?0:1)+A[0]+A[1];C<E.length;C+=A[1]){E[C]+=A[5]}}return F+E.reverse().join("")+A[3]},_launchCommands:function(A){for(var E=0;E<A.length;E++){var D=new Array();for(var C=0;C<A[E].childNodes.length;C++){if(A[E].childNodes[C].nodeType==1){D[D.length]=A[E].childNodes[C].firstChild.data}}this[A[E].getAttribute("command")].apply(this,D)}},_parseHead:function(S){var I=this.xmlLoader.doXPath("./head",S);if(I.length){var C=this.xmlLoader.doXPath("./column",I[0]);var K=this.xmlLoader.doXPath("./settings",I[0]);var L="setInitWidths";var O=false;if(K[0]){for(var T=0;T<K[0].childNodes.length;T++){switch(K[0].childNodes[T].tagName){case"colwidth":if(K[0].childNodes[T].firstChild&&K[0].childNodes[T].firstChild.data=="%"){L="setInitWidthsP"}break;case"splitat":O=(K[0].childNodes[T].firstChild?K[0].childNodes[T].firstChild.data:false);break}}}this._launchCommands(this.xmlLoader.doXPath("./beforeInit/call",I[0]));if(C.length>0){if(this.hdr.rows.length>0){this.clearAll(true)}var N=[[],[],[],[],[],[],[],[],[]];var P=["","width","type","align","sort","color","format","hidden","id"];var Q=["",L,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"];for(var J=0;J<C.length;J++){for(var H=1;H<P.length;H++){N[H].push(C[J].getAttribute(P[H]))}N[0].push((C[J].firstChild?C[J].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(N[0]);for(var J=0;J<Q.length;J++){if(Q[J]){this[Q[J]](N[J].join(this.delim))}}for(var J=0;J<C.length;J++){if((this.cellType[J].indexOf("co")==0)||(this.cellType[J]=="clist")){var F=this.xmlLoader.doXPath("./option",C[J]);if(F.length){var A=new Array();if(this.cellType[J]=="clist"){for(var H=0;H<F.length;H++){A[A.length]=F[H].firstChild?F[H].firstChild.data:""}this.registerCList(J,A)}else{var D=this.getCombo(J);for(var H=0;H<F.length;H++){D.put(F[H].getAttribute("value"),F[H].firstChild?F[H].firstChild.data:"")}}}}else{if(N[6][J]){if((this.cellType[J].toLowerCase().indexOf("calendar")!=-1)||(this.fldSort[J]=="date")){this.setDateFormat(N[6][J])}else{this.setNumberFormat(N[6][J],J)}}}}this.init();var E=N[7].join(this.delim);if(this.setColHidden&&E.replace(/,/g,"")!=""){this.setColHidden(E)}if((O)&&(this.splitAt)){this.splitAt(O)}}this._launchCommands(this.xmlLoader.doXPath("./afterInit/call",I[0]))}var M=this.xmlLoader.doXPath("//rows/userdata",S);if(M.length>0){if(!this.UserData.gridglobaluserdata){this.UserData.gridglobaluserdata=new Hashtable()}for(var H=0;H<M.length;H++){this.UserData.gridglobaluserdata.put(M[H].getAttribute("name"),M[H].firstChild?M[H].firstChild.data:"")}}},getCheckedRows:function(A){var C=new Array();this.forEachRowA(function(D){if(this.cells(D,A).getValue()!=0){C.push(D)}},true);return C.join(",")},checkAll:function(){var C=arguments.length?arguments[0]:1;for(var A=0;A<this.getColumnsNum();A++){if(this.getColType(A)=="ch"){this.setCheckedRows(A,C)}}},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(C,A){this.forEachRowA(function(D){if(this.cells(D,C).isCheckbox()){this.cells(D,C).setValue(A)}})},_drawTooltip:function(E){var F=this.grid.getFirstParentOfType(E?E.target:event.srcElement,"TD");if(!F||((this.grid.editor)&&(this.grid.editor.cell==F))){return true}var D=F.parentNode;if(!D.idd||D.idd=="__filler__"){return }var C=(E?E.target:event.srcElement);if(D.idd==window.unknown){return true}if(!this.grid.callEvent("onMouseOver",[D.idd,F._cellIndex,(E||window.event)])){return true}if((this.grid._enbTts)&&(!this.grid._enbTts[F._cellIndex])){if(C.title){C.title=""}return true}if(F._cellIndex>=this.grid._cCount){return }var A=this.grid.cells3(D,F._cellIndex);if(!A||!A.cell||!A.cell._attrs){return }if(C._title){A.cell.title=""}if(!A.cell._attrs.title){C._title=true}if(A){C.title=A.cell._attrs.title||(A.getTitle?A.getTitle():(A.getValue()||"").toString().replace(/<[^>]*>/gi,""))}return true},enableCellWidthCorrection:function(A){if(_isFF){this._wcorr=parseInt(A)}},getAllRowIds:function(D){var A=[];for(var C=0;C<this.rowsBuffer.length;C++){if(this.rowsBuffer[C]){A.push(this.rowsBuffer[C].idd)}}return A.join(D||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},setColspan:function(C,M,D){if(!this._ecspn){return }var A=this.getRowById(C);if((A._childIndexes)&&(A.childNodes[A._childIndexes[M]])){var H=A._childIndexes[M];var E=A.childNodes[H];var F=E.colSpan;E.colSpan=1;if((F)&&(F!=1)){for(var J=1;J<F;J++){var L=document.createElement("TD");if(E.nextSibling){A.insertBefore(L,E.nextSibling)}else{A.appendChild(L)}A._childIndexes[M+J]=H+J;L._cellIndex=M+J;L.style.textAlign=this.cellAlign[J];L.style.verticalAlign=this.cellVAlign[J];E=L;this.cells3(A,M+J).setValue("")}}for(var K=M*1+1*F;K<A._childIndexes.length;K++){A._childIndexes[K]+=(F-1)*1}}if((D)&&(D>1)){if(A._childIndexes){var H=A._childIndexes[M]}else{var H=M;A._childIndexes=new Array();for(var K=0;K<A.childNodes.length;K++){A._childIndexes[K]=K}}A.childNodes[H].colSpan=D;for(var K=1;K<D;K++){A._childIndexes[A.childNodes[H+1]._cellIndex]=H;A.removeChild(A.childNodes[H+1])}var I=A.childNodes[A._childIndexes[M]]._cellIndex;for(var K=I*1+1*D;K<A._childIndexes.length;K++){A._childIndexes[K]-=(D-1)}}},preventIECaching:function(A){this.no_cashe=convertStringToBoolean(A);this.xmlLoader.rSeed=this.no_cashe},enableColumnAutoSize:function(A){this._eCAS=convertStringToBoolean(A)},_onHeaderDblClick:function(D){var C=this.grid;var A=C.getFirstParentOfType(_isIE?event.srcElement:D.target,"TD");if(!C._eCAS){return false}C.adjustColumnSize(A._cellIndexS)},adjustColumnSize:function(F,I){if(this._hrrar&&this._hrrar[F]){return }this._notresize=true;var A=0;this._setColumnSizeR(F,20);for(var E=1;E<this.hdr.rows.length;E++){var D=this.hdr.rows[E];D=D.childNodes[(D._childIndexes)?D._childIndexes[F]:F];if((D)&&((!D.colSpan)||(D.colSpan<2))&&D._cellIndex==F){if((D.childNodes[0])&&(D.childNodes[0].className=="hdrcell")){D=D.childNodes[0]}A=Math.max(A,((_isFF||_isOpera)?(D.textContent.length*7):D.scrollWidth))}}var C=this.obj.rows.length;for(var H=1;H<C;H++){var J=this.obj.rows[H];if(!this.rowsAr[J.idd]){continue}if(J._childIndexes&&J._childIndexes[F]!=F||!J.childNodes[F]){continue}if(_isFF||_isOpera||I){J=J.childNodes[F].textContent.length*7}else{J=J.childNodes[F].scrollWidth}if(J>A){A=J}}A+=20+(I||0);this._setColumnSizeR(F,A);this._notresize=false;this.setSizes()},detachHeader:function(A,D){D=D||this.hdr;var C=D.rows[A+1];if(C){C.parentNode.removeChild(C)}this.setSizes()},detachFooter:function(A){this.detachHeader(A,this.ftr)},attachHeader:function(A,E,C){if(typeof (A)=="string"){A=this._eSplit(A)}if(typeof (E)=="string"){E=E.split(this.delim)}C=C||"_aHead";if(this.hdr.rows.length){if(A){this._createHRow([A,E],this[(C=="_aHead")?"hdr":"ftr"])}else{if(this[C]){for(var D=0;D<this[C].length;D++){this.attachHeader.apply(this,this[C][D])}}}}else{if(!this[C]){this[C]=new Array()}this[C][this[C].length]=[A,E,C]}},_createHRow:function(D,L){if(!L){if(this.entBox.style.position!="absolute"){this.entBox.style.position="relative"}var I=document.createElement("DIV");I.className="c_ftr".substr(2);this.entBox.appendChild(I);var O=document.createElement("TABLE");O.cellPadding=O.cellSpacing=0;if(!_isIE){O.width="100%";O.style.paddingRight="20px"}O.style.marginRight="20px";O.style.tableLayout="fixed";I.appendChild(O);O.appendChild(document.createElement("TBODY"));this.ftr=L=O;var H=O.insertRow(0);var A=((this.hdrLabels.length<=1)?D[0].length:this.hdrLabels.length);for(var E=0;E<A;E++){H.appendChild(document.createElement("TH"));H.childNodes[E]._cellIndex=E}if(_isIE&&_isIE<8){H.style.position="absolute"}else{H.style.height="auto"}}var F=D[1];var I=document.createElement("TR");L.rows[0].parentNode.appendChild(I);for(var E=0;E<D[0].length;E++){if(D[0][E]=="#cspan"){var J=I.cells[I.cells.length-1];J.colSpan=(J.colSpan||1)+1;continue}if((D[0][E]=="#rspan")&&(L.rows.length>1)){var Q=L.rows.length-2;var P=false;var J=null;while(!P){var J=L.rows[Q];for(var C=0;C<J.cells.length;C++){if(J.cells[C]._cellIndex==E){P=C+1;break}}Q--}J=J.cells[P-1];J.rowSpan=(J.rowSpan||1)+1;continue}var K=document.createElement("TD");K._cellIndex=K._cellIndexS=E;if(this._hrrar&&this._hrrar[E]&&!_isIE){K.style.display="none"}if(typeof D[0][E]=="object"){K.appendChild(D[0][E])}else{if(this.forceDivInHeader){K.innerHTML="<div class='hdrcell'>"+(D[0][E]||"&nbsp;")+"</div>"}else{K.innerHTML=(D[0][E]||"&nbsp;")}if((D[0][E]||"").indexOf("#")!=-1){var O=D[0][E].match(/(^|{)#([^}]+)(}|$)/);if(O){var M="_in_header_"+O[2];if(this[M]){this[M]((this.forceDivInHeader?K.firstChild:K),E,D[0][E].split(O[0]))}}}}if(F){K.style.cssText=F[E]}I.appendChild(K)}var N=L;if(_isKHTML){if(L._kTimer){window.clearTimeout(L._kTimer)}L._kTimer=window.setTimeout(function(){L.rows[1].style.display="none";window.setTimeout(function(){L.rows[1].style.display=""},1)},500)}},attachFooter:function(A,C){this.attachHeader(A,C,"_aFoot")},setCellExcellType:function(D,A,C){this.changeCellType(this.getRowById(D),A,C)},changeCellType:function(D,E,C){C=C||this.cellType[E];var F=this.cells3(D,E);var A=F.getValue();F.cell._cellType=C;var F=this.cells3(D,E);F.setValue(A)},setRowExcellType:function(D,C){var E=this.rowsAr[D];for(var A=0;A<E.childNodes.length;A++){this.changeCellType(E,A,C)}},setColumnExcellType:function(A,D){for(var C=0;C<this.rowsBuffer.length;C++){if(this.rowsBuffer[C]&&this.rowsBuffer[C].tagName=="TR"){this.changeCellType(this.rowsBuffer[C],A,D)}}if(this.cellType[A]=="math"){this._strangeParams[C]=D}else{this.cellType[A]=D}},forEachRow:function(C){for(var A in this.rowsAr){if(this.rowsAr[A]&&this.rowsAr[A].idd){C.apply(this,[this.rowsAr[A].idd])}}},forEachRowA:function(C){for(var A=0;A<this.rowsBuffer.length;A++){if(this.rowsBuffer[A]){C.call(this,this.render_row(A).idd)}}},forEachCell:function(D,C){var E=this.getRowById(D);if(!E){return }for(var A=0;A<this._cCount;A++){C(this.cells3(E,A),A)}},enableAutoWidth:function(D,A,C){this._awdth=[convertStringToBoolean(D),parseInt(A||99999),parseInt(C||0)];if(arguments.length==1){this.objBox.style.overflowX=D?"hidden":"auto"}},updateFromXML:function(A,E,C,D){if(typeof E=="undefined"){E=true}this._refresh_mode=[true,E,C];this.load(A,D)},_refreshFromXML:function(D){if(this._f_rowsBuffer){this.filterBy(0,"")}reset=false;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue;eXcell_tree.prototype.setValue=function(M){var L=this.grid._h2.get[this.cell.parentNode.idd];if(L&&this.cell.parentNode.valTag){this.setLabel(M)}else{this.setValueX(M)}}}var K=this.cellType._dhx_find("tree");D.getXMLTopNode("rows");var E=D.doXPath("//rows")[0].getAttribute("parent")||0;var H={};if(this._refresh_mode[2]){if(K!=-1){this._h2.forEachChild(E,function(L){H[L.id]=true},this)}else{this.forEachRow(function(L){H[L]=true})}}var J=D.doXPath("//row");for(var C=0;C<J.length;C++){var I=J[C];var A=I.getAttribute("id");H[A]=false;var E=I.parentNode.getAttribute("id")||E;if(this.rowsAr[A]&&this.rowsAr[A].tagName!="TR"){if(this._h2){this._h2.get[A].buff.data=I}else{this.rowsBuffer[this.getRowIndex(A)].data=I}this.rowsAr[A]=I}else{if(this.rowsAr[A]){this._process_xml_row(this.rowsAr[A],I,-1);this._postRowProcessing(this.rowsAr[A],true)}else{if(this._refresh_mode[1]){var F={idd:A,data:I,_parser:this._process_xml_row,_locator:this._get_xml_data};if(this._refresh_mode[1]=="top"){this.rowsBuffer.unshift(F)}else{this.rowsBuffer.push(F)}if(this._h2){reset=true;(this._h2.add(A,(I.parentNode.getAttribute("id")||I.parentNode.getAttribute("parent")))).buff=this.rowsBuffer[this.rowsBuffer.length-1]}this.rowsAr[A]=I;I=this.render_row(this.rowsBuffer.length-1);this._insertRowAt(I,-1)}}}}if(this._refresh_mode[2]){for(A in H){if(H[A]&&this.rowsAr[A]){this.deleteRow(A)}}}this._refresh_mode=null;if(window.eXcell_tree){eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX}if(reset){this._renderSort()}if(this._f_rowsBuffer){this._f_rowsBuffer=null;this.filterByAll()}},getCustomCombo:function(D,C){var A=this.cells(D,C).cell;if(!A._combo){A._combo=new dhtmlXGridComboObject()}return A._combo},setTabOrder:function(C){var E=C.split(this.delim);this._tabOrder=[];var A=this._cCount||C.length;for(var D=0;D<A;D++){E[D]={c:parseInt(E[D]),ind:D}}E.sort(function(H,F){return(H.c>F.c?1:-1)});for(var D=0;D<A;D++){if(!E[D+1]||(typeof E[D].c=="undefined")){this._tabOrder[E[D].ind]=(E[0].ind+1)*-1}else{this._tabOrder[E[D].ind]=E[D+1].ind}}},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var A=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[A+1],this.cell._cellIndex,true)},k13_0_1:function(){var A=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[A-1],this.cell._cellIndex,true)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[(this.row?this.row.idd:null),(this.cell?this.cell._cellIndex:null)]);this._still_active=true},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[true])){return true}var A=this._getNextCell(null,1);if(A){this.selectCell(A.parentNode,A._cellIndex,(this.row!=A.parentNode),false,true);this._still_active=true}},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[false])){return false}var A=this._getNextCell(null,-1);if(A){this.selectCell(A.parentNode,A._cellIndex,(this.row!=A.parentNode),false,true);this._still_active=true}},k113_0_0:function(){if(this._f2kE){this.editCell()}},k32_0_0:function(){var A=this.cells4(this.cell);if(!A.changeState||(A.changeState()===false)){return false}},k27_0_0:function(){this.editStop(true)},k33_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage-1)}else{this.scrollPage(-1)}},k34_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage+1)}else{this.scrollPage(1)}},k37_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.collapseKids(this.row)}else{return false}},k39_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.expandKids(this.row)}else{return false}},k40_0_0:function(){var C=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftNext()}else{if(!this.row.idd){return }var A=Math.max((C._r_select||0),this.getRowIndex(this.row.idd))+1;if(this.rowsBuffer[A]){C._r_select=null;this.selectCell(A,this.cell._cellIndex,true);if(C.pagingOn){C.showRow(C.getRowId(A))}}else{if(!this.callEvent("onLastRow",[])){return false}this._key_events.k34_0_0.apply(this,[]);if(this.pagingOn&&this.rowsCol[A]){this.selectCell(A,0,true)}}}this._still_active=true},k38_0_0:function(){var C=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftPrev()}else{if(!this.row.idd){return }var A=this.getRowIndex(this.row.idd)+1;if(A!=-1&&(!this.pagingOn||(A!=1))){var D=this._nextRow(A-1,-1);this.selectCell(D,this.cell._cellIndex,true);if(C.pagingOn&&D){C.showRow(D.idd)}}else{this._key_events.k33_0_0.apply(this,[])}}this._still_active=true}},_build_master_row:function(){var D=document.createElement("DIV");var C=["<table><tr>"];for(var A=0;A<this._cCount;A++){C.push("<td></td>")}C.push("</tr></table>");D.innerHTML=C.join("");this._master_row=D.firstChild.rows[0]},_prepareRow:function(A){if(!this._master_row){this._build_master_row()}var D=this._master_row.cloneNode(true);for(var C=0;C<D.childNodes.length;C++){D.childNodes[C]._cellIndex=C;if(this._enbCid){D.childNodes[C].id="c_"+A+"_"+C}if(this.dragAndDropOff){this.dragger.addDraggableItem(D.childNodes[C],this)}}D.idd=A;D.grid=this;return D},_process_jsarray_row:function(C,D){C._attrs={};for(var A=0;A<C.childNodes.length;A++){C.childNodes[A]._attrs={}}this._fillRow(C,(this._c_order?this._swapColumns(D):D));return C},_get_jsarray_data:function(C,A){return C[A]},_process_json_row:function(C,D){C._attrs={};for(var A=0;A<C.childNodes.length;A++){C.childNodes[A]._attrs={}}this._fillRow(C,(this._c_order?this._swapColumns(D.data):D.data));return C},_get_json_data:function(C,A){return C.data[A]},_process_csv_row:function(C,D){C._attrs={};for(var A=0;A<C.childNodes.length;A++){C.childNodes[A]._attrs={}}this._fillRow(C,(this._c_order?this._swapColumns(D.split(this.csv.cell)):D.split(this.csv.cell)));return C},_get_csv_data:function(C,A){return C.split(this.csv.cell)[A]},_process_xml_row:function(A,H){var L=this.xmlLoader.doXPath(this.xml.cell,H);var J=[];A._attrs=this._xml_attrs(H);if(this._ud_enabled){var K=this.xmlLoader.doXPath("./userdata",H);for(var E=K.length-1;E>=0;E--){this.setUserData(A.idd,K[E].getAttribute("name"),K[E].firstChild?K[E].firstChild.data:"")}}for(var D=0;D<L.length;D++){var F=L[this._c_order?this._c_order[D]:D];if(!F){continue}var C=A._childIndexes?A._childIndexes[D]:D;var I=F.getAttribute("type");if(A.childNodes[C]){if(I){A.childNodes[C]._cellType=I}A.childNodes[C]._attrs=this._xml_attrs(F)}if(!F.getAttribute("xmlcontent")){if(F.firstChild){F=F.firstChild.data}else{F=""}}J.push(F)}for(D<L.length;D<A.childNodes.length;D++){A.childNodes[D]._attrs={}}if(A.parentNode&&A.parentNode.tagName=="row"){A._attrs.parent=A.parentNode.getAttribute("idd")}this._fillRow(A,J);return A},_get_xml_data:function(C,A){C=C.firstChild;while(true){if(!C){return""}if(C.tagName=="cell"){A--}if(A<0){break}C=C.nextSibling}return(C.firstChild?C.firstChild.data:"")},_fillRow:function(E,H){if(this.editor){this.editStop()}for(var C=0;C<E.childNodes.length;C++){if((C<H.length)||(this.defVal[C])){var D=E.childNodes[C]._cellIndex;var F=H[D];var A=this.cells4(E.childNodes[C]);if((this.defVal[D])&&((F=="")||(typeof (F)=="undefined"))){F=this.defVal[D]}if(A){A.setValue(F)}}else{E.childNodes[C].innerHTML="&nbsp;";E.childNodes[C]._clearCell=true}}return E},_postRowProcessing:function(F,I){if(F._attrs["class"]){F._css=F.className=F._attrs["class"]}if(F._attrs.locked){F._locked=true}if(F._attrs.bgColor){F.bgColor=F._attrs.bgColor}var H=0;for(var C=0;C<F.childNodes.length;C++){var J=F.childNodes[C];var E=J._cellIndex;var D=J._attrs.style||F._attrs.style;if(D){J.style.cssText+=";"+D}if(J._attrs["class"]){J.className=J._attrs["class"]}D=J._attrs.align||this.cellAlign[E];if(D){J.align=D}J.vAlign=J._attrs.valign||this.cellVAlign[E];var A=J._attrs.bgColor||this.columnColor[E];if(A){J.bgColor=A}if(J._attrs.colspan&&!I){this.setColspan(F.idd,C+H,J._attrs.colspan);H+=(J._attrs.colspan-1)}if(this._hrrar&&this._hrrar[E]&&!I){J.style.display="none"}}this.callEvent("onRowCreated",[F.idd,F,null])},load:function(A,D,C){this.callEvent("onXLS",[this]);if(arguments.length==2&&typeof D!="function"){C=D;D=null}C=C||"xml";if(!this.xmlFileUrl){this.xmlFileUrl=A}this._data_type=C;this.xmlLoader.onloadAction=function(H,E,J,I,F){if(!H.callEvent){return }F=H["_process_"+C](F);if(!H._contextCallTimer){H.callEvent("onXLE",[H,0,0,F])}if(D){D();D=null}};this.xmlLoader.loadXML(A)},loadXMLString:function(D,C){var A=new dtmlXMLLoaderObject(function(){});A.loadXMLString(D);this.parse(A,C,"xml")},loadXML:function(A,C){this.load(A,C,"xml")},parse:function(D,C,A){if(arguments.length==2&&typeof C!="function"){A=C;C=null}A=A||"xml";this._data_type=A;D=this["_process_"+A](D);if(!this._contextCallTimer){this.callEvent("onXLE",[this,0,0,D])}if(C){C()}},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(C){var D={};if(C.attributes.length){for(var A=0;A<C.attributes.length;A++){D[C.attributes[A].name]=C.attributes[A].value}}return D},_process_xml:function(A){if(!A.doXPath){var D=new dtmlXMLLoaderObject(function(){});if(typeof A=="string"){D.loadXMLString(A)}else{if(A.responseXML){D.xmlDoc=A}else{D.xmlDoc={}}D.xmlDoc.responseXML=A}A=D}if(this._refresh_mode){return this._refreshFromXML(A)}this._parsing=true;var I=A.getXMLTopNode(this.xml.top);if(I.tagName.toLowerCase()!=this.xml.top){return }this._parseHead(I);var H=A.doXPath(this.xml.row,I);var F=parseInt(A.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0);var E=parseInt(A.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);if(E&&!this.rowsBuffer[E-1]){this.rowsBuffer[E-1]=null}if(this.isTreeGrid()){return this._process_tree_xml(A)}for(var C=0;C<H.length;C++){if(this.rowsBuffer[C+F]){continue}var J=H[C].getAttribute("id")||(C+F+1);this.rowsBuffer[C+F]={idd:J,data:H[C],_parser:this._process_xml_row,_locator:this._get_xml_data};this.rowsAr[J]=H[C]}this.render_dataset();this._parsing=false;return A.xmlDoc.responseXML?A.xmlDoc.responseXML:A.xmlDoc},_process_jsarray:function(data){this._parsing=true;if(data&&data.xmlDoc){eval("data="+data.xmlDoc.responseText+";")}for(var i=0;i<data.length;i++){var id=i+1;this.rowsBuffer.push({idd:id,data:data[i],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.rowsAr[id]=data[i]}this.render_dataset();this._parsing=false},_process_csv:function(E){this._parsing=true;if(E.xmlDoc){E=E.xmlDoc.responseText}E=E.replace(/\r/g,"");E=E.split(this.csv.row);if(this._csvHdr){this.clearAll();var D=E.splice(0,1)[0].split(this.csv.cell);if(!this._csvAID){D.splice(0,1)}this.setHeader(D.join(this.delim));this.init()}for(var C=0;C<E.length;C++){if(!E[C]&&C==E.length-1){continue}if(this._csvAID){var F=C+1;this.rowsBuffer.push({idd:F,data:E[C],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var A=E[C].split(this.csv.cell);var F=A.splice(0,1)[0];this.rowsBuffer.push({idd:F,data:A,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[F]=E[C]}this.render_dataset();this._parsing=false},_process_json:function(data){this._parsing=true;if(data&&data.xmlDoc){eval("data="+data.xmlDoc.responseText+";")}for(var i=0;i<data.rows.length;i++){var id=data.rows[i].id;this.rowsBuffer.push({idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data});this.rowsAr[id]=data[i]}this.render_dataset();this._parsing=false},render_dataset:function(D,A){if(this._srnd){if(this._fillers){return this._update_srnd_view()}A=Math.min((this._get_view_size()+(this._srnd_pr||0)),this.rowsBuffer.length)}if(this.pagingOn){D=Math.max((D||0),(this.currentPage-1)*this.rowsBufferOutSize);A=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)}else{D=D||0;A=A||this.rowsBuffer.length}for(var C=D;C<A;C++){var F=this.render_row(C);if(F==-1){if(this.xmlFileUrl){if(this.callEvent("onDynXLS",[C,(this._dpref?this._dpref:(A-C))])){this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+C+"&count="+(this._dpref?this._dpref:(A-C)),this._data_type)}}A=C;break}if(!F.parentNode||!F.parentNode.tagName){this._insertRowAt(F,C);if(F._attrs.selected||F._attrs.select){this.selectRow(F,F._attrs.call?true:false,true);F._attrs.selected=F._attrs.select=null}}if(this._ads_count&&C-D==this._ads_count){var E=this;this._context_parsing=this._context_parsing||this._parsing;return this._contextCallTimer=window.setTimeout(function(){E._contextCallTimer=null;E.render_dataset(C,A);if(!E._contextCallTimer){if(E._context_parsing){E.callEvent("onXLE",[])}else{E._fixAlterCss()}E.callEvent("onDistributedEnd",[]);E._context_parsing=false}},this._ads_time)}}if(this._srnd&&!this._fillers){this._fillers=[this._add_filler(A,this.rowsBuffer.length-A)]}this.setSizes()},render_row:function(C){if(!this.rowsBuffer[C]){return -1}if(this.rowsBuffer[C]._parser){var A=this.rowsBuffer[C];if(this.rowsAr[A.idd]&&this.rowsAr[A.idd].tagName=="TR"){return this.rowsBuffer[C]=this.rowsAr[A.idd]}var D=this._prepareRow(A.idd);this.rowsBuffer[C]=D;this.rowsAr[A.idd]=D;A._parser.call(this,D,A.data);this._postRowProcessing(D);return D}return this.rowsBuffer[C]},_get_cell_value:function(C,A,D){if(C._locator){if(this._c_order){A=this._c_order[A]}return C._locator.call(this,C.data,A)}return this.cells3(C,A)[D?D:"getValue"]()},sortRows:function(D,H,C){C=(C||"asc").toLowerCase();H=(H||this.fldSort[D]);D=D||0;if(this.isTreeGrid()){this.sortTreeRows(D,H,C)}else{var A={};var F=this.cellType[D];var I="getValue";if(F=="link"){I="getContent"}if(F=="dhxCalendar"||F=="dhxCalendarA"){I="getDate"}for(var E=0;E<this.rowsBuffer.length;E++){A[this.rowsBuffer[E].idd]=this._get_cell_value(this.rowsBuffer[E],D,I)}this._sortRows(D,H,C,A)}this.callEvent("onAfterSorting",[D,H,C])},_sortCore:function(D,H,C,A,F){var E="sort";if(this._sst){F.stablesort=this.rowsCol.stablesort;E="stablesort"}if(H.length>4){H=window[H]}if(H=="cus"){var I=this._customSorts[D];F[E](function(K,J){return I(A[K.idd],A[J.idd],C,K.idd,J.idd)})}else{if(typeof (H)=="function"){F[E](function(K,J){return H(A[K.idd],A[J.idd],C,K.idd,J.idd)})}else{if(H=="str"){F[E](function(K,J){if(C=="asc"){return A[K.idd]>A[J.idd]?1:-1}else{return A[K.idd]<A[J.idd]?1:-1}})}else{if(H=="int"){F[E](function(L,K){var J=parseFloat(A[L.idd]);J=isNaN(J)?-99999999999999:J;var M=parseFloat(A[K.idd]);M=isNaN(M)?-99999999999999:M;if(C=="asc"){return J-M}else{return M-J}})}else{if(H=="date"){F[E](function(L,K){var J=Date.parse(A[L.idd])||(Date.parse("01/01/1900"));var M=Date.parse(A[K.idd])||(Date.parse("01/01/1900"));if(C=="asc"){return J-M}else{return M-J}})}}}}}},_sortRows:function(D,E,C,A){this._sortCore(D,E,C,A,this.rowsBuffer);this._reset_view();this.callEvent("onGridReconstructed",[])},_reset_view:function(D){if(!this.obj.rows[0]){return }this.callEvent("onResetView",[]);var A=this.obj.rows[0].parentNode;var E=A.removeChild(A.childNodes[0],true);if(_isKHTML){for(var C=A.parentNode.childNodes.length-1;C>=0;C--){if(A.parentNode.childNodes[C].tagName=="TR"){A.parentNode.removeChild(A.parentNode.childNodes[C],true)}}}else{if(_isIE){for(var C=A.childNodes.length-1;C>=0;C--){A.childNodes[C].removeNode(true)}}else{A.innerHTML=""}}A.appendChild(E);this.rowsCol=dhtmlxArray();if(this._sst){this.enableStableSorting(true)}this._fillers=this.undefined;if(!D){if(_isIE&&this._srnd){this.render_dataset()}else{this.render_dataset()}}},deleteRow:function(C,E){if(!E){E=this.getRowById(C)}if(!E){return }this.editStop();if(!this._realfake){if(this.callEvent("onBeforeRowDeleted",[C])==false){return false}}var A=0;if(this.cellType._dhx_find("tree")!=-1&&!this._realfake){A=this._h2.get[C].parent.id;this._removeTrGrRow(E)}else{if(E.parentNode){E.parentNode.removeChild(E)}var H=this.rowsCol._dhx_find(E);if(H!=-1){this.rowsCol._dhx_removeAt(H)}for(var D=0;D<this.rowsBuffer.length;D++){if(this.rowsBuffer[D]&&this.rowsBuffer[D].idd==C){this.rowsBuffer._dhx_removeAt(D);H=D;break}}}this.rowsAr[C]=null;for(var D=0;D<this.selectedRows.length;D++){if(this.selectedRows[D].idd==C){this.selectedRows._dhx_removeAt(D)}}if(this._srnd){for(var D=0;D<this._fillers.length;D++){var F=this._fillers[D];if(!F){continue}if(F[0]>=H){F[0]=F[0]-1}else{if(F[1]>=H){F[1]=F[1]-1}}}this._update_srnd_view()}if(this.pagingOn){this.changePage()}if(!this._realfake){this.callEvent("onAfterRowDeleted",[C,A])}this.callEvent("onGridReconstructed",[]);if(this._ahgr){this.setSizes()}return true},_addRow:function(A,J,H){if(H==-1||typeof H=="undefined"){H=this.rowsBuffer.length}if(typeof J=="string"){J=J.split(this.delim)}var I=this._prepareRow(A);I._attrs={};for(var C=0;C<I.childNodes.length;C++){I.childNodes[C]._attrs={}}this.rowsAr[I.idd]=I;if(this._h2){this._h2.get[I.idd].buff=I}this._fillRow(I,J);this._postRowProcessing(I);if(this._skipInsert){this._skipInsert=false;return this.rowsAr[I.idd]=I}if(this.pagingOn){this.rowsBuffer._dhx_insertAt(H,I);this.rowsAr[I.idd]=I;return I}if(this._fillers){this.rowsCol._dhx_insertAt(H,null);this.rowsBuffer._dhx_insertAt(H,I);if(this._fake){this._fake.rowsCol._dhx_insertAt(H,null)}this.rowsAr[I.idd]=I;var F=false;for(var D=0;D<this._fillers.length;D++){var E=this._fillers[D];if(E&&E[0]<=H&&(E[0]+E[1])>=H){E[1]=E[1]+1;E[2].firstChild.style.height=parseInt(E[2].firstChild.style.height)+this._srdh+"px";F=true;if(this._fake){this._fake._fillers[D][1]++}}if(E&&E[0]>H){E[0]=E[0]+1;if(this._fake){this._fake._fillers[D][0]++}}}if(!F){this._fillers.push(this._add_filler(H,1,(H==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:(this.rowsCol[1])}:this.rowsCol[H-1]),true))}return I}this.rowsBuffer._dhx_insertAt(H,I);return this._insertRowAt(I,H)},addRow:function(A,E,D){var C=this._addRow(A,E,D);if(!this.dragContext){this.callEvent("onRowAdded",[A])}if(this.pagingOn){this.changePage(this.currentPage)}if(this._srnd){this._update_srnd_view()}C._added=true;if(this._ahgr){this.setSizes()}this.callEvent("onGridReconstructed",[]);return C},_insertRowAt:function(C,D,A){this.rowsAr[C.idd]=C;if(this._skipInsert){this._skipInsert=false;return C}if((D<0)||((!D)&&(parseInt(D)!==0))){D=this.rowsCol.length}else{if(D>this.rowsCol.length){D=this.rowsCol.length}}if(this._cssEven){if((this._cssSP?this.getLevel(C.idd):D)%2==1){C.className+=" "+this._cssUnEven+(this._cssSU?(" "+this._cssUnEven+"_"+this.getLevel(C.idd)):"")}else{C.className+=" "+this._cssEven+(this._cssSU?(" "+this._cssEven+"_"+this.getLevel(C.idd)):"")}}if(!A){if((D==(this.obj.rows.length-1))||(!this.rowsCol[D])){if(_isKHTML){this.obj.appendChild(C)}else{this.obj.firstChild.appendChild(C)}}else{this.rowsCol[D].parentNode.insertBefore(C,this.rowsCol[D])}}this.rowsCol._dhx_insertAt(D,C);this.callEvent("onRowInserted",[C,D]);return C},getRowById:function(D){var C=this.rowsAr[D];if(C){if(C.tagName!="TR"){for(var A=0;A<this.rowsBuffer.length;A++){if(this.rowsBuffer[A]&&this.rowsBuffer[A].idd==D){return this.render_row(A)}}if(this._h2){return this.render_row(null,C.idd)}}return C}return null},cellById:function(C,A){return this.cells(C,A)},cells:function(D,C){if(arguments.length==0){return this.cells4(this.cell)}else{var E=this.getRowById(D)}var A=(E._childIndexes?E.childNodes[E._childIndexes[C]]:E.childNodes[C]);return this.cells4(A)},cellByIndex:function(C,A){return this.cells2(C,A)},cells2:function(D,C){var E=this.render_row(D);var A=(E._childIndexes?E.childNodes[E._childIndexes[C]]:E.childNodes[C]);return this.cells4(A)},cells3:function(D,C){var A=(D._childIndexes?D.childNodes[D._childIndexes[C]]:D.childNodes[C]);return this.cells4(A)},cells4:function(A){var C=window["eXcell_"+(A._cellType||this.cellType[A._cellIndex])];if(C){return new C(A)}},cells5:function(A,D){var D=D||(A._cellType||this.cellType[A._cellIndex]);if(!this._ecache[D]){if(!window["eXcell_"+D]){var C=eXcell_ro}else{var C=window["eXcell_"+D]}this._ecache[D]=new C(A)}this._ecache[D].cell=A;return this._ecache[D]},dma:function(A){if(!this._ecache){this._ecache={}}if(A&&!this._dma){this._dma=this.cells4;this.cells4=this.cells5}else{if(!A&&this._dma){this.cells4=this._dma;this._dma=null}}},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(A){if(arguments.length>0){this.smartTabOrder=convertStringToBoolean(A)}else{this.smartTabOrder=true}},setExternalTabOrder:function(D,A){var C=this;this.tabStart=(typeof (D)=="object")?D:document.getElementById(D);this.tabStart.onkeydown=function(F){var E=(F||window.event);if(E.keyCode==9){E.cancelBubble=true;C.selectCell(0,0,0,0,1);if(C.smartTabOrder&&C.cells2(0,0).isDisabled()){C._key_events.k9_0_0.call(C)}this.blur();return false}};if(_isOpera){this.tabStart.onkeypress=this.tabStart.onkeydown}this.tabEnd=(typeof (A)=="object")?A:document.getElementById(A);this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(F){var E=(F||window.event);if((E.keyCode==9)&&E.shiftKey){E.cancelBubble=true;C.selectCell((C.getRowsNum()-1),(C.getColumnCount()-1),0,0,1);if(C.smartTabOrder&&C.cells2((C.getRowsNum()-1),(C.getColumnCount()-1)).isDisabled()){C._key_events.k9_0_1.call(C)}this.blur();return false}};if(_isOpera){this.tabEnd.onkeypress=this.tabEnd.onkeydown}},uid:function(){if(!this._ui_seed){this._ui_seed=(new Date()).valueOf()}return this._ui_seed++},clearAndLoad:function(){var A=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=A;this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var A=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,A,Math.min(A+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}};(function(){function E(I,J){this[I]=J}function H(I,J){this[I].call(this,J)}function D(I,J){this[I].call(this,J.join(this.delim))}function A(I,L){for(var K=0;K<L.length;K++){if(typeof L[K]=="object"){var M=this.getCombo(K);for(var J in L[K]){M.put(J,L[K][J])}}}}function F(I,P,L){var S=1;var O=[];function Q(U,T,V){if(!O[T]){O[T]=[]}if(typeof V=="object"){V.toString=function(){return this.text}}O[T][U]=V}for(var M=0;M<P.length;M++){if(typeof (P[M])=="object"&&P[M].length){for(var K=0;K<P[M].length;K++){Q(M,K,P[M][K])}}else{Q(M,0,P[M])}}for(var M=0;M<O.length;M++){for(var K=0;K<O[0].length;K++){var N=O[M][K];O[M][K]=(N||"").toString()||"&nbsp;";if(N&&N.colspan){for(var J=1;J<N.colspan;J++){Q(K+J,M,"#cspan")}}if(N&&N.rowspan){for(var J=1;J<N.rowspan;J++){Q(K,M+J,"#rspan")}}}}this.setHeader(O[0]);for(var M=1;M<O.length;M++){this.attachHeader(O[M])}}var C=[{name:"label",def:"&nbsp;",operation:"setHeader",type:F},{name:"id",def:"",operation:"columnIds",type:E},{name:"width",def:"*",operation:"setInitWidths",type:D},{name:"align",def:"left",operation:"cellAlign",type:E},{name:"valign",def:"middle",operation:"cellVAlign",type:E},{name:"sort",def:"na",operation:"fldSort",type:E},{name:"type",def:"ro",operation:"setColTypes",type:D},{name:"options",def:"",operation:"",type:A}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(I){return[I.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_rendering:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(M){for(var I=0;I<C.length;I++){var L=[];for(var J=0;J<M.length;J++){L[J]=M[J][C[I].name]||C[I].def}var K=C[I].type||H;K.call(this,C[I].operation,L,M)}this.init()},rows:function(I){},headers:function(J){for(var I=0;I<J.length;I++){this.attachHeader(J[I])}}})})();dhtmlXGridObject.prototype._dp_init=function(A){A.attachEvent("insertCallback",function(C,E){if(this.obj._h2){this.obj.addRow(E,D,null,parent)}else{this.obj.addRow(E,[],0)}var D=this.obj.getRowById(E);if(D){this.obj._process_xml_row(D,C.firstChild);this.obj._postRowProcessing(D)}});A.attachEvent("updateCallback",function(C,E){var D=this.obj.getRowById(E);if(D){this.obj._process_xml_row(D,C.firstChild);this.obj._postRowProcessing(D)}});A.attachEvent("deleteCallback",function(C,D){this.obj.setUserData(D,this.action_param,"true_deleted");this.obj.deleteRow(D)});A._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(E,F,D){if(A._columns&&!A._columns[D]){return true}var C=this.cells(F,D);if(E==1){if(C.isCheckbox()){A.setUpdated(F,true)}}else{if(E==2){if(C.wasChanged()){A.setUpdated(F,true)}}}return true});this.attachEvent("onRowPaste",function(C){A.setUpdated(C,true)});this.attachEvent("onRowIdChange",function(E,C){var D=A.findRow(E);if(D<A.updatedRows.length){A.updatedRows[D]=C}});this.attachEvent("onSelectStateChanged",function(C){if(A.updateMode=="row"){A.sendData()}return true});this.attachEvent("onEnter",function(D,C){if(A.updateMode=="row"){A.sendData()}return true});this.attachEvent("onBeforeRowDeleted",function(C){if(!this.rowsAr[C]){return true}if(this.dragContext&&A.dnd){window.setTimeout(function(){A.setUpdated(C,true)},1);return true}var D=A.getState(C);if(this._h2){this._h2.forEachChild(C,function(E){A.setUpdated(E.id,false);A.markRow(E.id,true,"deleted")},this)}if(D=="inserted"){A.set_invalid(C,false);A.setUpdated(C,false);return true}if(D=="deleted"){return false}if(D=="true_deleted"){A.setUpdated(C,false);return true}A.setUpdated(C,true,"deleted");return false});this.attachEvent("onRowAdded",function(C){if(this.dragContext&&A.dnd){return true}A.setUpdated(C,true,"inserted");return true});A._getRowData=function(D,L){var H=[];H.gr_id=D;if(this.obj.isTreeGrid()){H.gr_pid=this.obj.getParentId(D)}var C=this.obj.getRowById(D);for(var I=0;I<this.obj._cCount;I++){if(this.obj._c_order){var J=this.obj._c_order[I]}else{var J=I}var K=this.obj.cells(C.idd,I);if(this._changed&&!K.wasChanged()){continue}if(this._endnm){H[this.obj.getColumnId(I)]=K.getValue()}else{H["c"+J]=K.getValue()}}var E=this.obj.UserData[D];if(E){for(var F=0;F<E.keys.length;F++){if(E.keys[F].indexOf("__")!=0){H[E.keys[F]]=E.values[F]}}}var E=this.obj.UserData.gridglobaluserdata;if(E){for(var F=0;F<E.keys.length;F++){H[E.keys[F]]=E.values[F]}}return H};A._clearUpdateFlag=function(D){var E=this.obj.getRowById(D);if(E){for(var C=0;C<this.obj._cCount;C++){this.obj.cells(D,C).cell.wasChanged=false}}};A.checkBeforeUpdate=function(H){var F=true;var C=[];for(var E=0;E<this.obj._cCount;E++){if(this.mandatoryFields[E]){var D=this.mandatoryFields[E].call(this.obj,this.obj.cells(H,E).getValue(),H,E);if(typeof D=="string"){this.messages.push(D);F=false}else{F&=D;C[E]=!D}}}if(!F){this.set_invalid(H,"invalid",C);this.setUpdated(H,false)}return F}};dhtmlXGridObject.prototype.enableBlockSelection=function(C){if(typeof this._bs_mode=="undefined"){var A=this;this.obj.onmousedown=function(D){if(A._bs_mode){A._OnSelectionStart((D||event),this)}return true};this._CSVRowDelimiter=this.csv.row;this.attachEvent("onResize",function(){A._HideSelection();return true});this.attachEvent("onFilterEnd",this._HideSelection)}if(C===false){this._bs_mode=false;return this._HideSelection()}else{this._bs_mode=true}};dhtmlXGridObject.prototype.forceLabelSelection=function(A){this._strictText=convertStringToBoolean(A)};dhtmlXGridObject.prototype.disableBlockSelection=function(){this.obj.onmousedown=null};dhtmlXGridObject.prototype._OnSelectionStart=function(D,E){var C=this;if(D.button==2){return }var F=D.srcElement||D.target;if(this.editor){if(F.tagName&&(F.tagName=="INPUT"||F.tagName=="TEXTAREA")){return }this.editStop()}if(F.tagName&&F.tagName=="TABLE"){return }if(!C.isActive){C.setActive(true)}var I=this.getPosition(this.obj);var A=D.clientX-I[0]+document.body.scrollLeft;var H=D.clientY-I[1]+document.body.scrollTop;this._CreateSelection(A-4,H-4);if(F==this._selectionObj){this._HideSelection();this._startSelectionCell=null}else{while(F.tagName.toLowerCase()!="td"){F=F.parentNode}this._startSelectionCell=F}if(this._startSelectionCell){if(!this.callEvent("onBeforeBlockSelected",[this._startSelectionCell.parentNode.idd,this._startSelectionCell._cellIndex])){return this._startSelectionCell=null}}this.obj.onmousedown=null;this.obj[_isIE?"onmouseleave":"onmouseout"]=function(J){if(C._blsTimer){window.clearTimeout(C._blsTimer)}};this.obj.onmmold=this.obj.onmousemove;this._init_pos=[A,H];this._selectionObj.onmousemove=this.obj.onmousemove=function(J){J=J||D;J.returnValue=false;C._OnSelectionMove(J)};this._oldDMP=document.body.onmouseup;document.body.onmouseup=function(J){J=J||D;C._OnSelectionStop(J,this);return true};this.callEvent("onBeforeBlockSelection",[]);document.body.onselectstart=function(){return false}};dhtmlXGridObject.prototype._getCellByPos=function(A,E){A=A;E=E;var C=0;for(var D=0;D<this.obj.rows.length;D++){E-=this.obj.rows[D].offsetHeight;if(E<=0){C=this.obj.rows[D];break}}if(!C||!C.idd){return null}for(var D=0;D<this._cCount;D++){A-=this.obj.rows[0].childNodes[D].offsetWidth;if(A<=0){while(true){if(C._childIndexes&&C._childIndexes[D+1]==C._childIndexes[D]){C=C.previousSibling}else{return this.cells(C.idd,D).cell}}}}return null};dhtmlXGridObject.prototype._OnSelectionMove=function(D){var P=this;this._ShowSelection();var L=this.getPosition(this.obj);var H=D.clientX-L[0]+(document.body.scrollLeft||(document.documentElement?document.documentElement.scrollLeft:0));var F=D.clientY-L[1]+(document.body.scrollTop||(document.documentElement?document.documentElement.scrollTop:0));if((Math.abs(this._init_pos[0]-H)<2)&&(Math.abs(this._init_pos[1]-F)<2)){return this._HideSelection()}var N=this._endSelectionCell;if(this._startSelectionCell==null){this._endSelectionCell=this._startSelectionCell=this.getFirstParentOfType(D.srcElement||D.target,"TD")}else{if(D.srcElement||D.target){if((D.srcElement||D.target).className=="dhtmlxGrid_selection"){this._endSelectionCell=(this._getCellByPos(H,F)||this._endSelectionCell)}else{var O=this.getFirstParentOfType(D.srcElement||D.target,"TD");if(O.parentNode.idd){this._endSelectionCell=O}}}}if(this._endSelectionCell){if(!this.callEvent("onBeforeBlockSelected",[this._endSelectionCell.parentNode.idd,this._endSelectionCell._cellIndex])){this._endSelectionCell=N}}var E=this.objBox.scrollLeft+this.objBox.clientWidth;var A=this.objBox.scrollTop+this.objBox.clientHeight;var J=this.objBox.scrollLeft;var I=this.objBox.scrollTop;var C=false;if(this._blsTimer){window.clearTimeout(this._blsTimer)}if(H+20>=E){this.objBox.scrollLeft=this.objBox.scrollLeft+20;C=true}else{if(H-20<J){this.objBox.scrollLeft=this.objBox.scrollLeft-20;C=true}}if(F+20>=A&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop+20;C=true}else{if(F-20<I&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop-20;C=true}}this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._endSelectionCell);if(C){var M=D.clientX;var K=D.clientY;this._blsTimer=window.setTimeout(function(){P._OnSelectionMove({clientX:M,clientY:K})},100)}};dhtmlXGridObject.prototype._OnSelectionStop=function(C){var A=this;if(this._blsTimer){window.clearTimeout(this._blsTimer)}this.obj.onmousedown=function(E){if(A._bs_mode){A._OnSelectionStart((E||C),this)}return true};this.obj.onmousemove=this.obj.onmmold||null;this._selectionObj.onmousemove=null;document.body.onmouseup=this._oldDMP||null;if(parseInt(this._selectionObj.style.width)<2&&parseInt(this._selectionObj.style.height)<2){this._HideSelection()}else{var D=this.getFirstParentOfType(C.srcElement||C.target,"TD");if((!D)||(!D.parentNode.idd)){D=this._endSelectionCell}if(!D){return this._HideSelection()}while(D.tagName.toLowerCase()!="td"){D=D.parentNode}this._stopSelectionCell=D;this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._stopSelectionCell);this.callEvent("onBlockSelected",[])}document.body.onselectstart=function(){}};dhtmlXGridObject.prototype._RedrawSelectionPos=function(N,I){var L={};L.LeftTopCol=N._cellIndex;L.LeftTopRow=this.getRowIndex(N.parentNode.idd);L.RightBottomCol=I._cellIndex;L.RightBottomRow=this.getRowIndex(I.parentNode.idd);var E=N.offsetWidth;var D=N.offsetHeight;N=this.getPosition(N,this.obj);var O=I.offsetWidth;var J=I.offsetHeight;I=this.getPosition(I,this.obj);if(N[0]<I[0]){var F=N[0];var H=I[0]+O}else{var K=L.RightBottomCol;L.RightBottomCol=L.LeftTopCol;L.LeftTopCol=K;var F=I[0];var H=N[0]+E}if(N[1]<I[1]){var M=N[1];var A=I[1]+J}else{var K=L.RightBottomRow;L.RightBottomRow=L.LeftTopRow;L.LeftTopRow=K;var M=I[1];var A=N[1]+D}var P=H-F;var C=A-M;this._selectionObj.style.left=F+"px";this._selectionObj.style.top=M+"px";this._selectionObj.style.width=P+"px";this._selectionObj.style.height=C+"px";return L};dhtmlXGridObject.prototype._CreateSelection=function(A,D){if(this._selectionObj==null){var C=document.createElement("div");C.style.position="absolute";C.style.display="none";C.className="dhtmlxGrid_selection";this._selectionObj=C;this._selectionObj.onmousedown=function(E){E=E||event;if(E.button==2||(_isMacOS&&E.ctrlKey)){return this.parentNode.grid.callEvent("onBlockRightClick",["BLOCK",E])}};this._selectionObj.oncontextmenu=function(E){(E||event).cancelBubble=true;return false};this.objBox.appendChild(this._selectionObj)}this._selectionObj.style.width="0px";this._selectionObj.style.height="0px";this._selectionObj.style.left=A+"px";this._selectionObj.style.top=D+"px";this._selectionObj.startX=A;this._selectionObj.startY=D};dhtmlXGridObject.prototype._ShowSelection=function(){if(this._selectionObj){this._selectionObj.style.display=""}};dhtmlXGridObject.prototype._HideSelection=function(){if(this._selectionObj){this._selectionObj.style.display="none"}this._selectionArea=null};dhtmlXGridObject.prototype.copyBlockToClipboard=function(){if(this._selectionArea!=null){var D=new Array();if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText){this._agetm="getTitle"}else{this._agetm="getValue"}}for(var A=this._selectionArea.LeftTopRow;A<=this._selectionArea.RightBottomRow;A++){var C=this._serializeRowToCVS(this.rowsBuffer[A],null,this._selectionArea.LeftTopCol,this._selectionArea.RightBottomCol+1);if(!this._csvAID){D[D.length]=C.substr(C.indexOf(this.csv.cell)+1)}else{D[D.length]=C}}D=D.join(this._CSVRowDelimiter);this.toClipBoard(D)}};dhtmlXGridObject.prototype.pasteBlockFromClipboard=function(){var H=this.fromClipBoard();if(this._selectionArea!=null){var N=this._selectionArea.LeftTopRow;var A=this._selectionArea.LeftTopCol}else{if(this.cell!=null&&!this.editor){var N=this.getRowIndex(this.cell.parentNode.idd);var A=this.cell._cellIndex}else{return false}}H=H.split(this._CSVRowDelimiter);if((H.length>1)&&(H[H.length-1]=="")){H.splice(H.length-1,1)}for(var J=0;J<H.length;J++){H[J]=H[J].split(this.csv.cell)}var I=N+H.length;var L=A+H[0].length;if(L>this._cCount){L=this._cCount}var E=0;for(var J=N;J<I;J++){var O=this.render_row(J);if(O==-1){continue}var D=0;for(var F=A;F<L;F++){var K=this.cells3(O,F);if(K.isDisabled()){D++;continue}if(this._onEditUndoRedo){this._onEditUndoRedo(2,O.idd,F,H[E][D],K.getValue())}if(K.combo){var M=K.combo.values;for(var C=0;C<M.length;C++){if(H[E][D]==M[C]){K.setValue(K.combo.keys[C]);M=null;break}}if(M!=null&&K.editable){K.setValue(H[E][D++])}else{D++}}else{K[K.setImage?"setLabel":"setValue"](H[E][D++])}K.cell.wasChanged=true}this.callEvent("onRowPaste",[O.idd]);E++}};dhtmlXGridObject.prototype.getSelectedBlock=function(A){A=(A||"index");if(this._selectionArea){if(A=="index"){return{LeftTopRow:this._selectionArea.LeftTopRow,LeftTopCol:this._selectionArea.LeftTopCol,RightBottomRow:this._selectionArea.RightBottomRow,RightBottomCol:this._selectionArea.RightBottomCol}}else{return{LeftTopRow:this.getRowId(this._selectionArea.LeftTopRow),LeftTopCol:this._selectionArea.LeftTopCol,RightBottomRow:this.getRowId(this._selectionArea.RightBottomRow),RightBottomCol:this._selectionArea.RightBottomCol}}}else{if(this.getSelectedRowId()!==null){if(A=="id"){return{LeftTopRow:this.getSelectedRowId(),LeftTopCol:this.getSelectedCellIndex(),RightBottomRow:this.getSelectedRowId(),RightBottomCol:this.getSelectedCellIndex()}}else{return{LeftTopRow:this.getRowIndex(this.getSelectedRowId()),LeftTopCol:this.getSelectedCellIndex(),RightBottomRow:this.getRowIndex(this.getSelectedRowId()),RightBottomCol:this.getSelectedCellIndex()}}}else{return null}}};dhtmlXGridObject.prototype.toPDF=function(E,L,P,N,J){var F={row:this.getSelectedRowId(),col:this.getSelectedCellIndex()};if(F.row===null||F.col===-1){F=false}else{var C=this.cells(F.row,F.col).cell;C.parentNode.className=C.parentNode.className.replace(" rowselected","");C.className=C.className.replace(" cellselected","");F.el=C}L=L||"color";var T=L=="full_color";var A=this;A._asCDATA=true;eXcell_ch.prototype.getContent=function(){return this.getValue()};eXcell_ra.prototype.getContent=function(){return this.getValue()};function V(Y){var d=[];for(var b=1;b<A.hdr.rows.length;b++){d[b]=[];for(var a=0;a<A._cCount;a++){var f=A.hdr.rows[b].childNodes[a];if(!d[b][a]){d[b][a]=[0,0]}if(f){d[b][f._cellIndexS]=[f.colSpan,f.rowSpan]}}}var c="<rows profile='"+Y+"'";if(P){c+=" header='"+P+"'"}if(N){c+=" footer='"+N+"'"}c+="><head>"+A._serialiseExportConfig(d).replace(/^<head/,"<columns").replace(/head>$/,"columns>");for(var b=2;b<A.hdr.rows.length;b++){var W=0;var l=A.hdr.rows[b];var e="";for(var a=0;a<A._cCount;a++){if((A._srClmn&&!A._srClmn[a])||(A._hrrar[a])){W++;continue}var h=d[b][a];var g=((h[0]&&h[0]>1)?' colspan="'+h[0]+'" ':"");if(h[1]&&h[1]>1){g+=' rowspan="'+h[1]+'" ';W=-1}var X="";for(var Z=0;Z<l.cells.length;Z++){if(l.cells[Z]._cellIndexS==a){if(l.cells[Z].getElementsByTagName("SELECT").length){X=""}else{X=_isIE?l.cells[Z].innerText:l.cells[Z].textContent}X=X.replace(/[ \n\r\t\xA0]+/," ");break}}if(!X||X==" "){W++}e+="<column"+g+"><![CDATA["+X+"]]></column>"}if(W!=A._cCount){c+="\n<columns>"+e+"</columns>"}}c+="</head>\n";c+=K();return c}function D(){var W=[];if(J){for(var X=0;X<J.length;X++){W.push(O(A.getRowIndex(J[X])))}}else{for(var X=0;X<A.getRowsNum();X++){W.push(O(X))}}return W.join("\n")}function K(){var Y=["<foot>"];if(!A.ftr){return""}for(var Z=1;Z<A.ftr.rows.length;Z++){Y.push("<columns>");var c=A.ftr.rows[Z];for(var X=0;X<A._cCount;X++){if(A._srClmn&&!A._srClmn[X]){continue}if(A._hrrar[X]){continue}for(var W=0;W<c.cells.length;W++){var b="";var a="";if(c.cells[W]._cellIndexS==X){b=_isIE?c.cells[W].innerText:c.cells[W].textContent;b=b.replace(/[ \n\r\t\xA0]+/," ");if(c.cells[W].colSpan&&c.cells[W].colSpan!=1){a=" colspan='"+c.cells[W].colSpan+"' "}break}}Y.push("<column"+a+"><![CDATA["+b+"]]></column>")}Y.push("</columns>")}Y.push("</foot>");return Y.join("\n")}function I(X,W){return(window.getComputedStyle?(window.getComputedStyle(X,null)[W]):(X.currentStyle?X.currentStyle[W]:null))||""}function O(X){if(!A.rowsBuffer[X]){return""}var W=A.render_row(X);if(W.style.display=="none"){return""}var b="<row>";for(var Z=0;Z<A._cCount;Z++){if(((!A._srClmn)||(A._srClmn[Z]))&&(!A._hrrar[Z])){var f=A.cells(W.idd,Z);if(T){var Y=I(f.cell,"color");var e=I(f.cell,"backgroundColor");var d=I(f.cell,"font-weight")||I(f.cell,"fontWeight");var a=I(f.cell,"font-style")||I(f.cell,"fontStyle");var c=I(f.cell,"text-align")||I(f.cell,"textAlign");if(e=="transparent"||e=="rgba(0, 0, 0, 0)"){e="rgb(255,255,255)"}b+="<cell bgColor='"+e+"' textColor='"+Y+"' bold='"+d+"' italic='"+a+"' align='"+c+"'>"}else{b+="<cell>"}b+="<![CDATA["+(f.getContent?f.getContent():f.getTitle())+"]]></cell>"}}return b+"</row>"}function M(){var W="</rows>";return W}if(A._fake){var S=[].concat(A._hrrar);for(var Q=0;Q<A._fake._cCount;Q++){A._hrrar[Q]=null}}var U=document.createElement("div");U.style.display="none";document.body.appendChild(U);var H="form_"+A.uid();U.innerHTML='<form id="'+H+'" method="post" target="_blank" action="'+E+'" accept-charset="utf-8"  enctype="application/x-www-form-urlencoded"><input type="hidden" name="grid_xml" id="grid_xml"/> </form>';document.getElementById(H).firstChild.value=V(L).replace("\u2013","-")+D()+M();document.getElementById(H).submit();U.parentNode.removeChild(U);if(A._fake){A._hrrar=S}A=null;if(F){F.el.parentNode.className+=" rowselected";F.el.className+=" cellselected"}F=null};dhtmlXGridObject.prototype._serialiseExportConfig=function(F){var C="<head>";for(var E=0;E<this.hdr.rows[0].cells.length;E++){if(this._srClmn&&!this._srClmn[E]){continue}if(this._hrrar[E]){continue}var D=this.fldSort[E];if(D=="cus"){D=this._customSorts[E].toString();D=D.replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")}var H=F[1][E];var J=((H[1]&&H[1]>1)?' rowspan="'+H[1]+'" ':"")+((H[0]&&H[0]>1)?' colspan="'+H[0]+'" ':"");C+="<column "+J+" width='"+this.getColWidth(E)+"' align='"+this.cellAlign[E]+"' type='"+this.cellType[E]+"' sort='"+(D||"na")+"' color='"+(this.columnColor[E]||"")+"'"+(this.columnIds[E]?(" id='"+this.columnIds[E]+"'"):"")+">";if(this._asCDATA){C+="<![CDATA["+this.getHeaderCol(E)+"]]>"}else{C+=this.getHeaderCol(E)}var I=this.getCombo(E);if(I){for(var A=0;A<I.keys.length;A++){C+="<option value='"+I.keys[A]+"'>"+I.values[A]+"</option>"}}C+="</column>"}return C+="</head>"};if(window.eXcell_sub_row_grid){window.eXcell_sub_row_grid.prototype.getContent=function(){return""}}dhtmlXGridObject.prototype.toExcel=dhtmlXGridObject.prototype.toPDF;dhtmlXGridObject.prototype._key_events={k13_1_0:function(){this.editStop()},k13_0_1:function(){this.editStop();this._key_events.k38_0_0.call(this)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[(this.row?this.row.idd:null),(this.cell?this.cell._cellIndex:null)]);this._still_active=true;this._key_events.k40_0_0.call(this)},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[true])){return true}if(this.cell&&(this.cell._cellIndex+1)>=this._cCount){return }var A=this._getNextCell(null,1);if(A&&this.row==A.parentNode){this.selectCell(A.parentNode,A._cellIndex,true,true);this._still_active=true}},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[false])){return true}if(this.cell&&(this.cell._cellIndex==0)){return }var A=this._getNextCell(null,-1);if(A&&this.row==A.parentNode){this.selectCell(A.parentNode,A._cellIndex,true,true);this._still_active=true}},k113_0_0:function(){if(this._f2kE){this.editCell()}},k32_0_0:function(){var A=this.cells4(this.cell);if(!A.changeState||(A.changeState()===false)){return false}},k27_0_0:function(){this.editStop(true);this._still_active=true},k33_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage-1)}else{this.scrollPage(-1)}},k34_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage+1)}else{this.scrollPage(1)}},k37_0_0:function(){if(this.editor){return false}if(this.isTreeGrid()){this.collapseKids(this.row)}else{this._key_events.k9_0_1.call(this)}},k39_0_0:function(){if(this.editor){return false}if(!this.editor&&this.isTreeGrid()){this.expandKids(this.row)}else{this._key_events.k9_0_0.call(this)}},k37_1_0:function(){if(this.editor){return false}this.selectCell(this.row,0,true)},k39_1_0:function(){if(this.editor){return false}this.selectCell(this.row,this._cCount-1,true)},k38_1_0:function(){if(this.editor||!this.rowsCol.length){return false}this.selectCell(this.rowsCol[0],this.cell._cellIndex,true)},k40_1_0:function(){if(this.editor||!this.rowsCol.length){return false}this.selectCell(this.rowsCol[this.rowsCol.length-1],this.cell._cellIndex,true)},k38_0_1:function(){if(this.editor||!this.rowsCol.length){return false}var A=this.row.rowIndex;var C=this._nextRow(A-1,-1);if(!C||C._sRow||C._rLoad){return false}this.selectCell(C,this.cell._cellIndex,true,true)},k40_0_1:function(){if(this.editor||!this.rowsCol.length){return false}var A=this.row.rowIndex;var C=this._nextRow(A-1,1);if(!C||C._sRow||C._rLoad){return false}this.selectCell(C,this.cell._cellIndex,true,true)},k38_1_1:function(){if(this.editor||!this.rowsCol.length){return false}var A=this.row.rowIndex;for(var C=A-1;C>=0;C--){this.selectCell(this.rowsCol[C],this.cell._cellIndex,true,true)}},k40_1_1:function(){if(this.editor||!this.rowsCol.length){return false}var A=this.row.rowIndex;for(var C=A;C<this.rowsCol.length;C++){this.selectCell(this.rowsCol[C],this.cell._cellIndex,true,true)}},k40_0_0:function(){if(this.editor&&this.editor.combo){this.editor.shiftNext()}else{if(this.editor){return false}var A=this.rowsCol._dhx_find(this.row)+1;if(A&&A!=this.rowsCol.length&&A!=this.obj.rows.length-1){var C=this._nextRow(A-1,1);if(C._sRow||C._rLoad){return false}this.selectCell(C,this.cell._cellIndex,true)}else{if(!this.callEvent("onLastRow",[])){return false}this._key_events.k34_0_0.apply(this,[])}}},k36_0_0:function(){return this._key_events.k37_1_0.call(this)},k35_0_0:function(){return this._key_events.k39_1_0.call(this)},k36_1_0:function(){if(this.editor||!this.rowsCol.length){return false}this.selectCell(this.rowsCol[0],0,true)},k35_1_0:function(){if(this.editor||!this.rowsCol.length){return false}this.selectCell(this.rowsCol[this.rowsCol.length-1],this._cCount-1,true)},k33_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage-1)}else{this.scrollPage(-1)}},k34_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage+1)}else{this.scrollPage(1)}},k38_0_0:function(){if(this.editor&&this.editor.combo){this.editor.shiftPrev()}else{if(this.editor){return false}var A=A=this.rowsCol._dhx_find(this.row)+1;if(A!=-1){var C=this._nextRow(A-1,-1);if(!C||C._sRow||C._rLoad){return false}this.selectCell(C,this.cell._cellIndex,true)}else{this._key_events.k33_0_0.apply(this,[])}}},k_other:function(C){if(this.editor){return false}if(!C.ctrlKey&&C.keyCode>=40&&(C.keyCode<91||(C.keyCode>95&&C.keyCode<111)||C.keyCode>187)){if(this.cell){var D=this.cells4(this.cell);if(D.isDisabled()){return false}var A=D.getValue();if(D.editable!==false){D.setValue("")}this.editCell();if(this.editor){this.editor.val=A;if(this.editor.obj&&this.editor.obj.select){this.editor.obj.select()}}else{D.setValue(A)}}}}};function dhtmlXToolbarObject(C,D){var A=this;this.cont=(typeof (C)!="object")?document.getElementById(C):C;while(this.cont.childNodes.length>0){this.cont.removeChild(this.cont.childNodes[0])}this.cont.dir="ltr";this.cont.innerHTML+="<div class='dhxtoolbar_hdrline_ll'></div><div class='dhxtoolbar_hdrline_rr'></div><div class='dhxtoolbar_hdrline_l'></div><div class='dhxtoolbar_hdrline_r'></div>";this.base=document.createElement("DIV");this.base.className="float_left";this.cont.appendChild(this.base);this.align="left";this.setAlign=function(E){this.align=(E=="right"?"right":"left");this.base.className=(E=="right"?"float_right":"float_left");if(this._spacer){this._spacer.className="dhxtoolbar_spacer "+(E=="right"?" float_left":" float_right")}};this._isIE6=false;if(_isIE){this._isIE6=(window.XMLHttpRequest==null?true:false)}this._isIPad=(navigator.userAgent.search(/iPad/gi)>=0);if(this._isIPad){this.cont.ontouchstart=function(E){E=E||event;E.returnValue=false;E.cancelBubble=true;return false}}this.selectPolygonOffsetTop=0;this.selectPolygonOffsetLeft=0;this.setSkin=function(H){this.skin=H;if(this.skin=="dhx_skyblue"){this.selectPolygonOffsetTop=2}if(this.skin=="dhx_web"){this.selectPolygonOffsetTop=1;this.selectPolygonOffsetLeft=1}this.cont.className="dhx_toolbar_base_"+this.skin+(this.rtl?" rtl":"");for(var E in this.objPull){var F=this.objPull[E];if(F.type=="slider"){F.pen._detectLimits();F.pen._definePos();F.label.className="dhx_toolbar_slider_label_"+this.skin+(this.rtl?" rtl":"")}if(F.type=="buttonSelect"){F.polygon.className="dhx_toolbar_poly_"+this.skin+(this.rtl?" rtl":"")}}};this.setSkin(D==null?"dhx_skyblue":D);this.objPull={};this.anyUsed="none";this.imagePath="";this.setIconsPath=function(E){this.imagePath=E};this.setIconPath=this.setIconsPath;this._doOnLoad=function(){};this.loadXML=function(E,F){if(F!=null){this._doOnLoad=function(){F()}}this.callEvent("onXLS",[]);this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._xmlLoader.loadXML(E)};this.loadXMLString=function(F,E){if(E!=null){this._doOnLoad=function(){E()}}this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._xmlLoader.loadXMLString(F)};this._xmlParser=function(){var M=this.getXMLTopNode("toolbar");var P=["id","type","hidden","title","text","enabled","img","imgdis","action","openAll","renderSelect","width","value","selected","length","textMin","textMax","toolTip","valueMin","valueMax","valueNow"];var H=["id","type","enabled","disabled","action","selected","img","text"];for(var F=0;F<M.childNodes.length;F++){if(M.childNodes[F].tagName=="item"){var J={};for(var N=0;N<P.length;N++){J[P[N]]=M.childNodes[F].getAttribute(P[N])}J.items=[];J.userdata=[];for(var L=0;L<M.childNodes[F].childNodes.length;L++){if(M.childNodes[F].childNodes[L].tagName=="item"&&J.type=="buttonSelect"){var O={};for(var N=0;N<H.length;N++){O[H[N]]=M.childNodes[F].childNodes[L].getAttribute(H[N])}try{O.itemText=M.childNodes[F].childNodes[L].getElementsByTagName("itemText")[0].firstChild.nodeValue}catch(I){}var K=M.childNodes[F].childNodes[L].getElementsByTagName("userdata");for(var N=0;N<K.length;N++){if(!O.userdata){O.userdata={}}var E={};try{E.name=K[N].getAttribute("name")}catch(I){E.name=""}try{E.value=K[N].firstChild.nodeValue}catch(I){E.value=""}if(E.name!=""){O.userdata[E.name]=E.value}}J.items[J.items.length]=O}if(M.childNodes[F].childNodes[L].tagName=="userdata"){var O={};try{O.name=M.childNodes[F].childNodes[L].getAttribute("name")}catch(I){O.name=""}try{O.value=M.childNodes[F].childNodes[L].firstChild.nodeValue}catch(I){O.value=""}J.userdata[J.userdata.length]=O}}A._addItemToStorage(J)}}A.callEvent("onXLE",[]);A._doOnLoad();this.destructor()};this._addItemToStorage=function(E,J){var I=(E.id||this._genStr(24));var F=(E.type||"");if(F!=""){if(this["_"+F+"Object"]!=null){this.objPull[this.idPrefix+I]=new this["_"+F+"Object"](this,I,E);this.objPull[this.idPrefix+I]["type"]=F;this.setPosition(I,J)}}if(E.userdata){for(var H=0;H<E.userdata.length;H++){this.setUserData(I,E.userdata[H].name,E.userdata[H].value)}}};this._genStr=function(E){var F="";var I="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(var H=0;H<E;H++){F+=I.charAt(Math.round(Math.random()*(I.length-1)))}return F};this.rootTypes=new Array("button","buttonSelect","buttonTwoState","separator","label","slider","text","buttonInput");this.idPrefix=this._genStr(12);dhtmlxEventable(this);this._getObj=function(I,E){var F=null;for(var H=0;H<I.childNodes.length;H++){if(I.childNodes[H].tagName!=null){if(String(I.childNodes[H].tagName).toLowerCase()==String(E).toLowerCase()){F=I.childNodes[H]}}}return F};this._addImgObj=function(F){var E=document.createElement("IMG");if(F.childNodes.length>0){F.insertBefore(E,F.childNodes[0])}else{F.appendChild(E)}return E};this._setItemImage=function(I,F,E){if(E==true){I.imgEn=F}else{I.imgDis=F}if((!I.state&&E==true)||(I.state&&E==false)){return }var H=this._getObj(I.obj,"img");if(H==null){H=this._addImgObj(I.obj)}H.src=this.imagePath+F};this._clearItemImage=function(H,E){if(E==true){H.imgEn=""}else{H.imgDis=""}if((!H.state&&E==true)||(H.state&&E==false)){return }var F=this._getObj(H.obj,"img");if(F!=null){F.parentNode.removeChild(F)}};this._setItemText=function(E,H){var F=this._getObj(E.obj,"div");if(H==null||H.length==0){if(F!=null){F.parentNode.removeChild(F)}return }if(F==null){F=document.createElement("DIV");E.obj.appendChild(F)}F.innerHTML=H};this._getItemText=function(E){var F=this._getObj(E.obj,"div");if(F!=null){return F.innerHTML}return""};this._enableItem=function(F){if(F.state){return }F.state=true;if(this.objPull[F.id]["type"]=="buttonTwoState"&&this.objPull[F.id]["obj"]["pressed"]==true){F.obj.className="dhx_toolbar_btn pres";F.obj.renderAs="dhx_toolbar_btn over"}else{F.obj.className="dhx_toolbar_btn def";F.obj.renderAs=F.obj.className}if(F.arw){F.arw.className=String(F.obj.className).replace("btn","arw")}var E=this._getObj(F.obj,"img");if(F.imgEn!=""){if(E==null){E=this._addImgObj(F.obj)}E.src=this.imagePath+F.imgEn}else{if(E!=null){E.parentNode.removeChild(E)}}};this._disableItem=function(F){if(!F.state){return }F.state=false;F.obj.className="dhx_toolbar_btn dis";F.obj.renderAs="dhx_toolbar_btn def";if(F.arw){F.arw.className=String(F.obj.className).replace("btn","arw")}var E=this._getObj(F.obj,"img");if(F.imgDis!=""){if(E==null){E=this._addImgObj(F.obj)}E.src=this.imagePath+F.imgDis}else{if(E!=null){E.parentNode.removeChild(E)}}if(F.polygon!=null){if(F.polygon.style.display!="none"){F.polygon.style.display="none";if(F.polygon._ie6cover){F.polygon._ie6cover.style.display="none"}}}this.anyUsed="none"};this.clearAll=function(){for(var E in this.objPull){this._removeItem(String(E).replace(this.idPrefix,""))}};this._isWebToolbar=true;this._doOnClick=function(E){A.forEachItem(function(H){if(A.objPull[A.idPrefix+H]["type"]=="buttonSelect"){var F=A.objPull[A.idPrefix+H];if(F.polygon.style.display!="none"){F.obj.renderAs="dhx_toolbar_btn def";F.obj.className=F.obj.renderAs;F.arw.className=String(F.obj.renderAs).replace("btn","arw");A.anyUsed="none";F.polygon.style.display="none";if(F.polygon._ie6cover){F.polygon._ie6cover.style.display="none"}}}})};if(this._isIPad){document.addEventListener("touchstart",this._doOnClick,false)}else{if(_isIE){document.body.attachEvent("onclick",this._doOnClick)}else{window.addEventListener("click",this._doOnClick,false)}}return this}dhtmlXToolbarObject.prototype.addSpacer=function(D){var C=this.idPrefix+D;if(this._spacer!=null){if(this._spacer.idd==D){return }if(this._spacer==this.objPull[C].obj.parentNode){var A=true;while(A){var I=this._spacer.childNodes[0].idd;this.base.appendChild(this._spacer.childNodes[0]);if(I==D||this._spacer.childNodes.length==0){if(this.objPull[C].arw!=null){this.base.appendChild(this.objPull[C].arw)}A=false}}this._spacer.idd=D;return }if(this.base==this.objPull[C].obj.parentNode){var A=true;var H=(this.objPull[C].arw!=null);while(A){var E=this.base.childNodes.length-1;if(H==true){if(this.base.childNodes[E]==this.objPull[C].arw){A=false}}if(this.base.childNodes[E].idd==D){A=false}if(A){if(this._spacer.childNodes.length>0){this._spacer.insertBefore(this.base.childNodes[E],this._spacer.childNodes[0])}else{this._spacer.appendChild(this.base.childNodes[E])}}}this._spacer.idd=D;return }}else{var F=null;for(var E=0;E<this.base.childNodes.length;E++){if(this.base.childNodes[E]==this.objPull[this.idPrefix+D].obj){F=E;if(this.objPull[this.idPrefix+D].arw!=null){F=E+1}}}if(F!=null){this._spacer=document.createElement("DIV");this._spacer.className="dhxtoolbar_spacer "+(this.align=="right"?" float_left":" float_right");this._spacer.dir="rtl";this._spacer.idd=D;while(this.base.childNodes.length>F+1){this._spacer.appendChild(this.base.childNodes[F+1])}this.cont.appendChild(this._spacer)}}};dhtmlXToolbarObject.prototype.removeSpacer=function(){if(!this._spacer){return }while(this._spacer.childNodes.length>0){this.base.appendChild(this._spacer.childNodes[0])}this._spacer.parentNode.removeChild(this._spacer);this._spacer=null};dhtmlXToolbarObject.prototype.getType=function(D){var E=this.getParentId(D);if(E!=null){var C=null;var A=this.objPull[this.idPrefix+E]._listOptions[D];if(A!=null){if(A.sep!=null){C="buttonSelectSeparator"}else{C="buttonSelectButton"}}return C}else{if(this.objPull[this.idPrefix+D]==null){return null}return this.objPull[this.idPrefix+D]["type"]}};dhtmlXToolbarObject.prototype.getTypeExt=function(C){var A=this.getType(C);if(A=="buttonSelectButton"||A=="buttonSelectSeparator"){if(A=="buttonSelectButton"){A="button"}else{A="separator"}return A}return null};dhtmlXToolbarObject.prototype.inArray=function(D,C){for(var A=0;A<D.length;A++){if(D[A]==C){return true}}return false};dhtmlXToolbarObject.prototype.getParentId=function(D){var E=null;for(var C in this.objPull){if(this.objPull[C]._listOptions){for(var A in this.objPull[C]._listOptions){if(A==D){E=String(C).replace(this.idPrefix,"")}}}}return E};dhtmlXToolbarObject.prototype._addItem=function(A,C){this._addItemToStorage(A,C)};dhtmlXToolbarObject.prototype.addButton=function(F,E,C,A,D){this._addItem({id:F,type:"button",text:C,img:A,imgdis:D},E)};dhtmlXToolbarObject.prototype.addText=function(D,C,A){this._addItem({id:D,type:"text",text:A},C)};dhtmlXToolbarObject.prototype.addButtonSelect=function(E,I,L,A,C,J,H,M){var F=[];for(var D=0;D<A.length;D++){var K={};if(A[D].id&&A[D].type){K.id=A[D].id;K.type=(A[D].type=="obj"?"button":"separator");K.text=A[D].text;K.img=A[D].img}else{K.id=A[D][0];K.type=(A[D][1]=="obj"?"button":"separator");K.text=(A[D][2]||null);K.img=(A[D][3]||null)}F[F.length]=K}this._addItem({id:E,type:"buttonSelect",text:L,img:C,imgdis:J,renderSelect:H,openAll:M,items:F},I)};dhtmlXToolbarObject.prototype.addButtonTwoState=function(F,E,C,A,D){this._addItem({id:F,type:"buttonTwoState",img:A,imgdis:D,text:C},E)};dhtmlXToolbarObject.prototype.addSeparator=function(C,A){this._addItem({id:C,type:"separator"},A)};dhtmlXToolbarObject.prototype.addSlider=function(C,I,F,E,K,D,H,A,J){this._addItem({id:C,type:"slider",length:F,valueMin:E,valueMax:K,valueNow:D,textMin:H,textMax:A,toolTip:J},I)};dhtmlXToolbarObject.prototype.addInput=function(E,D,C,A){this._addItem({id:E,type:"buttonInput",value:C,width:A},D)};dhtmlXToolbarObject.prototype.forEachItem=function(C){for(var A in this.objPull){if(this.inArray(this.rootTypes,this.objPull[A]["type"])){C(this.objPull[A]["id"].replace(this.idPrefix,""))}}};(function(){var H="showItem,hideItem,isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth".split(",");var D=["","",false,"","",false,"","","","","","","","","",false,"","","",null,"",[null,null],"",[null,null],"",null];var C=function(I,J){return function(M,L,K){M=this.idPrefix+M;if(this.objPull[M][I]!=null){return this.objPull[M][I].call(this.objPull[M],L,K)}else{return J}}};for(var F=0;F<H.length;F++){var A=H[F];var E=D[F];dhtmlXToolbarObject.prototype[A]=C(A,E)}})();dhtmlXToolbarObject.prototype.getPosition=function(A){return this._getPosition(A)};dhtmlXToolbarObject.prototype._getPosition=function(F,D){if(this.objPull[this.idPrefix+F]==null){return null}var E=null;var A=0;for(var C=0;C<this.base.childNodes.length;C++){if(this.base.childNodes[C].idd!=null){if(this.base.childNodes[C].idd==F){E=A}A++}}if(!E&&this._spacer!=null){for(var C=0;C<this._spacer.childNodes.length;C++){if(this._spacer.childNodes[C].idd!=null){if(this._spacer.childNodes[C].idd==F){E=A}A++}}}return E};dhtmlXToolbarObject.prototype.setPosition=function(A,C){this._setPosition(A,C)};dhtmlXToolbarObject.prototype._setPosition=function(F,E){if(this.objPull[this.idPrefix+F]==null){return }if(isNaN(E)){E=this.base.childNodes.length}if(E<0){E=0}var A=null;if(this._spacer){A=this._spacer.idd;this.removeSpacer()}var D=this.objPull[this.idPrefix+F];this.base.removeChild(D.obj);if(D.arw){this.base.removeChild(D.arw)}var C=this._getIdByPosition(E,true);if(C[0]==null){this.base.appendChild(D.obj);if(D.arw){this.base.appendChild(D.arw)}}else{this.base.insertBefore(D.obj,this.base.childNodes[C[1]]);if(D.arw){this.base.insertBefore(D.arw,this.base.childNodes[C[1]+1])}}if(A!=null){this.addSpacer(A)}};dhtmlXToolbarObject.prototype._getIdByPosition=function(H,C){var F=null;var A=0;var D=0;for(var E=0;E<this.base.childNodes.length;E++){if(this.base.childNodes[E]["idd"]!=null&&F==null){if((A++)==H){F=this.base.childNodes[E]["idd"]}}if(F==null){D++}}D=(F==null?null:D);return(C==true?new Array(F,D):F)};dhtmlXToolbarObject.prototype.removeItem=function(A){this._removeItem(A)};dhtmlXToolbarObject.prototype._removeItem=function(E){var C=this.getType(E);E=this.idPrefix+E;var D=this.objPull[E];if(C=="button"){D.obj._doOnMouseOver=null;D.obj._doOnMouseOut=null;D.obj._doOnMouseUp=null;D.obj._doOnMouseUpOnceAnywhere=null;D.obj.onclick=null;D.obj.onmouseover=null;D.obj.onmouseout=null;D.obj.onmouseup=null;D.obj.onmousedown=null;D.obj.onselectstart=null;D.obj.renderAs=null;D.obj.idd=null;D.obj.parentNode.removeChild(D.obj);D.obj=null;D.id=null;D.state=null;D.img=null;D.imgEn=null;D.imgDis=null;D.type=null;D.enableItem=null;D.disableItem=null;D.isEnabled=null;D.showItem=null;D.hideItem=null;D.isVisible=null;D.setItemText=null;D.getItemText=null;D.setItemImage=null;D.clearItemImage=null;D.setItemImageDis=null;D.clearItemImageDis=null;D.setItemToolTip=null;D.getItemToolTip=null}if(C=="buttonTwoState"){D.obj._doOnMouseOver=null;D.obj._doOnMouseOut=null;D.obj.onmouseover=null;D.obj.onmouseout=null;D.obj.onmousedown=null;D.obj.onselectstart=null;D.obj.renderAs=null;D.obj.idd=null;D.obj.parentNode.removeChild(D.obj);D.obj=null;D.id=null;D.state=null;D.img=null;D.imgEn=null;D.imgDis=null;D.type=null;D.enableItem=null;D.disableItem=null;D.isEnabled=null;D.showItem=null;D.hideItem=null;D.isVisible=null;D.setItemText=null;D.getItemText=null;D.setItemImage=null;D.clearItemImage=null;D.setItemImageDis=null;D.clearItemImageDis=null;D.setItemToolTip=null;D.getItemToolTip=null;D.setItemState=null;D.getItemState=null}if(C=="buttonSelect"){for(var A in D._listOptions){this.removeListOption(E,A)}D._listOptions=null;if(D.polygon._ie6cover){document.body.removeChild(D.polygon._ie6cover);D.polygon._ie6cover=null}D.p_tbl.removeChild(D.p_tbody);D.polygon.removeChild(D.p_tbl);D.polygon.onselectstart=null;document.body.removeChild(D.polygon);D.p_tbody=null;D.p_tbl=null;D.polygon=null;D.obj.onclick=null;D.obj.onmouseover=null;D.obj.onmouseout=null;D.obj.onmouseup=null;D.obj.onmousedown=null;D.obj.onselectstart=null;D.obj.idd=null;D.obj.iddPrefix=null;D.obj.parentNode.removeChild(D.obj);D.obj=null;D.arw.onclick=null;D.arw.onmouseover=null;D.arw.onmouseout=null;D.arw.onmouseup=null;D.arw.onmousedown=null;D.arw.onselectstart=null;D.arw.parentNode.removeChild(D.arw);D.arw=null;D.renderSelect=null;D.state=null;D.type=null;D.id=null;D.img=null;D.imgEn=null;D.imgDis=null;D.openAll=null;D._isListButton=null;D._separatorButtonSelectObject=null;D._buttonButtonSelectObject=null;D.setWidth=null;D.enableItem=null;D.disableItem=null;D.isEnabled=null;D.showItem=null;D.hideItem=null;D.isVisible=null;D.setItemText=null;D.getItemText=null;D.setItemImage=null;D.clearItemImage=null;D.setItemImageDis=null;D.clearItemImageDis=null;D.setItemToolTip=null;D.getItemToolTip=null;D.addListOption=null;D.removeListOption=null;D.showListOption=null;D.hideListOption=null;D.isListOptionVisible=null;D.enableListOption=null;D.disableListOption=null;D.isListOptionEnabled=null;D.setListOptionPosition=null;D.getListOptionPosition=null;D.setListOptionImage=null;D.getListOptionImage=null;D.clearListOptionImage=null;D.setListOptionText=null;D.getListOptionText=null;D.setListOptionToolTip=null;D.getListOptionToolTip=null;D.forEachListOption=null;D.getAllListOptions=null;D.setListOptionSelected=null;D.getListOptionSelected=null}if(C=="buttonInput"){D.obj.childNodes[0].onkeydown=null;D.obj.removeChild(D.obj.childNodes[0]);D.obj.w=null;D.obj.idd=null;D.obj.parentNode.removeChild(D.obj);D.obj=null;D.id=null;D.type=null;D.enableItem=null;D.disableItem=null;D.isEnabled=null;D.showItem=null;D.hideItem=null;D.isVisible=null;D.setItemToolTip=null;D.getItemToolTip=null;D.setWidth=null;D.getWidth=null;D.setValue=null;D.getValue=null;D.setItemText=null;D.getItemText=null}if(C=="slider"){if(this._isIPad){document.removeEventListener("touchmove",pen._doOnMouseMoveStart,false);document.removeEventListener("touchend",pen._doOnMouseMoveEnd,false)}else{if(_isIE){document.body.detachEvent("onmousemove",D.pen._doOnMouseMoveStart);document.body.detachEvent("onmouseup",D.pen._doOnMouseMoveEnd)}else{window.removeEventListener("mousemove",D.pen._doOnMouseMoveStart,false);window.removeEventListener("mouseup",D.pen._doOnMouseMoveEnd,false)}}D.pen.allowMove=null;D.pen.initXY=null;D.pen.maxX=null;D.pen.minX=null;D.pen.nowX=null;D.pen.newNowX=null;D.pen.valueMax=null;D.pen.valueMin=null;D.pen.valueNow=null;D.pen._definePos=null;D.pen._detectLimits=null;D.pen._doOnMouseMoveStart=null;D.pen._doOnMouseMoveEnd=null;D.pen.onmousedown=null;D.obj.removeChild(D.pen);D.pen=null;D.label.tip=null;document.body.removeChild(D.label);D.label=null;D.obj.onselectstart=null;D.obj.idd=null;while(D.obj.childNodes.length>0){D.obj.removeChild(D.obj.childNodes[0])}D.obj.parentNode.removeChild(D.obj);D.obj=null;D.id=null;D.type=null;D.state=null;D.enableItem=null;D.disableItem=null;D.isEnabled=null;D.setItemToolTipTemplate=null;D.getItemToolTipTemplate=null;D.setMaxValue=null;D.setMinValue=null;D.getMaxValue=null;D.getMinValue=null;D.setValue=null;D.getValue=null;D.showItem=null;D.hideItem=null;D.isVisible=null}if(C=="separator"){D.obj.onselectstart=null;D.obj.idd=null;D.obj.parentNode.removeChild(D.obj);D.obj=null;D.id=null;D.type=null;D.showItem=null;D.hideItem=null;D.isVisible=null}if(C=="text"){D.obj.onselectstart=null;D.obj.idd=null;D.obj.parentNode.removeChild(D.obj);D.obj=null;D.id=null;D.type=null;D.showItem=null;D.hideItem=null;D.isVisible=null;D.setWidth=null;D.setItemText=null;D.getItemText=null}C=null;D=null;this.objPull[this.idPrefix+E]=null;delete this.objPull[this.idPrefix+E]};(function(){var E="addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(",");var C=function(F){return function(M,I,H,L,K,J){M=this.idPrefix+M;if(this.objPull[M]==null){return }if(this.objPull[M]["type"]!="buttonSelect"){return }return this.objPull[M][F].call(this.objPull[M],I,H,L,K,J)}};for(var D=0;D<E.length;D++){var A=E[D];dhtmlXToolbarObject.prototype[A]=C(A)}})();dhtmlXToolbarObject.prototype._rtlParseBtn=function(C,A){return C+A};dhtmlXToolbarObject.prototype._separatorObject=function(A,D,C){this.id=A.idPrefix+D;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_sep";this.obj.style.display=(C.hidden!=null?"none":"");this.obj.idd=String(D);this.obj.title=(C.title||"");this.obj.onselectstart=function(E){E=E||event;E.returnValue=false};if(A._isIPad){this.obj.ontouchstart=function(E){E=E||event;E.returnValue=false;E.cancelBubble=true;return false}}A.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};return this};dhtmlXToolbarObject.prototype._textObject=function(A,D,C){this.id=A.idPrefix+D;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_text";this.obj.style.display=(C.hidden!=null?"none":"");this.obj.idd=String(D);this.obj.title=(C.title||"");this.obj.onselectstart=function(E){E=E||event;E.returnValue=false};if(A._isIPad){this.obj.ontouchstart=function(E){E=E||event;E.returnValue=false;E.cancelBubble=true;return false}}this.obj.innerHTML=(C.text||"");A.base.appendChild(this.obj);this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(E){this.obj.innerHTML=E};this.getItemText=function(){return this.obj.innerHTML};this.setWidth=function(E){this.obj.style.width=E+"px"};return this};dhtmlXToolbarObject.prototype._buttonObject=function(A,E,C){this.id=A.idPrefix+E;this.state=(C.enabled!=null?false:true);this.imgEn=(C.img||"");this.imgDis=(C.imgdis||"");this.img=(this.state?(this.imgEn!=""?this.imgEn:""):(this.imgDis!=""?this.imgDis:""));this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=(C.hidden!=null?"none":"");this.obj.allowClick=false;this.obj.extAction=(C.action||null);this.obj.renderAs=this.obj.className;this.obj.idd=String(E);this.obj.title=(C.title||"");this.obj.pressed=false;this.obj.innerHTML=A._rtlParseBtn((this.img!=""?"<img src='"+A.imagePath+this.img+"'>":""),(C.text!=null?"<div>"+C.text+"</div>":""));var D=this;this.obj.onselectstart=function(F){F=F||event;F.returnValue=false};this.obj.onmouseover=function(){this._doOnMouseOver()};this.obj.onmouseout=function(){this._doOnMouseOut()};this.obj._doOnMouseOver=function(){this.allowClick=true;if(D.state==false){return }if(A.anyUsed!="none"){return }this.className="dhx_toolbar_btn over";this.renderAs=this.className};this.obj._doOnMouseOut=function(){this.allowClick=false;if(D.state==false){return }if(A.anyUsed!="none"){return }this.className="dhx_toolbar_btn def";this.renderAs=this.renderAs};this.obj.onclick=function(F){if(D.state==false){return }if(this.allowClick==false){return }F=F||event;var H=this.idd.replace(A.idPrefix,"");if(this.extAction){try{window[this.extAction](H)}catch(F){}}A.callEvent("onClick",[H])};this.obj[A._isIPad?"ontouchstart":"onmousedown"]=function(F){if(D.state==false){F=F||event;F.returnValue=false;F.cancelBubble=true;return false}if(A.anyUsed!="none"){return }A.anyUsed=this.idd;this.className="dhx_toolbar_btn pres";this.pressed=true;this.onmouseover=function(){this._doOnMouseOver()};this.onmouseout=function(){A.anyUsed="none";this._doOnMouseOut()};return false};this.obj[A._isIPad?"ontouchend":"onmouseup"]=function(H){if(D.state==false){return }if(A.anyUsed!="none"){if(A.anyUsed!=this.idd){return }}var F=A.anyUsed;this._doOnMouseUp();if(A._isIPad&&F!="none"){A.callEvent("onClick",[this.idd.replace(A.idPrefix,"")])}};if(A._isIPad){this.obj.ontouchmove=function(F){this._doOnMouseUp()}}this.obj._doOnMouseUp=function(){A.anyUsed="none";this.className=this.renderAs;this.pressed=false};this.obj._doOnMouseUpOnceAnywhere=function(){this._doOnMouseUp();this.onmouseover=function(){this._doOnMouseOver()};this.onmouseout=function(){this._doOnMouseOut()}};A.base.appendChild(this.obj);this.enableItem=function(){A._enableItem(this)};this.disableItem=function(){A._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(F){A._setItemText(this,F)};this.getItemText=function(){return A._getItemText(this)};this.setItemImage=function(F){A._setItemImage(this,F,true)};this.clearItemImage=function(){A._clearItemImage(this,true)};this.setItemImageDis=function(F){A._setItemImage(this,F,false)};this.clearItemImageDis=function(){A._clearItemImage(this,false)};this.setItemToolTip=function(F){this.obj.title=F};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._buttonSelectObject=function(D,H,F){this.id=D.idPrefix+H;this.state=(F.enabled!=null?(F.enabled=="true"?true:false):true);this.imgEn=(F.img||"");this.imgDis=(F.imgdis||"");this.img=(this.state?(this.imgEn!=""?this.imgEn:""):(this.imgDis!=""?this.imgDis:""));this.openAll=(F.openAll!=null);this.obj=document.createElement("DIV");this.obj.allowClick=false;this.obj.extAction=(F.action||null);this.obj.className="dhx_toolbar_btn def";this.obj.style.display=(F.hidden!=null?"none":"");this.obj.renderAs=this.obj.className;this.obj.onselectstart=function(I){I=I||event;I.returnValue=false};this.obj.idd=String(H);this.obj.title=(F.title||"");this.obj.pressed=false;this.callEvent=false;this.renderSelect=(F.renderSelect!=null?(F.renderSelect=="false"||F.renderSelect=="disabled"?false:true):true);this.obj.innerHTML=D._rtlParseBtn((this.img!=""?"<img src='"+D.imagePath+this.img+"'>":""),(F.text!=null?"<div>"+F.text+"</div>":""));D.base.appendChild(this.obj);this.arw=document.createElement("DIV");this.arw.className="dhx_toolbar_arw def";this.arw.style.display=this.obj.style.display;this.arw.innerHTML="<div class='arwimg'>&nbsp;</div>";this.arw.title=this.obj.title;this.arw.onselectstart=function(I){I=I||event;I.returnValue=false};D.base.appendChild(this.arw);var A=this;this.obj.onmouseover=function(I){I=I||event;if(D.anyUsed!="none"){return }if(!A.state){return }A.obj.renderAs="dhx_toolbar_btn over";A.obj.className=A.obj.renderAs;A.arw.className=String(A.obj.renderAs).replace("btn","arw")};this.obj.onmouseout=function(){A.obj.allowClick=false;if(D.anyUsed!="none"){return }if(!A.state){return }A.obj.renderAs="dhx_toolbar_btn def";A.obj.className=A.obj.renderAs;A.arw.className=String(A.obj.renderAs).replace("btn","arw");A.callEvent=false};this.arw.onmouseover=this.obj.onmouseover;this.arw.onmouseout=this.obj.onmouseout;if(this.openAll==true){}else{this.obj.onclick=function(I){I=I||event;if(!A.obj.allowClick){return }if(!A.state){return }if(D.anyUsed!="none"){return }var J=A.obj.idd.replace(D.idPrefix,"");if(A.obj.extAction){try{window[A.obj.extAction](J)}catch(I){}}D.callEvent("onClick",[J])};this.obj[D._isIPad?"ontouchstart":"onmousedown"]=function(I){I=I||event;if(D.anyUsed!="none"){return }if(!A.state){return }A.obj.allowClick=true;A.obj.className="dhx_toolbar_btn pres";A.arw.className="dhx_toolbar_arw pres";A.callEvent=true};this.obj[D._isIPad?"ontouchend":"onmouseup"]=function(I){I=I||event;I.cancelBubble=true;if(D.anyUsed!="none"){return }if(!A.state){return }A.obj.className=A.obj.renderAs;A.arw.className=String(A.obj.renderAs).replace("btn","arw");if(D._isIPad&&A.callEvent){var J=A.obj.idd.replace(D.idPrefix,"");D.callEvent("onClick",[J])}}}if(D._isIPad){this.obj.ontouchmove=this.obj.onmouseout}this.arw[D._isIPad?"ontouchstart":"onmousedown"]=function(L){L=L||event;if(!A.state){return }if(D.anyUsed==A.obj.idd){A.obj.className=A.obj.renderAs;A.arw.className=String(A.obj.renderAs).replace("btn","arw");D.anyUsed="none";A.polygon.style.display="none";if(A.polygon._ie6cover){A.polygon._ie6cover.style.display="none"}}else{if(D.anyUsed!="none"){if(D.objPull[D.idPrefix+D.anyUsed]["type"]=="buttonSelect"){var K=D.objPull[D.idPrefix+D.anyUsed];if(K.polygon.style.display!="none"){K.obj.renderAs="dhx_toolbar_btn def";K.obj.className=K.obj.renderAs;K.arw.className=String(A.obj.renderAs).replace("btn","arw");K.polygon.style.display="none";if(K.polygon._ie6cover){K.polygon._ie6cover.style.display="none"}}}}A.obj.className="dhx_toolbar_btn over";A.arw.className="dhx_toolbar_arw pres";D.anyUsed=A.obj.idd;A.polygon.style.top="0px";A.polygon.style.visibility="hidden";A.polygon.style.display="";D._autoDetectVisibleArea();var I=getAbsoluteTop(A.obj)+A.obj.offsetHeight+D.selectPolygonOffsetTop;var J=A.polygon.offsetHeight;if(I+J>D.tY2){I=getAbsoluteTop(A.obj)-J-D.selectPolygonOffsetTop;if(I<0){I=0}}A.polygon.style.top=I+"px";if(D.rtl){A.polygon.style.left=getAbsoluteLeft(A.obj)+A.obj.offsetWidth-A.polygon.offsetWidth+D.selectPolygonOffsetLeft+"px"}else{A.polygon.style.left=getAbsoluteLeft(A.obj)+D.selectPolygonOffsetLeft+"px"}A.polygon.style.visibility="visible";if(A.polygon._ie6cover){A.polygon._ie6cover.style.left=A.polygon.style.left;A.polygon._ie6cover.style.top=A.polygon.style.top;A.polygon._ie6cover.style.width=A.polygon.offsetWidth+"px";A.polygon._ie6cover.style.height=A.polygon.offsetHeight+"px";A.polygon._ie6cover.style.display=""}}return false};this.arw.onclick=function(I){I=I||event;I.cancelBubble=true};this.arw[D._isIPad?"ontouchend":"onmouseup"]=function(I){I=I||event;I.cancelBubble=true};if(this.openAll===true){this.obj.onclick=this.arw.onclick;this.obj.onmousedown=this.arw.onmousedown;this.obj.onmouseup=this.arw.onmouseup;if(D._isIPad){this.obj.ontouchstart=this.arw.ontouchstart;this.obj.ontouchend=this.arw.ontouchend}}this.obj.iddPrefix=D.idPrefix;this._listOptions={};this._separatorButtonSelectObject=function(K,I,J){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.className="tr_sep";this.obj.tr.onselectstart=function(L){L=L||event;L.returnValue=false;return false};this.obj.td=document.createElement("TD");this.obj.td.colSpan="2";this.obj.td.className="td_btn_sep";this.obj.td.onselectstart=function(L){L=L||event;L.returnValue=false;return false};if(isNaN(J)){J=A.p_tbody.childNodes.length+1}else{if(J<1){J=1}}if(J>A.p_tbody.childNodes.length){A.p_tbody.appendChild(this.obj.tr)}else{A.p_tbody.insertBefore(this.obj.tr,A.p_tbody.childNodes[J-1])}this.obj.tr.appendChild(this.obj.td);this.obj.sep=document.createElement("DIV");this.obj.sep.className="btn_sep";this.obj.sep.onselectstart=function(L){L=L||event;L.returnValue=false;return false};this.obj.td.appendChild(this.obj.sep);A._listOptions[K]=this.obj;return this};this._buttonButtonSelectObject=function(L,J,K){this.obj={};this.obj.tr=document.createElement("TR");this.obj.tr.en=(J.enabled=="false"?false:(J.disabled=="true"?false:true));this.obj.tr.extAction=(J.action||null);this.obj.tr._selected=(J.selected!=null);this.obj.tr.className="tr_btn"+(this.obj.tr.en?(this.obj.tr._selected&&A.renderSelect?" tr_btn_selected":""):" tr_btn_disabled");this.obj.tr.onselectstart=function(M){M=M||event;M.returnValue=false;return false};this.obj.tr.idd=String(L);if(J.userdata){this.obj.userData=J.userdata}if(isNaN(K)){K=A.p_tbody.childNodes.length+1}else{if(K<1){K=1}}if(K>A.p_tbody.childNodes.length){A.p_tbody.appendChild(this.obj.tr)}else{A.p_tbody.insertBefore(this.obj.tr,A.p_tbody.childNodes[K-1])}this.obj.td_a=document.createElement("TD");this.obj.td_a.className="td_btn_img";this.obj.td_a.onselectstart=function(M){M=M||event;M.returnValue=false;return false};this.obj.td_b=document.createElement("TD");this.obj.td_b.className="td_btn_txt";this.obj.td_b.onselectstart=function(M){M=M||event;M.returnValue=false;return false};if(D.rtl){this.obj.tr.appendChild(this.obj.td_b);this.obj.tr.appendChild(this.obj.td_a)}else{this.obj.tr.appendChild(this.obj.td_a);this.obj.tr.appendChild(this.obj.td_b)}if(J.img!=null){this.obj.td_a.innerHTML="<img class='btn_sel_img' src='"+D.imagePath+J.img+"' border='0'>"}var I=(J.text!=null?J.text:(J.itemText||""));this.obj.td_b.innerHTML="<div class='btn_sel_text'>"+I+"</div>";this.obj.tr[D._isIPad?"ontouchstart":"onmouseover"]=function(){if(!this.en||(this._selected&&A.renderSelect)){return }this.className="tr_btn tr_btn_over"};this.obj.tr.onmouseout=function(){if(!this.en){return }if(this._selected&&A.renderSelect){if(String(this.className).search("tr_btn_selected")==-1){this.className="tr_btn tr_btn_selected"}}else{this.className="tr_btn"}};this.obj.tr[D._isIPad?"ontouchend":"onclick"]=function(M){M=M||event;M.cancelBubble=true;if(!this.en){return }A.setListOptionSelected(this.idd.replace(D.idPrefix,""));A.obj.renderAs="dhx_toolbar_btn def";A.obj.className=A.obj.renderAs;A.arw.className=String(A.obj.renderAs).replace("btn","arw");A.polygon.style.display="none";if(A.polygon._ie6cover){A.polygon._ie6cover.style.display="none"}D.anyUsed="none";var N=this.idd.replace(D.idPrefix,"");if(this.extAction){try{window[this.extAction](N)}catch(M){}}D.callEvent("onClick",[N])};A._listOptions[L]=this.obj;return this};this.polygon=document.createElement("DIV");this.polygon.dir="ltr";this.polygon.style.display="none";this.polygon.style.zIndex=101;this.polygon.className="dhx_toolbar_poly_"+D.skin+(D.rtl?" rtl":"");this.polygon.onselectstart=function(I){I=I||event;I.returnValue=false};if(D._isIPad){this.polygon.ontouchstart=function(I){I=I||event;I.returnValue=false;I.cancelBubble=true;return false}}this.p_tbl=document.createElement("TABLE");this.p_tbl.className="buttons_cont";this.p_tbl.cellSpacing="0";this.p_tbl.cellPadding="0";this.p_tbl.border="0";this.polygon.appendChild(this.p_tbl);this.p_tbody=document.createElement("TBODY");this.p_tbl.appendChild(this.p_tbody);if(F.items){for(var E=0;E<F.items.length;E++){var C="_"+(F.items[E].type||"")+"ButtonSelectObject";if(typeof (this[C])=="function"){new this[C](F.items[E].id||D._genStr(24),F.items[E])}}}document.body.appendChild(this.polygon);if(D._isIE6){this.polygon._ie6cover=document.createElement("IFRAME");this.polygon._ie6cover.frameBorder=0;this.polygon._ie6cover.style.position="absolute";this.polygon._ie6cover.style.border="none";this.polygon._ie6cover.style.backgroundColor="#000000";this.polygon._ie6cover.style.filter="alpha(opacity=100)";this.polygon._ie6cover.style.display="none";this.polygon._ie6cover.setAttribute("src","javascript:false;");document.body.appendChild(this.polygon._ie6cover)}this.setWidth=function(I){this.obj.style.width=I-this.arw.offsetWidth+"px";this.polygon.style.width=this.obj.offsetWidth+this.arw.offsetWidth-2+"px";this.p_tbl.style.width=this.polygon.style.width};this.enableItem=function(){D._enableItem(this)};this.disableItem=function(){D._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display="";this.arw.style.display=""};this.hideItem=function(){this.obj.style.display="none";this.arw.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(I){D._setItemText(this,I)};this.getItemText=function(){return D._getItemText(this)};this.setItemImage=function(I){D._setItemImage(this,I,true)};this.clearItemImage=function(){D._clearItemImage(this,true)};this.setItemImageDis=function(I){D._setItemImage(this,I,false)};this.clearItemImageDis=function(){D._clearItemImage(this,false)};this.setItemToolTip=function(I){this.obj.title=I;this.arw.title=I};this.getItemToolTip=function(){return this.obj.title};this.addListOption=function(N,M,K,L,I){if(!(K=="button"||K=="separator")){return }var J={id:N,type:K,text:L,img:I};new this["_"+K+"ButtonSelectObject"](N,J,M)};this.removeListOption=function(K){if(!this._isListButton(K,true)){return }var I=this._listOptions[K];if(I.td_a!=null&&I.td_b!=null){I.td_a.onselectstart=null;I.td_b.onselectstart=null;while(I.td_a.childNodes.length>0){I.td_a.removeChild(I.td_a.childNodes[0])}while(I.td_b.childNodes.length>0){I.td_b.removeChild(I.td_b.childNodes[0])}I.tr.onselectstart=null;I.tr.onmouseover=null;I.tr.onmouseout=null;I.tr.onclick=null;while(I.tr.childNodes.length>0){I.tr.removeChild(I.tr.childNodes[0])}I.tr.parentNode.removeChild(I.tr);I.td_a=null;I.td_b=null;I.tr=null}else{I.sep.onselectstart=null;I.td.onselectstart=null;I.tr.onselectstart=null;while(I.td.childNodes.length>0){I.td.removeChild(I.td.childNodes[0])}while(I.tr.childNodes.length>0){I.tr.removeChild(I.tr.childNodes[0])}I.tr.parentNode.removeChild(I.tr);I.sep=null;I.td=null;I.tr=null}I=null;this._listOptions[K]=null;try{delete this._listOptions[K]}catch(J){}};this.showListOption=function(I){if(!this._isListButton(I,true)){return }this._listOptions[I].tr.style.display=""};this.hideListOption=function(I){if(!this._isListButton(I,true)){return }this._listOptions[I].tr.style.display="none"};this.isListOptionVisible=function(I){if(!this._isListButton(I,true)){return }return(this._listOptions[I].tr.style.display!="none")};this.enableListOption=function(I){if(!this._isListButton(I)){return }this._listOptions[I].tr.en=true;this._listOptions[I].tr.className="tr_btn"+(this._listOptions[I].tr._selected&&D.renderSelect?" tr_btn_selected":"")};this.disableListOption=function(I){if(!this._isListButton(I)){return }this._listOptions[I].tr.en=false;this._listOptions[I].tr.className="tr_btn tr_btn_disabled"};this.isListOptionEnabled=function(I){if(!this._isListButton(I)){return }return this._listOptions[I].tr.en};this.setListOptionPosition=function(K,J){if(!this._listOptions[K]||this.getListOptionPosition(K)==J||isNaN(J)){return }if(J<1){J=1}var I=this._listOptions[K].tr;this.p_tbody.removeChild(I);if(J>this.p_tbody.childNodes.length){this.p_tbody.appendChild(I)}else{this.p_tbody.insertBefore(I,this.p_tbody.childNodes[J-1])}I=null};this.getListOptionPosition=function(K){var J=-1;if(!this._listOptions[K]){return J}for(var I=0;I<this.p_tbody.childNodes.length;I++){if(this.p_tbody.childNodes[I]==this._listOptions[K].tr){J=I+1}}return J};this.setListOptionImage=function(L,I){if(!this._isListButton(L)){return }var K=this._listOptions[L].tr.childNodes[(D.rtl?1:0)];if(K.childNodes.length>0){K.childNodes[0].src=D.imagePath+I}else{var J=document.createElement("IMG");J.className="btn_sel_img";J.src=D.imagePath+I;K.appendChild(J)}K=null};this.getListOptionImage=function(K){if(!this._isListButton(K)){return }var J=this._listOptions[K].tr.childNodes[(D.rtl?1:0)];var I=null;if(J.childNodes.length>0){I=J.childNodes[0].src}J=null;return I};this.clearListOptionImage=function(J){if(!this._isListButton(J)){return }var I=this._listOptions[J].tr.childNodes[(D.rtl?1:0)];while(I.childNodes.length>0){I.removeChild(I.childNodes[0])}I=null};this.setListOptionText=function(J,I){if(!this._isListButton(J)){return }this._listOptions[J].tr.childNodes[(D.rtl?0:1)].childNodes[0].innerHTML=I};this.getListOptionText=function(I){if(!this._isListButton(I)){return }return this._listOptions[I].tr.childNodes[(D.rtl?0:1)].childNodes[0].innerHTML};this.setListOptionToolTip=function(J,I){if(!this._isListButton(J)){return }this._listOptions[J].tr.title=I};this.getListOptionToolTip=function(I){if(!this._isListButton(I)){return }return this._listOptions[I].tr.title};this.forEachListOption=function(J){for(var I in this._listOptions){J(I)}};this.getAllListOptions=function(){var J=new Array();for(var I in this._listOptions){J[J.length]=I}return J};this.setListOptionSelected=function(K){for(var I in this._listOptions){var J=this._listOptions[I];if(J.td_a!=null&&J.td_b!=null&&J.tr.en){if(I==K){J.tr._selected=true;J.className="tr_btn"+(this.renderSelect?" tr_btn_selected":"")}else{J.tr._selected=false;J.tr.className="tr_btn"}}J=null}};this.getListOptionSelected=function(){var J=null;for(var I in this._listOptions){if(this._listOptions[I].tr._selected==true){J=I}}return J};this._isListButton=function(J,I){if(this._listOptions[J]==null){return false}if(!I&&this._listOptions[J].tr.className=="tr_sep"){return false}return true};return this};dhtmlXToolbarObject.prototype._buttonInputObject=function(D,F,E){this.id=D.idPrefix+F;this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn def";this.obj.style.display=(E.hidden!=null?"none":"");this.obj.idd=String(F);this.obj.w=(E.width!=null?E.width:100);this.obj.title=(E.title!=null?E.title:"");this.obj.innerHTML="<input class='inp' type='text' style='-moz-user-select:text;width:"+this.obj.w+"px;'"+(E.value!=null?"' value='"+E.value+"'":"")+">";var C=D;var A=this;this.obj.childNodes[0].onkeydown=function(H){H=H||event;if(H.keyCode==13){C.callEvent("onEnter",[A.obj.idd,this.value])}};D.base.appendChild(this.obj);this.enableItem=function(){this.obj.childNodes[0].disabled=false};this.disableItem=function(){this.obj.childNodes[0].disabled=true};this.isEnabled=function(){return(!this.obj.childNodes[0].disabled)};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display!="none")};this.setValue=function(H){this.obj.childNodes[0].value=H};this.getValue=function(){return this.obj.childNodes[0].value};this.setWidth=function(H){this.obj.w=H;this.obj.childNodes[0].style.width=this.obj.w+"px"};this.getWidth=function(){return this.obj.w};this.setItemToolTip=function(H){this.obj.title=H};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._buttonTwoStateObject=function(A,E,C){this.id=A.idPrefix+E;this.state=(C.enabled!=null?false:true);this.imgEn=(C.img!=null?C.img:"");this.imgDis=(C.imgdis!=null?C.imgdis:"");this.img=(this.state?(this.imgEn!=""?this.imgEn:""):(this.imgDis!=""?this.imgDis:""));this.obj=document.createElement("DIV");this.obj.pressed=(C.selected!=null);this.obj.extAction=(C.action||null);this.obj.className="dhx_toolbar_btn "+(this.obj.pressed?(this.state?"pres":"dis"):(this.state?"def":"dis"));this.obj.style.display=(C.hidden!=null?"none":"");this.obj.renderAs=this.obj.className;this.obj.idd=String(E);this.obj.title=(C.title||"");if(this.obj.pressed){this.obj.renderAs="dhx_toolbar_btn over"}this.obj.innerHTML=A._rtlParseBtn((this.img!=""?"<img src='"+A.imagePath+this.img+"'>":""),(C.text!=null?"<div>"+C.text+"</div>":""));A.base.appendChild(this.obj);var D=this;this.obj.onselectstart=function(F){F=F||event;F.returnValue=false};this.obj.onmouseover=function(){this._doOnMouseOver()};this.obj.onmouseout=function(){this._doOnMouseOut()};this.obj._doOnMouseOver=function(){if(D.state==false){return }if(A.anyUsed!="none"){return }if(this.pressed){return }this.className="dhx_toolbar_btn over";this.renderAs=this.className};this.obj._doOnMouseOut=function(){if(D.state==false){return }if(A.anyUsed!="none"){return }if(this.pressed){return }this.className="dhx_toolbar_btn def";this.renderAs=this.className};this.obj[A._isIPad?"ontouchstart":"onmousedown"]=function(F){if(A.checkEvent("onBeforeStateChange")){if(!A.callEvent("onBeforeStateChange",[this.idd.replace(A.idPrefix,""),this.pressed])){return }}if(D.state==false){return }if(A.anyUsed!="none"){return }this.pressed=!this.pressed;this.className=(this.pressed?"dhx_toolbar_btn pres":this.renderAs);var H=this.idd.replace(A.idPrefix,"");if(this.extAction){try{window[this.extAction](H,this.pressed)}catch(F){}}A.callEvent("onStateChange",[H,this.pressed]);this._doOnMouseOut();return false};this.setItemState=function(F,I){if(this.obj.pressed!=F){if(F==true){this.obj.pressed=true;this.obj.className="dhx_toolbar_btn pres";this.obj.renderAs="dhx_toolbar_btn over"}else{this.obj.pressed=false;this.obj.className="dhx_toolbar_btn def";this.obj.renderAs=this.obj.className}if(I==true){var J=this.obj.idd.replace(A.idPrefix,"");if(this.obj.extAction){try{window[this.obj.extAction](J,this.obj.pressed)}catch(H){}}A.callEvent("onStateChange",[J,this.obj.pressed])}}};this.getItemState=function(){return this.obj.pressed};this.enableItem=function(){A._enableItem(this)};this.disableItem=function(){A._disableItem(this)};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setItemText=function(F){A._setItemText(this,F)};this.getItemText=function(){return A._getItemText(this)};this.setItemImage=function(F){A._setItemImage(this,F,true)};this.clearItemImage=function(){A._clearItemImage(this,true)};this.setItemImageDis=function(F){A._setItemImage(this,F,false)};this.clearItemImageDis=function(){A._clearItemImage(this,false)};this.setItemToolTip=function(F){this.obj.title=F};this.getItemToolTip=function(){return this.obj.title};return this};dhtmlXToolbarObject.prototype._sliderObject=function(E,H,F){this.id=E.idPrefix+H;this.state=(F.enabled!=null?(F.enabled=="true"?true:false):true);this.obj=document.createElement("DIV");this.obj.className="dhx_toolbar_btn "+(this.state?"def":"dis");this.obj.style.display=(F.hidden!=null?"none":"");this.obj.onselectstart=function(I){I=I||event;I.returnValue=false};this.obj.idd=String(H);this.obj.len=(F.length!=null?Number(F.length):50);this.obj.innerHTML="<div>"+(F.textMin||"")+"</div><div class='sl_bg_l'></div><div class='sl_bg_m' style='width:"+this.obj.len+"px;'></div><div class='sl_bg_r'></div><div>"+(F.textMax||"")+"</div>";E.base.appendChild(this.obj);var A=this;this.pen=document.createElement("DIV");this.pen.className="sl_pen";this.obj.appendChild(this.pen);var D=this.pen;this.label=document.createElement("DIV");this.label.dir="ltr";this.label.className="dhx_toolbar_slider_label_"+E.skin+(E.rtl?"_rtl":"");this.label.style.display="none";this.label.tip=(F.toolTip||"%v");document.body.appendChild(this.label);var C=this.label;this.pen.valueMin=(F.valueMin!=null?Number(F.valueMin):0);this.pen.valueMax=(F.valueMax!=null?Number(F.valueMax):100);if(this.pen.valueMin>this.pen.valueMax){this.pen.valueMin=this.pen.valueMax}this.pen.valueNow=(F.valueNow!=null?Number(F.valueNow):this.pen.valueMax);if(this.pen.valueNow>this.pen.valueMax){this.pen.valueNow=this.pen.valueMax}if(this.pen.valueNow<this.pen.valueMin){this.pen.valueNow=this.pen.valueMin}this.pen._detectLimits=function(){this.minX=A.obj.childNodes[1].offsetLeft-4;this.maxX=A.obj.childNodes[3].offsetLeft-this.offsetWidth+1};this.pen._detectLimits();this.pen._definePos=function(){this.nowX=Math.round((this.valueNow-this.valueMin)*(this.maxX-this.minX)/(this.valueMax-this.valueMin)+this.minX);this.style.left=this.nowX+"px";this.newNowX=this.nowX};this.pen._definePos();this.pen.initXY=0;this.pen.allowMove=false;this.pen[E._isIPad?"ontouchstart":"onmousedown"]=function(I){if(A.state==false){return }I=I||event;this.initXY=(E._isIPad?I.touches[0].clientX:I.clientX);this.newValueNow=this.valueNow;this.allowMove=true;this.className="sl_pen over";if(C.tip!=""){C.style.visibility="hidden";C.style.display="";C.innerHTML=C.tip.replace("%v",this.valueNow);C.style.left=Math.round(getAbsoluteLeft(this)+this.offsetWidth/2-C.offsetWidth/2)+"px";C.style.top=getAbsoluteTop(this)-C.offsetHeight-3+"px";C.style.visibility=""}};this.pen._doOnMouseMoveStart=function(J){J=J||event;if(!D.allowMove){return }var I=(E._isIPad?J.touches[0].clientX:J.clientX);var K=I-D.initXY;if(I<getAbsoluteLeft(D)+Math.round(D.offsetWidth/2)&&D.nowX==D.minX){return }if(I>getAbsoluteLeft(D)+Math.round(D.offsetWidth/2)&&D.nowX==D.maxX){return }D.newNowX=D.nowX+K;if(D.newNowX<D.minX){D.newNowX=D.minX}if(D.newNowX>D.maxX){D.newNowX=D.maxX}D.nowX=D.newNowX;D.style.left=D.nowX+"px";D.initXY=I;D.newValueNow=Math.round((D.valueMax-D.valueMin)*(D.newNowX-D.minX)/(D.maxX-D.minX)+D.valueMin);if(C.tip!=""){C.innerHTML=C.tip.replace(/%v/gi,D.newValueNow);C.style.left=Math.round(getAbsoluteLeft(D)+D.offsetWidth/2-C.offsetWidth/2)+"px";C.style.top=getAbsoluteTop(D)-C.offsetHeight-3+"px"}J.cancelBubble=true;J.returnValue=false;return false};this.pen._doOnMouseMoveEnd=function(){if(!D.allowMove){return }D.className="sl_pen";D.allowMove=false;D.nowX=D.newNowX;D.valueNow=D.newValueNow;if(C.tip!=""){C.style.display="none"}E.callEvent("onValueChange",[A.obj.idd.replace(E.idPrefix,""),D.valueNow])};if(E._isIPad){document.addEventListener("touchmove",D._doOnMouseMoveStart,false);document.addEventListener("touchend",D._doOnMouseMoveEnd,false)}else{if(_isIE){document.body.attachEvent("onmousemove",D._doOnMouseMoveStart);document.body.attachEvent("onmouseup",D._doOnMouseMoveEnd)}else{window.addEventListener("mousemove",D._doOnMouseMoveStart,false);window.addEventListener("mouseup",D._doOnMouseMoveEnd,false)}}this.enableItem=function(){if(this.state){return }this.state=true;this.obj.className="dhx_toolbar_btn def"};this.disableItem=function(){if(!this.state){return }this.state=false;this.obj.className="dhx_toolbar_btn dis"};this.isEnabled=function(){return this.state};this.showItem=function(){this.obj.style.display=""};this.hideItem=function(){this.obj.style.display="none"};this.isVisible=function(){return(this.obj.style.display=="")};this.setValue=function(I,J){I=Number(I);if(I<this.pen.valueMin){I=this.pen.valueMin}if(I>this.pen.valueMax){I=this.pen.valueMax}this.pen.valueNow=I;this.pen._definePos();if(J==true){E.callEvent("onValueChange",[this.obj.idd.replace(E.idPrefix,""),this.pen.valueNow])}};this.getValue=function(){return this.pen.valueNow};this.setMinValue=function(J,I){J=Number(J);if(J>this.pen.valueMax){return }this.obj.childNodes[0].innerHTML=I;this.obj.childNodes[0].style.display=(I.length>0?"":"none");this.pen.valueMin=J;if(this.pen.valueNow<this.pen.valueMin){this.pen.valueNow=this.pen.valueMin}this.pen._detectLimits();this.pen._definePos()};this.setMaxValue=function(J,I){J=Number(J);if(J<this.pen.valueMin){return }this.obj.childNodes[4].innerHTML=I;this.obj.childNodes[4].style.display=(I.length>0?"":"none");this.pen.valueMax=J;if(this.pen.valueNow>this.pen.valueMax){this.pen.valueNow=this.pen.valueMax}this.pen._detectLimits();this.pen._definePos()};this.getMinValue=function(){var I=this.obj.childNodes[0].innerHTML;var J=this.pen.valueMin;return new Array(J,I)};this.getMaxValue=function(){var I=this.obj.childNodes[4].innerHTML;var J=this.pen.valueMax;return new Array(J,I)};this.setItemToolTipTemplate=function(I){this.label.tip=I};this.getItemToolTipTemplate=function(){return this.label.tip};return this};dhtmlXToolbarObject.prototype.unload=function(){if(this._isIPad){document.removeEventListener("touchstart",this._doOnClick,false)}else{if(_isIE){document.body.detachEvent("onclick",this._doOnClick)}else{window.removeEventListener("click",this._doOnClick,false)}}this._doOnClick=null;this.clearAll();this.objPull=null;if(this._xmlLoader){this._xmlLoader.destructor();this._xmlLoader=null}while(this.base.childNodes.length>0){this.base.removeChild(this.base.childNodes[0])}this.cont.removeChild(this.base);this.base=null;while(this.cont.childNodes.length>0){this.cont.removeChild(this.cont.childNodes[0])}this.cont.className="";this.cont=null;this.detachAllEvents();this.tX1=null;this.tX2=null;this.tY1=null;this.tY2=null;this._isIE6=null;this._isWebToolbar=null;this.align=null;this.anyUsed=null;this.idPrefix=null;this.imagePath=null;this.rootTypes=null;this.selectPolygonOffsetLeft=null;this.selectPolygonOffsetTop=null;this.skin=null;this._rtl=null;this._rtlParseBtn=null;this.setRTL=null;this._getObj=null;this._addImgObj=null;this._setItemImage=null;this._clearItemImage=null;this._setItemText=null;this._getItemText=null;this._enableItem=null;this._disableItem=null;this._xmlParser=null;this._doOnLoad=null;this._addItemToStorage=null;this._genStr=null;this._addItem=null;this._getPosition=null;this._setPosition=null;this._getIdByPosition=null;this._separatorObject=null;this._textObject=null;this._buttonObject=null;this._buttonSelectObject=null;this._buttonInputObject=null;this._buttonTwoStateObject=null;this._sliderObject=null;this._autoDetectVisibleArea=null;this.setAlign=null;this.setSkin=null;this.setIconsPath=null;this.setIconPath=null;this.loadXML=null;this.loadXMLString=null;this.attachEvent=null;this.callEvent=null;this.checkEvent=null;this.eventCatcher=null;this.detachEvent=null;this.detachAllEvents=null;this.clearAll=null;this.addSpacer=null;this.removeSpacer=null;this.getType=null;this.getTypeExt=null;this.inArray=null;this.getParentId=null;this.addButton=null;this.addText=null;this.addButtonSelect=null;this.addButtonTwoState=null;this.addSeparator=null;this.addSlider=null;this.addInput=null;this.forEachItem=null;this.showItem=null;this.hideItem=null;this.isVisible=null;this.enableItem=null;this.disableItem=null;this.isEnabled=null;this.setItemText=null;this.getItemText=null;this.setItemToolTip=null;this.getItemToolTip=null;this.setItemImage=null;this.setItemImageDis=null;this.clearItemImage=null;this.clearItemImageDis=null;this.setItemState=null;this.getItemState=null;this.setItemToolTipTemplate=null;this.getItemToolTipTemplate=null;this.setValue=null;this.getValue=null;this.setMinValue=null;this.getMinValue=null;this.setMaxValue=null;this.getMaxValue=null;this.setWidth=null;this.getWidth=null;this.getPosition=null;this.setPosition=null;this.removeItem=null;this.addListOption=null;this.removeListOption=null;this.showListOption=null;this.hideListOption=null;this.isListOptionVisible=null;this.enableListOption=null;this.disableListOption=null;this.isListOptionEnabled=null;this.setListOptionPosition=null;this.getListOptionPosition=null;this.setListOptionText=null;this.getListOptionText=null;this.setListOptionToolTip=null;this.getListOptionToolTip=null;this.setListOptionImage=null;this.getListOptionImage=null;this.clearListOptionImage=null;this.forEachListOption=null;this.getAllListOptions=null;this.setListOptionSelected=null;this.getListOptionSelected=null;this.unload=null;this.setUserData=null;this.getUserData=null;this.items=null};dhtmlXToolbarObject.prototype._autoDetectVisibleArea=function(){this.tX1=document.body.scrollLeft;this.tX2=this.tX1+(window.innerWidth||document.body.clientWidth);this.tY1=Math.max((_isIE?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);this.tY2=this.tY1+(_isIE?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight)};dhtmlXToolbarObject.prototype.setUserData=function(E,A,D){if(this.objPull[this.idPrefix+E]==null){return }var C=this.objPull[this.idPrefix+E];if(C.userData==null){C.userData={}}C.userData[A]=D};dhtmlXToolbarObject.prototype.getUserData=function(C,A){if(this.objPull[this.idPrefix+C]==null){return null}if(this.objPull[this.idPrefix+C].userData==null){return null}if(this.objPull[this.idPrefix+C].userData[A]==null){return null}return this.objPull[this.idPrefix+C].userData[A]};dhtmlXToolbarObject.prototype._isListOptionExists=function(A,D){if(this.objPull[this.idPrefix+A]==null){return false}var C=this.objPull[this.idPrefix+A];if(C.type!="buttonSelect"){return false}if(C._listOptions[D]==null){return false}return true};dhtmlXToolbarObject.prototype.setListOptionUserData=function(A,F,C,E){if(!this._isListOptionExists(A,F)){return }var D=this.objPull[this.idPrefix+A]._listOptions[F];if(D.userData==null){D.userData={}}D.userData[C]=E};dhtmlXToolbarObject.prototype.getListOptionUserData=function(A,E,C){if(!this._isListOptionExists(A,E)){return null}var D=this.objPull[this.idPrefix+A]._listOptions[E];if(!D.userData){return null}return(D.userData[C]?D.userData[C]:null)};(function(){dhtmlx.extend_api("dhtmlXToolbarObject",{_init:function(A){return[A.parent,A.skin]},icon_path:"setIconsPath",xml:"loadXML",items:"items",align:"setAlign",rtl:"setRTL",skin:"setSkin"},{items:function(A){for(var C=0;C<A.length;C++){var D=A[C];if(D.type=="button"){this.addButton(D.id,null,D.text,D.img,D.img_disabled)}if(D.type=="separator"){this.addSeparator(D.id,null)}if(D.type=="text"){this.addText(D.id,null,D.text)}if(D.type=="buttonSelect"){this.addButtonSelect(D.id,null,D.text,D.options,D.img,D.img_disabled)}if(D.type=="buttonTwoState"){this.addButtonTwoState(D.id,null,D.text,D.img,D.img_disabled)}if(D.type=="buttonInput"){this.addInput(D.id,null,D.text)}if(D.type=="slider"){this.addSlider(D.id,null,D.length,D.value_min,D.value_max,D.value_now,D.text_min,D.text_max,D.tip_template)}if(D.width){this.setWidth(D.id,D.width)}if(D.disabled){this.disableItem(D.id)}if(D.tooltip){this.setItemToolTip(D.id,D.tooltip)}if(D.pressed===true){this.setItemState(D.id,true)}}}})})();